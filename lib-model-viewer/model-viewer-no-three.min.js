import{Quaternion as e,Matrix4 as t,RGBAFormat as s,RGBA_ASTC_4x4_Format as i,RGBA_BPTC_Format as n,RGBA_ETC2_EAC_Format as r,RGBA_PVRTC_4BPPV1_Format as o,RGBA_S3TC_DXT5_Format as a,RGB_ETC1_Format as A,RGB_ETC2_Format as l,RGB_PVRTC_4BPPV1_Format as h,RGB_S3TC_DXT1_Format as c,Texture as u,Vector3 as g,Color as d,Vector2 as p,PerspectiveCamera as m,MeshBasicMaterial as I,PlaneGeometry as f,Matrix3 as C,Triangle as E,Raycaster as B,Loader as w,FileLoader as y,SRGBColorSpace as Q,LinearSRGBColorSpace as v,BufferGeometry as b,BufferAttribute as S,CompressedArrayTexture as x,UnsignedByteType as M,CompressedTexture as D,LinearFilter as R,LinearMipmapLinearFilter as T,sRGBEncoding as L,LinearEncoding as F,FloatType as k,HalfFloatType as U,DataTexture as _,Data3DTexture as N,EventDispatcher as G,WebGLRenderer as P,ACESFilmicToneMapping as O,LoaderUtils as H,SpotLight as q,PointLight as V,DirectionalLight as J,MeshPhysicalMaterial as K,InstancedMesh as Y,Object3D as z,TextureLoader as j,ImageBitmapLoader as $,InterleavedBuffer as W,InterleavedBufferAttribute as X,RepeatWrapping as Z,PointsMaterial as ee,Material as te,LineBasicMaterial as se,MeshStandardMaterial as ie,DoubleSide as ne,PropertyBinding as re,SkinnedMesh as oe,Mesh as ae,LineSegments as Ae,Line as le,LineLoop as he,Points as ce,Group as ue,MathUtils as ge,OrthographicCamera as de,Skeleton as pe,InterpolateLinear as me,AnimationClip as Ie,Bone as fe,RGFormat as Ce,RedFormat as Ee,Spherical as Be,Euler as we,ShaderMaterial as ye,Scene as Qe,WebGLRenderTarget as ve,Sphere as be,FrontSide as Se,EquirectangularReflectionMapping as xe,WebGLCubeRenderTarget as Me,CubeCamera as De,NoToneMapping as Re,BoxGeometry as Te,NoBlending as Le,BackSide as Fe,VideoTexture as ke,CanvasTexture as Ue,Box3 as _e,AnimationMixer as Ne,LoopPingPong as Ge,LoopRepeat as Pe,LoopOnce as Oe,TrianglesDrawMode as He,TriangleFanDrawMode as qe,TriangleStripDrawMode as Ve,NearestFilter as Je,NearestMipmapNearestFilter as Ke,LinearMipmapNearestFilter as Ye,NearestMipmapLinearFilter as ze,ClampToEdgeWrapping as je,MirroredRepeatWrapping as $e,InterpolateDiscrete as We,VectorKeyframeTrack as Xe,QuaternionKeyframeTrack as Ze,NumberKeyframeTrack as et,LightProbe as tt,Float32BufferAttribute as st,DataTextureLoader as it,MeshDepthMaterial as nt,Interpolant as rt,Source as ot,DataUtils as at}from"three";export{CanvasTexture,FileLoader,Loader,NearestFilter}from"three";
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const At=(e,t)=>"method"===t.kind&&t.descriptor&&!("value"in t.descriptor)?{...t,finisher(s){s.createProperty(t.key,e)}}:{kind:"field",key:Symbol(),placement:"own",descriptor:{},originalKey:t.key,initializer(){"function"==typeof t.initializer&&(this[t.key]=t.initializer.call(this))},finisher(s){s.createProperty(t.key,e)}};function lt(e){return(t,s)=>void 0!==s?((e,t,s)=>{t.constructor.createProperty(s,e)})(e,t,s):At(e,t)
/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */}var ht;null===(ht=window.HTMLSlotElement)||void 0===ht||ht.prototype.assignedElements;
/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
const ct=window,ut=ct.ShadowRoot&&(void 0===ct.ShadyCSS||ct.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,gt=Symbol(),dt=new WeakMap;class pt{constructor(e,t,s){if(this._$cssResult$=!0,s!==gt)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o;const t=this.t;if(ut&&void 0===e){const s=void 0!==t&&1===t.length;s&&(e=dt.get(t)),void 0===e&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),s&&dt.set(t,e))}return e}toString(){return this.cssText}}const mt=ut?e=>e:e=>e instanceof CSSStyleSheet?(e=>{let t="";for(const s of e.cssRules)t+=s.cssText;return(e=>new pt("string"==typeof e?e:e+"",void 0,gt))(t)})(e):e
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */;var It;const ft=window,Ct=ft.trustedTypes,Et=Ct?Ct.emptyScript:"",Bt=ft.reactiveElementPolyfillSupport,wt={toAttribute(e,t){switch(t){case Boolean:e=e?Et:null;break;case Object:case Array:e=null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){let s=e;switch(t){case Boolean:s=null!==e;break;case Number:s=null===e?null:Number(e);break;case Object:case Array:try{s=JSON.parse(e)}catch(e){s=null}}return s}},yt=(e,t)=>t!==e&&(t==t||e==e),Qt={attribute:!0,type:String,converter:wt,reflect:!1,hasChanged:yt};class vt extends HTMLElement{constructor(){super(),this._$Ei=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$El=null,this.u()}static addInitializer(e){var t;this.finalize(),(null!==(t=this.h)&&void 0!==t?t:this.h=[]).push(e)}static get observedAttributes(){this.finalize();const e=[];return this.elementProperties.forEach(((t,s)=>{const i=this._$Ep(s,t);void 0!==i&&(this._$Ev.set(i,s),e.push(i))})),e}static createProperty(e,t=Qt){if(t.state&&(t.attribute=!1),this.finalize(),this.elementProperties.set(e,t),!t.noAccessor&&!this.prototype.hasOwnProperty(e)){const s="symbol"==typeof e?Symbol():"__"+e,i=this.getPropertyDescriptor(e,s,t);void 0!==i&&Object.defineProperty(this.prototype,e,i)}}static getPropertyDescriptor(e,t,s){return{get(){return this[t]},set(i){const n=this[e];this[t]=i,this.requestUpdate(e,n,s)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)||Qt}static finalize(){if(this.hasOwnProperty("finalized"))return!1;this.finalized=!0;const e=Object.getPrototypeOf(this);if(e.finalize(),void 0!==e.h&&(this.h=[...e.h]),this.elementProperties=new Map(e.elementProperties),this._$Ev=new Map,this.hasOwnProperty("properties")){const e=this.properties,t=[...Object.getOwnPropertyNames(e),...Object.getOwnPropertySymbols(e)];for(const s of t)this.createProperty(s,e[s])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const s=new Set(e.flat(1/0).reverse());for(const e of s)t.unshift(mt(e))}else void 0!==e&&t.push(mt(e));return t}static _$Ep(e,t){const s=t.attribute;return!1===s?void 0:"string"==typeof s?s:"string"==typeof e?e.toLowerCase():void 0}u(){var e;this._$E_=new Promise((e=>this.enableUpdating=e)),this._$AL=new Map,this._$Eg(),this.requestUpdate(),null===(e=this.constructor.h)||void 0===e||e.forEach((e=>e(this)))}addController(e){var t,s;(null!==(t=this._$ES)&&void 0!==t?t:this._$ES=[]).push(e),void 0!==this.renderRoot&&this.isConnected&&(null===(s=e.hostConnected)||void 0===s||s.call(e))}removeController(e){var t;null===(t=this._$ES)||void 0===t||t.splice(this._$ES.indexOf(e)>>>0,1)}_$Eg(){this.constructor.elementProperties.forEach(((e,t)=>{this.hasOwnProperty(t)&&(this._$Ei.set(t,this[t]),delete this[t])}))}createRenderRoot(){var e;const t=null!==(e=this.shadowRoot)&&void 0!==e?e:this.attachShadow(this.constructor.shadowRootOptions);return((e,t)=>{ut?e.adoptedStyleSheets=t.map((e=>e instanceof CSSStyleSheet?e:e.styleSheet)):t.forEach((t=>{const s=document.createElement("style"),i=ct.litNonce;void 0!==i&&s.setAttribute("nonce",i),s.textContent=t.cssText,e.appendChild(s)}))})(t,this.constructor.elementStyles),t}connectedCallback(){var e;void 0===this.renderRoot&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),null===(e=this._$ES)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostConnected)||void 0===t?void 0:t.call(e)}))}enableUpdating(e){}disconnectedCallback(){var e;null===(e=this._$ES)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostDisconnected)||void 0===t?void 0:t.call(e)}))}attributeChangedCallback(e,t,s){this._$AK(e,s)}_$EO(e,t,s=Qt){var i;const n=this.constructor._$Ep(e,s);if(void 0!==n&&!0===s.reflect){const r=(void 0!==(null===(i=s.converter)||void 0===i?void 0:i.toAttribute)?s.converter:wt).toAttribute(t,s.type);this._$El=e,null==r?this.removeAttribute(n):this.setAttribute(n,r),this._$El=null}}_$AK(e,t){var s;const i=this.constructor,n=i._$Ev.get(e);if(void 0!==n&&this._$El!==n){const e=i.getPropertyOptions(n),r="function"==typeof e.converter?{fromAttribute:e.converter}:void 0!==(null===(s=e.converter)||void 0===s?void 0:s.fromAttribute)?e.converter:wt;this._$El=n,this[n]=r.fromAttribute(t,e.type),this._$El=null}}requestUpdate(e,t,s){let i=!0;void 0!==e&&(((s=s||this.constructor.getPropertyOptions(e)).hasChanged||yt)(this[e],t)?(this._$AL.has(e)||this._$AL.set(e,t),!0===s.reflect&&this._$El!==e&&(void 0===this._$EC&&(this._$EC=new Map),this._$EC.set(e,s))):i=!1),!this.isUpdatePending&&i&&(this._$E_=this._$Ej())}async _$Ej(){this.isUpdatePending=!0;try{await this._$E_}catch(e){Promise.reject(e)}const e=this.scheduleUpdate();return null!=e&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var e;if(!this.isUpdatePending)return;this.hasUpdated,this._$Ei&&(this._$Ei.forEach(((e,t)=>this[t]=e)),this._$Ei=void 0);let t=!1;const s=this._$AL;try{t=this.shouldUpdate(s),t?(this.willUpdate(s),null===(e=this._$ES)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostUpdate)||void 0===t?void 0:t.call(e)})),this.update(s)):this._$Ek()}catch(e){throw t=!1,this._$Ek(),e}t&&this._$AE(s)}willUpdate(e){}_$AE(e){var t;null===(t=this._$ES)||void 0===t||t.forEach((e=>{var t;return null===(t=e.hostUpdated)||void 0===t?void 0:t.call(e)})),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$Ek(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$E_}shouldUpdate(e){return!0}update(e){void 0!==this._$EC&&(this._$EC.forEach(((e,t)=>this._$EO(t,this[t],e))),this._$EC=void 0),this._$Ek()}updated(e){}firstUpdated(e){}}
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
var bt;vt.finalized=!0,vt.elementProperties=new Map,vt.elementStyles=[],vt.shadowRootOptions={mode:"open"},null==Bt||Bt({ReactiveElement:vt}),(null!==(It=ft.reactiveElementVersions)&&void 0!==It?It:ft.reactiveElementVersions=[]).push("1.6.1");const St=window,xt=St.trustedTypes,Mt=xt?xt.createPolicy("lit-html",{createHTML:e=>e}):void 0,Dt=`lit$${(Math.random()+"").slice(9)}$`,Rt="?"+Dt,Tt=`<${Rt}>`,Lt=document,Ft=(e="")=>Lt.createComment(e),kt=e=>null===e||"object"!=typeof e&&"function"!=typeof e,Ut=Array.isArray,_t=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,Nt=/-->/g,Gt=/>/g,Pt=RegExp(">|[ \t\n\f\r](?:([^\\s\"'>=/]+)([ \t\n\f\r]*=[ \t\n\f\r]*(?:[^ \t\n\f\r\"'`<>=]|(\"|')|))|$)","g"),Ot=/'/g,Ht=/"/g,qt=/^(?:script|style|textarea|title)$/i,Vt=(e=>(t,...s)=>({_$litType$:e,strings:t,values:s}))(1),Jt=Symbol.for("lit-noChange"),Kt=Symbol.for("lit-nothing"),Yt=new WeakMap,zt=Lt.createTreeWalker(Lt,129,null,!1),jt=(e,t)=>{const s=e.length-1,i=[];let n,r=2===t?"<svg>":"",o=_t;for(let t=0;t<s;t++){const s=e[t];let a,A,l=-1,h=0;for(;h<s.length&&(o.lastIndex=h,A=o.exec(s),null!==A);)h=o.lastIndex,o===_t?"!--"===A[1]?o=Nt:void 0!==A[1]?o=Gt:void 0!==A[2]?(qt.test(A[2])&&(n=RegExp("</"+A[2],"g")),o=Pt):void 0!==A[3]&&(o=Pt):o===Pt?">"===A[0]?(o=null!=n?n:_t,l=-1):void 0===A[1]?l=-2:(l=o.lastIndex-A[2].length,a=A[1],o=void 0===A[3]?Pt:'"'===A[3]?Ht:Ot):o===Ht||o===Ot?o=Pt:o===Nt||o===Gt?o=_t:(o=Pt,n=void 0);const c=o===Pt&&e[t+1].startsWith("/>")?" ":"";r+=o===_t?s+Tt:l>=0?(i.push(a),s.slice(0,l)+"$lit$"+s.slice(l)+Dt+c):s+Dt+(-2===l?(i.push(void 0),t):c)}const a=r+(e[s]||"<?>")+(2===t?"</svg>":"");if(!Array.isArray(e)||!e.hasOwnProperty("raw"))throw Error("invalid template strings array");return[void 0!==Mt?Mt.createHTML(a):a,i]};class $t{constructor({strings:e,_$litType$:t},s){let i;this.parts=[];let n=0,r=0;const o=e.length-1,a=this.parts,[A,l]=jt(e,t);if(this.el=$t.createElement(A,s),zt.currentNode=this.el.content,2===t){const e=this.el.content,t=e.firstChild;t.remove(),e.append(...t.childNodes)}for(;null!==(i=zt.nextNode())&&a.length<o;){if(1===i.nodeType){if(i.hasAttributes()){const e=[];for(const t of i.getAttributeNames())if(t.endsWith("$lit$")||t.startsWith(Dt)){const s=l[r++];if(e.push(t),void 0!==s){const e=i.getAttribute(s.toLowerCase()+"$lit$").split(Dt),t=/([.?@])?(.*)/.exec(s);a.push({type:1,index:n,name:t[2],strings:e,ctor:"."===t[1]?ts:"?"===t[1]?is:"@"===t[1]?ns:es})}else a.push({type:6,index:n})}for(const t of e)i.removeAttribute(t)}if(qt.test(i.tagName)){const e=i.textContent.split(Dt),t=e.length-1;if(t>0){i.textContent=xt?xt.emptyScript:"";for(let s=0;s<t;s++)i.append(e[s],Ft()),zt.nextNode(),a.push({type:2,index:++n});i.append(e[t],Ft())}}}else if(8===i.nodeType)if(i.data===Rt)a.push({type:2,index:n});else{let e=-1;for(;-1!==(e=i.data.indexOf(Dt,e+1));)a.push({type:7,index:n}),e+=Dt.length-1}n++}}static createElement(e,t){const s=Lt.createElement("template");return s.innerHTML=e,s}}function Wt(e,t,s=e,i){var n,r,o,a;if(t===Jt)return t;let A=void 0!==i?null===(n=s._$Co)||void 0===n?void 0:n[i]:s._$Cl;const l=kt(t)?void 0:t._$litDirective$;return(null==A?void 0:A.constructor)!==l&&(null===(r=null==A?void 0:A._$AO)||void 0===r||r.call(A,!1),void 0===l?A=void 0:(A=new l(e),A._$AT(e,s,i)),void 0!==i?(null!==(o=(a=s)._$Co)&&void 0!==o?o:a._$Co=[])[i]=A:s._$Cl=A),void 0!==A&&(t=Wt(e,A._$AS(e,t.values),A,i)),t}class Xt{constructor(e,t){this.u=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}v(e){var t;const{el:{content:s},parts:i}=this._$AD,n=(null!==(t=null==e?void 0:e.creationScope)&&void 0!==t?t:Lt).importNode(s,!0);zt.currentNode=n;let r=zt.nextNode(),o=0,a=0,A=i[0];for(;void 0!==A;){if(o===A.index){let t;2===A.type?t=new Zt(r,r.nextSibling,this,e):1===A.type?t=new A.ctor(r,A.name,A.strings,this,e):6===A.type&&(t=new rs(r,this,e)),this.u.push(t),A=i[++a]}o!==(null==A?void 0:A.index)&&(r=zt.nextNode(),o++)}return n}p(e){let t=0;for(const s of this.u)void 0!==s&&(void 0!==s.strings?(s._$AI(e,s,t),t+=s.strings.length-2):s._$AI(e[t])),t++}}class Zt{constructor(e,t,s,i){var n;this.type=2,this._$AH=Kt,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=s,this.options=i,this._$Cm=null===(n=null==i?void 0:i.isConnected)||void 0===n||n}get _$AU(){var e,t;return null!==(t=null===(e=this._$AM)||void 0===e?void 0:e._$AU)&&void 0!==t?t:this._$Cm}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return void 0!==t&&11===e.nodeType&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=Wt(this,e,t),kt(e)?e===Kt||null==e||""===e?(this._$AH!==Kt&&this._$AR(),this._$AH=Kt):e!==this._$AH&&e!==Jt&&this.g(e):void 0!==e._$litType$?this.$(e):void 0!==e.nodeType?this.T(e):(e=>Ut(e)||"function"==typeof(null==e?void 0:e[Symbol.iterator]))(e)?this.k(e):this.g(e)}O(e,t=this._$AB){return this._$AA.parentNode.insertBefore(e,t)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}g(e){this._$AH!==Kt&&kt(this._$AH)?this._$AA.nextSibling.data=e:this.T(Lt.createTextNode(e)),this._$AH=e}$(e){var t;const{values:s,_$litType$:i}=e,n="number"==typeof i?this._$AC(e):(void 0===i.el&&(i.el=$t.createElement(i.h,this.options)),i);if((null===(t=this._$AH)||void 0===t?void 0:t._$AD)===n)this._$AH.p(s);else{const e=new Xt(n,this),t=e.v(this.options);e.p(s),this.T(t),this._$AH=e}}_$AC(e){let t=Yt.get(e.strings);return void 0===t&&Yt.set(e.strings,t=new $t(e)),t}k(e){Ut(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let s,i=0;for(const n of e)i===t.length?t.push(s=new Zt(this.O(Ft()),this.O(Ft()),this,this.options)):s=t[i],s._$AI(n),i++;i<t.length&&(this._$AR(s&&s._$AB.nextSibling,i),t.length=i)}_$AR(e=this._$AA.nextSibling,t){var s;for(null===(s=this._$AP)||void 0===s||s.call(this,!1,!0,t);e&&e!==this._$AB;){const t=e.nextSibling;e.remove(),e=t}}setConnected(e){var t;void 0===this._$AM&&(this._$Cm=e,null===(t=this._$AP)||void 0===t||t.call(this,e))}}class es{constructor(e,t,s,i,n){this.type=1,this._$AH=Kt,this._$AN=void 0,this.element=e,this.name=t,this._$AM=i,this.options=n,s.length>2||""!==s[0]||""!==s[1]?(this._$AH=Array(s.length-1).fill(new String),this.strings=s):this._$AH=Kt}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(e,t=this,s,i){const n=this.strings;let r=!1;if(void 0===n)e=Wt(this,e,t,0),r=!kt(e)||e!==this._$AH&&e!==Jt,r&&(this._$AH=e);else{const i=e;let o,a;for(e=n[0],o=0;o<n.length-1;o++)a=Wt(this,i[s+o],t,o),a===Jt&&(a=this._$AH[o]),r||(r=!kt(a)||a!==this._$AH[o]),a===Kt?e=Kt:e!==Kt&&(e+=(null!=a?a:"")+n[o+1]),this._$AH[o]=a}r&&!i&&this.j(e)}j(e){e===Kt?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,null!=e?e:"")}}class ts extends es{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===Kt?void 0:e}}const ss=xt?xt.emptyScript:"";class is extends es{constructor(){super(...arguments),this.type=4}j(e){e&&e!==Kt?this.element.setAttribute(this.name,ss):this.element.removeAttribute(this.name)}}class ns extends es{constructor(e,t,s,i,n){super(e,t,s,i,n),this.type=5}_$AI(e,t=this){var s;if((e=null!==(s=Wt(this,e,t,0))&&void 0!==s?s:Kt)===Jt)return;const i=this._$AH,n=e===Kt&&i!==Kt||e.capture!==i.capture||e.once!==i.once||e.passive!==i.passive,r=e!==Kt&&(i===Kt||n);n&&this.element.removeEventListener(this.name,this,i),r&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var t,s;"function"==typeof this._$AH?this._$AH.call(null!==(s=null===(t=this.options)||void 0===t?void 0:t.host)&&void 0!==s?s:this.element,e):this._$AH.handleEvent(e)}}class rs{constructor(e,t,s){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=s}get _$AU(){return this._$AM._$AU}_$AI(e){Wt(this,e)}}const os=St.litHtmlPolyfillSupport;null==os||os($t,Zt),(null!==(bt=St.litHtmlVersions)&&void 0!==bt?bt:St.litHtmlVersions=[]).push("2.6.1");const as=(e,t,s)=>{var i,n;const r=null!==(i=null==s?void 0:s.renderBefore)&&void 0!==i?i:t;let o=r._$litPart$;if(void 0===o){const e=null!==(n=null==s?void 0:s.renderBefore)&&void 0!==n?n:null;r._$litPart$=o=new Zt(t.insertBefore(Ft(),e),e,void 0,null!=s?s:{})}return o._$AI(e),o
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */};var As,ls;class hs extends vt{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var e,t;const s=super.createRenderRoot();return null!==(e=(t=this.renderOptions).renderBefore)&&void 0!==e||(t.renderBefore=s.firstChild),s}update(e){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=as(t,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),null===(e=this._$Do)||void 0===e||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),null===(e=this._$Do)||void 0===e||e.setConnected(!1)}render(){return Jt}}hs.finalized=!0,hs._$litElement$=!0,null===(As=globalThis.litElementHydrateSupport)||void 0===As||As.call(globalThis,{LitElement:hs});const cs=globalThis.litElementPolyfillSupport;null==cs||cs({LitElement:hs}),(null!==(ls=globalThis.litElementVersions)&&void 0!==ls?ls:globalThis.litElementVersions=[]).push("3.2.2");
/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const us=null!=navigator.xr&&null!=self.XRSession&&null!=navigator.xr.isSessionSupported,gs=us&&null!=self.XRSession.prototype.requestHitTestSource,ds=null!=self.ResizeObserver,ps=null!=self.IntersectionObserver,ms=gs;(()=>{const e=navigator.userAgent||navigator.vendor||self.opera;let t=!1;(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0)})(),/\bCrOS\b/.test(navigator.userAgent);const Is=/android/i.test(navigator.userAgent),fs=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!self.MSStream||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1;/Safari\//.test(navigator.userAgent);const Cs=/firefox/i.test(navigator.userAgent),Es=/OculusBrowser/.test(navigator.userAgent);fs&&/CriOS\//.test(navigator.userAgent);const Bs=Is&&!Cs&&!Es,ws=Boolean(window.webkit&&window.webkit.messageHandlers),ys=(()=>{if(fs){if(ws)return Boolean(/CriOS\/|EdgiOS\/|FxiOS\/|GSA\/|DuckDuckGo\//.test(navigator.userAgent));{const e=document.createElement("a");return Boolean(e.relList&&e.relList.supports&&e.relList.supports("ar"))}}return!1})(),Qs=e=>e&&"null"!==e?bs(e):null,vs=()=>{if(ms)return;const e=[];throw us||e.push("WebXR Device API"),gs||e.push("WebXR Hit Test API"),new Error(`The following APIs are required for AR, but are missing in this browser: ${e.join(", ")}`)},bs=e=>new URL(e,window.location.toString()).toString(),Ss=(e,t)=>{let s=null;return(...i)=>{null!=s&&self.clearTimeout(s),s=self.setTimeout((()=>{s=null,e(...i)}),t)}},xs=(e,t,s)=>Math.max(t,Math.min(s,e)),Ms=(()=>{const e=(()=>{var e;if(null===(e=document.documentElement.getAttribute("itemtype"))||void 0===e?void 0:e.includes("schema.org/SearchResultsPage"))return!0;const t=null!=document.head?Array.from(document.head.querySelectorAll("meta")):[];for(const e of t)if("viewport"===e.name)return!0;return!1})();return e||console.warn('No <meta name="viewport"> detected; <model-viewer> will cap pixel density at 1.'),()=>e?window.devicePixelRatio:1})(),Ds=(()=>{const e=new RegExp("[?&]model-viewer-debug-mode(&|$)");return()=>self.ModelViewerElement&&self.ModelViewerElement.debugMode||self.location&&self.location.search&&self.location.search.match(e)})();
/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Rs=function(e,t,s,i){for(var n,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,s):i,a=e.length-1;a>=0;a--)(n=e[a])&&(o=(r<3?n(o):r>3?n(t,s,o):n(t,s))||o);return r>3&&o&&Object.defineProperty(t,s,o),o};const Ts=Symbol("currentEnvironmentMap"),Ls=Symbol("currentBackground"),Fs=Symbol("updateEnvironment"),ks=Symbol("cancelEnvironmentUpdate");
/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const Us=Vt`
<style>
:host {
  display: block;
  position: relative;
  contain: strict;
  width: 300px;
  height: 150px;
}

/* NOTE: This rule set is our integration surface area with the
 * :focus-visible polyfill.
 *
 * @see https://github.com/WICG/focus-visible/pull/196 */
:host([data-js-focus-visible]:focus:not(.focus-visible)),
:host([data-js-focus-visible]) :focus:not(.focus-visible) {
  outline: none;
}

.container {
  position: relative;
  overflow: hidden;
}

.userInput {
  width: 100%;
  height: 100%;
  display: none;
  position: relative;
}

canvas {
  position: absolute;
  display: none;
  pointer-events: none;
  /* NOTE(cdata): Chrome 76 and below apparently have a bug
   * that causes our canvas not to display pixels unless it is
   * on its own render layer
   * @see https://github.com/google/model-viewer/pull/755#issuecomment-536597893
   */
  transform: translateZ(0);
}

.show {
  display: block;
}

/* Adapted from HTML5 Boilerplate
 *
 * @see https://github.com/h5bp/html5-boilerplate/blob/ceb4620c78fc82e13534fc44202a3f168754873f/dist/css/main.css#L122-L133 */
.screen-reader-only {
  border: 0;
  left: 0;
  top: 0;
  clip: rect(0, 0, 0, 0);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  white-space: nowrap;
  width: 1px;
  pointer-events: none;
}

.slot {
  position: absolute;
  pointer-events: none;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}

.slot > * {
  pointer-events: initial;
}

.annotation-wrapper ::slotted(*) {
  opacity: var(--max-hotspot-opacity, 1);
  transition: opacity 0.3s;
}

.pointer-tumbling .annotation-wrapper ::slotted(*) {
  pointer-events: none;
}

.annotation-wrapper ::slotted(*) {
  pointer-events: initial;
}

.annotation-wrapper.hide ::slotted(*) {
  opacity: var(--min-hotspot-opacity, 0.25);
}

.slot.poster {
  display: none;
  background-color: inherit;
}

.slot.poster.show {
  display: inherit;
}

.slot.poster > * {
  pointer-events: initial;
}

.slot.poster:not(.show) > * {
  pointer-events: none;
}

#default-poster {
  width: 100%;
  height: 100%;
  /* The default poster is a <button> so we need to set display
   * to prevent it from being affected by text-align: */
  display: block;
  position: absolute;
  border: none;
  padding: 0;
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
  background-color: #fff0;
}

#default-progress-bar {
  display: block;
  position: relative;
  width: 100%;
  height: 100%;
  pointer-events: none;
  overflow: hidden;
}

#default-progress-bar > .bar {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: var(--progress-bar-height, 5px);
  background-color: var(--progress-bar-color, rgba(0, 0, 0, 0.4));
  transition: transform 0.09s;
  transform-origin: top left;
  transform: scaleX(0);
  overflow: hidden;
}

#default-progress-bar > .bar.hide {
  transition: opacity 0.3s 1s;
  opacity: 0;
}

.centered {
  align-items: center;
  justify-content: center;
}

.cover {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
}

.slot.interaction-prompt {
  display: var(--interaction-prompt-display, flex);
  overflow: hidden;
  opacity: 0;
  will-change: opacity;
  transition: opacity 0.3s;
}

.slot.interaction-prompt.visible {
  opacity: 1;
}

.animated-container {
  will-change: transform, opacity;
  opacity: 0;
  transition: opacity 0.3s;
}

.slot.interaction-prompt > * {
  pointer-events: none;
}

.slot.ar-button {
  -moz-user-select: none;
  -webkit-tap-highlight-color: transparent;
  user-select: none;

  display: var(--ar-button-display, block);
}

.slot.ar-button:not(.enabled) {
  display: none;
}

.fab {
  display: flex;
  align-items: center;
  justify-content: center;
  box-sizing: border-box;
  width: 40px;
  height: 40px;
  cursor: pointer;
  background-color: #fff;
  box-shadow: 0px 0px 4px rgba(0, 0, 0, 0.15);
  border-radius: 100px;
}

.fab > * {
  opacity: 0.87;
}

#default-ar-button {
  position: absolute;
  bottom: 16px;
  right: 16px;
  transform: scale(var(--ar-button-scale, 1));
  transform-origin: bottom right;
}

.slot.pan-target {
  display: block;
  position: absolute;
  width: 0;
  height: 0;
  left: 50%;
  top: 50%;
  transform: translate3d(-50%, -50%, 0);
  background-color: transparent;
  opacity: 0;
  transition: opacity 0.3s;
}

#default-pan-target {
  width: 6px;
  height: 6px;
  border-radius: 6px;
  border: 1px solid white;
  box-shadow: 0px 0px 2px 1px rgba(0, 0, 0, 0.8);
}

.slot.default {
  pointer-events: none;
}

.slot.progress-bar {
  pointer-events: none;
}

.slot.exit-webxr-ar-button {
  pointer-events: none;
}

.slot.exit-webxr-ar-button:not(.enabled) {
  display: none;
}

#default-exit-webxr-ar-button {
  display: flex;
  align-items: center;
  justify-content: center;
  position: absolute;
  top: env(safe-area-inset-top, 16px);
  right: 16px;
  width: 40px;
  height: 40px;
  box-sizing: border-box;
}

#default-exit-webxr-ar-button > svg {
  fill: #fff;
}
</style>
<div class="container">
  <div class="userInput" tabindex="0" role="img"
      aria-label="3D model">
      <div class="slot canvas">
        <slot name="canvas">
          <canvas></canvas>
        </slot>
      </div>

  </div>

  <!-- NOTE(cdata): We need to wrap slots because browsers without ShadowDOM
        will have their <slot> elements removed by ShadyCSS -->
  <div class="slot poster">
    <slot name="poster">
      <button type="button" id="default-poster" aria-hidden="true" aria-label="Loading 3D model"></button>
    </slot>
  </div>

  <div class="slot ar-button">
    <slot name="ar-button">
      <a id="default-ar-button" part="default-ar-button" class="fab"
          tabindex="2"
          aria-label="View in your space">
        ${Vt`
<svg version="1.1" id="view_x5F_in_x5F_AR_x5F_icon"
	 xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="24px" height="24px"
	 viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve">
<rect id="Bounding_Box" x="0" y="0" fill="none" width="24" height="24"/>
<g id="Art_layer">
	<path d="M3,4c0-0.55,0.45-1,1-1h2V1H4C2.35,1,1,2.35,1,4v2h2V4z"/>
	<path d="M20,3c0.55,0,1,0.45,1,1v2h2V4c0-1.65-1.35-3-3-3h-2v2H20z"/>
	<path d="M4,21c-0.55,0-1-0.45-1-1v-2H1v2c0,1.65,1.35,3,3,3h2v-2H4z"/>
	<path d="M20,21c0.55,0,1-0.45,1-1v-2h2v2c0,1.65-1.35,3-3,3h-2v-2H20z"/>
	<g>
		<path d="M18.25,7.6l-5.5-3.18c-0.46-0.27-1.04-0.27-1.5,0L5.75,7.6C5.29,7.87,5,8.36,5,8.9v6.35c0,0.54,0.29,1.03,0.75,1.3
			l5.5,3.18c0.46,0.27,1.04,0.27,1.5,0l5.5-3.18c0.46-0.27,0.75-0.76,0.75-1.3V8.9C19,8.36,18.71,7.87,18.25,7.6z M7,14.96v-4.62
			l4,2.32v4.61L7,14.96z M12,10.93L8,8.61l4-2.31l4,2.31L12,10.93z M13,17.27v-4.61l4-2.32v4.62L13,17.27z"/>
	</g>
</g>
</svg>`}
      </a>
    </slot>
  </div>

  <div class="slot pan-target">
    <slot name="pan-target">
      <div id="default-pan-target">
      </div>
    </slot>
  </div>

  <div class="slot interaction-prompt cover centered">
    <div id="prompt" class="animated-container">
      <slot name="interaction-prompt" aria-hidden="true">
        ${Vt`
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="36">
    <defs>
        <path id="A" d="M.001.232h24.997V36H.001z" />
    </defs>
    <g transform="translate(-11 -4)" fill="none" fill-rule="evenodd">
        <path fill-opacity="0" fill="#fff" d="M0 0h44v44H0z" />
        <g transform="translate(11 3)">
            <path d="M8.733 11.165c.04-1.108.766-2.027 1.743-2.307a2.54 2.54 0 0 1 .628-.089c.16 0 .314.017.463.044 1.088.2 1.9 1.092 1.9 2.16v8.88h1.26c2.943-1.39 5-4.45 5-8.025a9.01 9.01 0 0 0-1.9-5.56l-.43-.5c-.765-.838-1.683-1.522-2.712-2-1.057-.49-2.226-.77-3.46-.77s-2.4.278-3.46.77c-1.03.478-1.947 1.162-2.71 2l-.43.5a9.01 9.01 0 0 0-1.9 5.56 9.04 9.04 0 0 0 .094 1.305c.03.21.088.41.13.617l.136.624c.083.286.196.56.305.832l.124.333a8.78 8.78 0 0 0 .509.953l.065.122a8.69 8.69 0 0 0 3.521 3.191l1.11.537v-9.178z" fill-opacity=".5" fill="#e4e4e4" />
            <path d="M22.94 26.218l-2.76 7.74c-.172.485-.676.8-1.253.8H12.24c-1.606 0-3.092-.68-3.98-1.82-1.592-2.048-3.647-3.822-6.11-5.27-.095-.055-.15-.137-.152-.23-.004-.1.046-.196.193-.297.56-.393 1.234-.6 1.926-.6a3.43 3.43 0 0 1 .691.069l4.922.994V10.972c0-.663.615-1.203 1.37-1.203s1.373.54 1.373 1.203v9.882h2.953c.273 0 .533.073.757.21l6.257 3.874c.027.017.045.042.07.06.41.296.586.77.426 1.22M4.1 16.614c-.024-.04-.042-.083-.065-.122a8.69 8.69 0 0 1-.509-.953c-.048-.107-.08-.223-.124-.333l-.305-.832c-.058-.202-.09-.416-.136-.624l-.13-.617a9.03 9.03 0 0 1-.094-1.305c0-2.107.714-4.04 1.9-5.56l.43-.5c.764-.84 1.682-1.523 2.71-2 1.058-.49 2.226-.77 3.46-.77s2.402.28 3.46.77c1.03.477 1.947 1.16 2.712 2l.428.5a9 9 0 0 1 1.901 5.559c0 3.577-2.056 6.636-5 8.026h-1.26v-8.882c0-1.067-.822-1.96-1.9-2.16-.15-.028-.304-.044-.463-.044-.22 0-.427.037-.628.09-.977.28-1.703 1.198-1.743 2.306v9.178l-1.11-.537C6.18 19.098 4.96 18 4.1 16.614M22.97 24.09l-6.256-3.874c-.102-.063-.218-.098-.33-.144 2.683-1.8 4.354-4.855 4.354-8.243 0-.486-.037-.964-.104-1.43a9.97 9.97 0 0 0-1.57-4.128l-.295-.408-.066-.092a10.05 10.05 0 0 0-.949-1.078c-.342-.334-.708-.643-1.094-.922-1.155-.834-2.492-1.412-3.94-1.65l-.732-.088-.748-.03a9.29 9.29 0 0 0-1.482.119c-1.447.238-2.786.816-3.94 1.65a9.33 9.33 0 0 0-.813.686 9.59 9.59 0 0 0-.845.877l-.385.437-.36.5-.288.468-.418.778-.04.09c-.593 1.28-.93 2.71-.93 4.222 0 3.832 2.182 7.342 5.56 8.938l1.437.68v4.946L5 25.64a4.44 4.44 0 0 0-.888-.086c-.017 0-.034.003-.05.003-.252.004-.503.033-.75.08a5.08 5.08 0 0 0-.237.056c-.193.046-.382.107-.568.18-.075.03-.15.057-.225.1-.25.114-.494.244-.723.405a1.31 1.31 0 0 0-.566 1.122 1.28 1.28 0 0 0 .645 1.051C4 29.925 5.96 31.614 7.473 33.563a5.06 5.06 0 0 0 .434.491c1.086 1.082 2.656 1.713 4.326 1.715h6.697c.748-.001 1.43-.333 1.858-.872.142-.18.256-.38.336-.602l2.757-7.74c.094-.26.13-.53.112-.794s-.088-.52-.203-.76a2.19 2.19 0 0 0-.821-.91" fill-opacity=".6" fill="#000" />
            <path d="M22.444 24.94l-6.257-3.874a1.45 1.45 0 0 0-.757-.211h-2.953v-9.88c0-.663-.616-1.203-1.373-1.203s-1.37.54-1.37 1.203v16.643l-4.922-.994a3.44 3.44 0 0 0-.692-.069 3.35 3.35 0 0 0-1.925.598c-.147.102-.198.198-.194.298.004.094.058.176.153.23 2.462 1.448 4.517 3.22 6.11 5.27.887 1.14 2.373 1.82 3.98 1.82h6.686c.577 0 1.08-.326 1.253-.8l2.76-7.74c.16-.448-.017-.923-.426-1.22-.025-.02-.043-.043-.07-.06z" fill="#fff" />
            <g transform="translate(0 .769)">
                <mask id="B" fill="#fff">
                    <use xlink:href="#A" />
                </mask>
                <path d="M23.993 24.992a1.96 1.96 0 0 1-.111.794l-2.758 7.74c-.08.22-.194.423-.336.602-.427.54-1.11.87-1.857.872h-6.698c-1.67-.002-3.24-.633-4.326-1.715-.154-.154-.3-.318-.434-.49C5.96 30.846 4 29.157 1.646 27.773c-.385-.225-.626-.618-.645-1.05a1.31 1.31 0 0 1 .566-1.122 4.56 4.56 0 0 1 .723-.405l.225-.1a4.3 4.3 0 0 1 .568-.18l.237-.056c.248-.046.5-.075.75-.08.018 0 .034-.003.05-.003.303-.001.597.027.89.086l3.722.752V20.68l-1.436-.68c-3.377-1.596-5.56-5.106-5.56-8.938 0-1.51.336-2.94.93-4.222.015-.03.025-.06.04-.09.127-.267.268-.525.418-.778.093-.16.186-.316.288-.468.063-.095.133-.186.2-.277L3.773 5c.118-.155.26-.29.385-.437.266-.3.544-.604.845-.877a9.33 9.33 0 0 1 .813-.686C6.97 2.167 8.31 1.59 9.757 1.35a9.27 9.27 0 0 1 1.481-.119 8.82 8.82 0 0 1 .748.031c.247.02.49.05.733.088 1.448.238 2.786.816 3.94 1.65.387.28.752.588 1.094.922a9.94 9.94 0 0 1 .949 1.078l.066.092c.102.133.203.268.295.408a9.97 9.97 0 0 1 1.571 4.128c.066.467.103.945.103 1.43 0 3.388-1.67 6.453-4.353 8.243.11.046.227.08.33.144l6.256 3.874c.37.23.645.55.82.9.115.24.185.498.203.76m.697-1.195c-.265-.55-.677-1.007-1.194-1.326l-5.323-3.297c2.255-2.037 3.564-4.97 3.564-8.114 0-2.19-.637-4.304-1.84-6.114-.126-.188-.26-.37-.4-.552-.645-.848-1.402-1.6-2.252-2.204C15.472.91 13.393.232 11.238.232A10.21 10.21 0 0 0 5.23 2.19c-.848.614-1.606 1.356-2.253 2.205-.136.18-.272.363-.398.55C1.374 6.756.737 8.87.737 11.06c0 4.218 2.407 8.08 6.133 9.842l.863.41v3.092l-2.525-.51c-.356-.07-.717-.106-1.076-.106a5.45 5.45 0 0 0-3.14.996c-.653.46-1.022 1.202-.99 1.983a2.28 2.28 0 0 0 1.138 1.872c2.24 1.318 4.106 2.923 5.543 4.772 1.26 1.62 3.333 2.59 5.55 2.592h6.698c1.42-.001 2.68-.86 3.134-2.138l2.76-7.74c.272-.757.224-1.584-.134-2.325" fill-opacity=".05" fill="#000" mask="url(#B)" />
            </g>
        </g>
    </g>
</svg>`
/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}
      </slot>
    </div>
  </div>

  <div id="finger0" class="animated-container cover">
    <slot name="finger0" aria-hidden="true">
    </slot>
  </div>
  <div id="finger1" class="animated-container cover">
    <slot name="finger1" aria-hidden="true">
    </slot>
  </div>

  <div class="slot default">
    <slot></slot>

    <div class="slot progress-bar">
      <slot name="progress-bar">
        <div id="default-progress-bar" aria-hidden="true">
          <div class="bar" part="default-progress-bar"></div>
        </div>
      </slot>
    </div>

    <div class="slot exit-webxr-ar-button">
      <slot name="exit-webxr-ar-button">
        <a id="default-exit-webxr-ar-button" part="default-exit-webxr-ar-button"
            tabindex="3"
            aria-label="Exit AR"
            aria-hidden="true">
          ${Vt`
<svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 24 24" fill="#000000">
    <!-- NOTE(cdata): This SVG filter is a stop-gap until we can implement
         support for dynamic re-coloring of UI components -->
    <defs>
      <filter id="drop-shadow" x="-100%" y="-100%" width="300%" height="300%">
        <feGaussianBlur in="SourceAlpha" stdDeviation="1"/>
        <feOffset dx="0" dy="0" result="offsetblur"/>
        <feFlood flood-color="#000000"/>
        <feComposite in2="offsetblur" operator="in"/>
        <feMerge>
          <feMergeNode/>
          <feMergeNode in="SourceGraphic"/>
        </feMerge>
      </filter>
    </defs>
    <path filter="url(#drop-shadow)" d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
    <path d="M0 0h24v24H0z" fill="none"/>
</svg>`
/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */}
        </a>
      </slot>
    </div>
  </div>
</div>
<div class="screen-reader-only" role="region" aria-label="Live announcements">
  <span id="status" role="status"></span>
</div>`,_s=new WeakMap;function Ns(){let e,t;function s(e,t,s,i,n,r){const o=r.num_components(),a=s.num_points()*o,A=a*n.BYTES_PER_ELEMENT,l=function(e,t){switch(t){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32}}(e,n),h=e._malloc(A);t.GetAttributeDataArrayForAllPoints(s,r,l,A,h);const c=new n(e.HEAPF32.buffer,h,a).slice();return e._free(h),{name:i,array:c,itemSize:o}}onmessage=function(i){const n=i.data;switch(n.type){case"init":e=n.decoderConfig,t=new Promise((function(t){e.onModuleLoaded=function(e){t({draco:e})},DracoDecoderModule(e)}));break;case"decode":const i=n.buffer,r=n.taskConfig;t.then((e=>{const t=e.draco,o=new t.Decoder;try{const e=function(e,t,i,n){const r=n.attributeIDs,o=n.attributeTypes;let a,A;const l=t.GetEncodedGeometryType(i);if(l===e.TRIANGULAR_MESH)a=new e.Mesh,A=t.DecodeArrayToMesh(i,i.byteLength,a);else{if(l!==e.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");a=new e.PointCloud,A=t.DecodeArrayToPointCloud(i,i.byteLength,a)}if(!A.ok()||0===a.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+A.error_msg());const h={index:null,attributes:[]};for(const i in r){const A=self[o[i]];let l,c;if(n.useUniqueIDs)c=r[i],l=t.GetAttributeByUniqueId(a,c);else{if(c=t.GetAttributeId(a,e[r[i]]),-1===c)continue;l=t.GetAttribute(a,c)}const u=s(e,t,a,i,A,l);"color"===i&&(u.vertexColorSpace=n.vertexColorSpace),h.attributes.push(u)}l===e.TRIANGULAR_MESH&&(h.index=function(e,t,s){const i=s.num_faces(),n=3*i,r=4*n,o=e._malloc(r);t.GetTrianglesUInt32Array(s,r,o);const a=new Uint32Array(e.HEAPF32.buffer,o,n).slice();return e._free(o),{array:a,itemSize:1}}(e,t,a));return e.destroy(a),h}(t,o,new Int8Array(i),r),a=e.attributes.map((e=>e.array.buffer));e.index&&a.push(e.index.array.buffer),self.postMessage({type:"decode",id:n.id,geometry:e},a)}catch(e){console.error(e),self.postMessage({type:"error",id:n.id,error:e.message})}finally{t.destroy(o)}}))}}}function Gs(e,t){if(t===He)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),e;if(t===qe||t===Ve){let s=e.getIndex();if(null===s){const t=[],i=e.getAttribute("position");if(void 0===i)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(let e=0;e<i.count;e++)t.push(e);e.setIndex(t),s=e.getIndex()}const i=s.count-2,n=[];if(t===qe)for(let e=1;e<=i;e++)n.push(s.getX(0)),n.push(s.getX(e)),n.push(s.getX(e+1));else for(let e=0;e<i;e++)e%2==0?(n.push(s.getX(e)),n.push(s.getX(e+1)),n.push(s.getX(e+2))):(n.push(s.getX(e+2)),n.push(s.getX(e+1)),n.push(s.getX(e)));n.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const r=e.clone();return r.setIndex(n),r.clearGroups(),r}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",t),e}class Ps extends w{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register((function(e){return new Ks(e)})),this.register((function(e){return new Zs(e)})),this.register((function(e){return new ei(e)})),this.register((function(e){return new ti(e)})),this.register((function(e){return new zs(e)})),this.register((function(e){return new js(e)})),this.register((function(e){return new $s(e)})),this.register((function(e){return new Ws(e)})),this.register((function(e){return new Js(e)})),this.register((function(e){return new Xs(e)})),this.register((function(e){return new Ys(e)})),this.register((function(e){return new qs(e)})),this.register((function(e){return new si(e)})),this.register((function(e){return new ii(e)}))}load(e,t,s,i){const n=this;let r;r=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:H.extractUrlBase(e),this.manager.itemStart(e);const o=function(t){i?i(t):console.error(t),n.manager.itemError(e),n.manager.itemEnd(e)},a=new y(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,(function(s){try{n.parse(s,r,(function(s){t(s),n.manager.itemEnd(e)}),o)}catch(e){o(e)}}),s,o)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,s,i){let n;const r={},o={},a=new TextDecoder;if("string"==typeof e)n=JSON.parse(e);else if(e instanceof ArrayBuffer){if(a.decode(new Uint8Array(e,0,4))===ni){try{r[Hs.KHR_BINARY_GLTF]=new ai(e)}catch(e){return void(i&&i(e))}n=JSON.parse(r[Hs.KHR_BINARY_GLTF].content)}else n=JSON.parse(a.decode(e))}else n=e;if(void 0===n.asset||n.asset.version[0]<2)return void(i&&i(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const A=new Li(n,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});A.fileLoader.setRequestHeader(this.requestHeader);for(let e=0;e<this.pluginCallbacks.length;e++){const t=this.pluginCallbacks[e](A);o[t.name]=t,r[t.name]=!0}if(n.extensionsUsed)for(let e=0;e<n.extensionsUsed.length;++e){const t=n.extensionsUsed[e],s=n.extensionsRequired||[];switch(t){case Hs.KHR_MATERIALS_UNLIT:r[t]=new Vs;break;case Hs.KHR_DRACO_MESH_COMPRESSION:r[t]=new Ai(n,this.dracoLoader);break;case Hs.KHR_TEXTURE_TRANSFORM:r[t]=new li;break;case Hs.KHR_MESH_QUANTIZATION:r[t]=new hi;break;default:s.indexOf(t)>=0&&void 0===o[t]&&console.warn('THREE.GLTFLoader: Unknown extension "'+t+'".')}}A.setExtensions(r),A.setPlugins(o),A.parse(s,i)}parseAsync(e,t){const s=this;return new Promise((function(i,n){s.parse(e,t,i,n)}))}}function Os(){let e={};return{get:function(t){return e[t]},add:function(t,s){e[t]=s},remove:function(t){delete e[t]},removeAll:function(){e={}}}}const Hs={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class qs{constructor(e){this.parser=e,this.name=Hs.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let s=0,i=t.length;s<i;s++){const i=t[s];i.extensions&&i.extensions[this.name]&&void 0!==i.extensions[this.name].light&&e._addNodeRef(this.cache,i.extensions[this.name].light)}}_loadLight(e){const t=this.parser,s="light:"+e;let i=t.cache.get(s);if(i)return i;const n=t.json,r=((n.extensions&&n.extensions[this.name]||{}).lights||[])[e];let o;const a=new d(16777215);void 0!==r.color&&a.fromArray(r.color);const A=void 0!==r.range?r.range:0;switch(r.type){case"directional":o=new J(a),o.target.position.set(0,0,-1),o.add(o.target);break;case"point":o=new V(a),o.distance=A;break;case"spot":o=new q(a),o.distance=A,r.spot=r.spot||{},r.spot.innerConeAngle=void 0!==r.spot.innerConeAngle?r.spot.innerConeAngle:0,r.spot.outerConeAngle=void 0!==r.spot.outerConeAngle?r.spot.outerConeAngle:Math.PI/4,o.angle=r.spot.outerConeAngle,o.penumbra=1-r.spot.innerConeAngle/r.spot.outerConeAngle,o.target.position.set(0,0,-1),o.add(o.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+r.type)}return o.position.set(0,0,0),o.decay=2,Si(o,r),void 0!==r.intensity&&(o.intensity=r.intensity),o.name=t.createUniqueName(r.name||"light_"+e),i=Promise.resolve(o),t.cache.add(s,i),i}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){const t=this,s=this.parser,i=s.json.nodes[e],n=(i.extensions&&i.extensions[this.name]||{}).light;return void 0===n?null:this._loadLight(n).then((function(e){return s._getNodeRef(t.cache,n,e)}))}}class Vs{constructor(){this.name=Hs.KHR_MATERIALS_UNLIT}getMaterialType(){return I}extendParams(e,t,s){const i=[];e.color=new d(1,1,1),e.opacity=1;const n=t.pbrMetallicRoughness;if(n){if(Array.isArray(n.baseColorFactor)){const t=n.baseColorFactor;e.color.fromArray(t),e.opacity=t[3]}void 0!==n.baseColorTexture&&i.push(s.assignTexture(e,"map",n.baseColorTexture,L))}return Promise.all(i)}}class Js{constructor(e){this.parser=e,this.name=Hs.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const i=s.extensions[this.name].emissiveStrength;return void 0!==i&&(t.emissiveIntensity=i),Promise.resolve()}}class Ks{constructor(e){this.parser=e,this.name=Hs.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?K:null}extendMaterialParams(e,t){const s=this.parser,i=s.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const n=[],r=i.extensions[this.name];if(void 0!==r.clearcoatFactor&&(t.clearcoat=r.clearcoatFactor),void 0!==r.clearcoatTexture&&n.push(s.assignTexture(t,"clearcoatMap",r.clearcoatTexture)),void 0!==r.clearcoatRoughnessFactor&&(t.clearcoatRoughness=r.clearcoatRoughnessFactor),void 0!==r.clearcoatRoughnessTexture&&n.push(s.assignTexture(t,"clearcoatRoughnessMap",r.clearcoatRoughnessTexture)),void 0!==r.clearcoatNormalTexture&&(n.push(s.assignTexture(t,"clearcoatNormalMap",r.clearcoatNormalTexture)),void 0!==r.clearcoatNormalTexture.scale)){const e=r.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new p(e,e)}return Promise.all(n)}}class Ys{constructor(e){this.parser=e,this.name=Hs.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?K:null}extendMaterialParams(e,t){const s=this.parser,i=s.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const n=[],r=i.extensions[this.name];return void 0!==r.iridescenceFactor&&(t.iridescence=r.iridescenceFactor),void 0!==r.iridescenceTexture&&n.push(s.assignTexture(t,"iridescenceMap",r.iridescenceTexture)),void 0!==r.iridescenceIor&&(t.iridescenceIOR=r.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==r.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=r.iridescenceThicknessMinimum),void 0!==r.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=r.iridescenceThicknessMaximum),void 0!==r.iridescenceThicknessTexture&&n.push(s.assignTexture(t,"iridescenceThicknessMap",r.iridescenceThicknessTexture)),Promise.all(n)}}class zs{constructor(e){this.parser=e,this.name=Hs.KHR_MATERIALS_SHEEN}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?K:null}extendMaterialParams(e,t){const s=this.parser,i=s.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const n=[];t.sheenColor=new d(0,0,0),t.sheenRoughness=0,t.sheen=1;const r=i.extensions[this.name];return void 0!==r.sheenColorFactor&&t.sheenColor.fromArray(r.sheenColorFactor),void 0!==r.sheenRoughnessFactor&&(t.sheenRoughness=r.sheenRoughnessFactor),void 0!==r.sheenColorTexture&&n.push(s.assignTexture(t,"sheenColorMap",r.sheenColorTexture,L)),void 0!==r.sheenRoughnessTexture&&n.push(s.assignTexture(t,"sheenRoughnessMap",r.sheenRoughnessTexture)),Promise.all(n)}}class js{constructor(e){this.parser=e,this.name=Hs.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?K:null}extendMaterialParams(e,t){const s=this.parser,i=s.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const n=[],r=i.extensions[this.name];return void 0!==r.transmissionFactor&&(t.transmission=r.transmissionFactor),void 0!==r.transmissionTexture&&n.push(s.assignTexture(t,"transmissionMap",r.transmissionTexture)),Promise.all(n)}}class $s{constructor(e){this.parser=e,this.name=Hs.KHR_MATERIALS_VOLUME}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?K:null}extendMaterialParams(e,t){const s=this.parser,i=s.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const n=[],r=i.extensions[this.name];t.thickness=void 0!==r.thicknessFactor?r.thicknessFactor:0,void 0!==r.thicknessTexture&&n.push(s.assignTexture(t,"thicknessMap",r.thicknessTexture)),t.attenuationDistance=r.attenuationDistance||1/0;const o=r.attenuationColor||[1,1,1];return t.attenuationColor=new d(o[0],o[1],o[2]),Promise.all(n)}}class Ws{constructor(e){this.parser=e,this.name=Hs.KHR_MATERIALS_IOR}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?K:null}extendMaterialParams(e,t){const s=this.parser.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const i=s.extensions[this.name];return t.ior=void 0!==i.ior?i.ior:1.5,Promise.resolve()}}class Xs{constructor(e){this.parser=e,this.name=Hs.KHR_MATERIALS_SPECULAR}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?K:null}extendMaterialParams(e,t){const s=this.parser,i=s.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const n=[],r=i.extensions[this.name];t.specularIntensity=void 0!==r.specularFactor?r.specularFactor:1,void 0!==r.specularTexture&&n.push(s.assignTexture(t,"specularIntensityMap",r.specularTexture));const o=r.specularColorFactor||[1,1,1];return t.specularColor=new d(o[0],o[1],o[2]),void 0!==r.specularColorTexture&&n.push(s.assignTexture(t,"specularColorMap",r.specularColorTexture,L)),Promise.all(n)}}class Zs{constructor(e){this.parser=e,this.name=Hs.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,s=t.json,i=s.textures[e];if(!i.extensions||!i.extensions[this.name])return null;const n=i.extensions[this.name],r=t.options.ktx2Loader;if(!r){if(s.extensionsRequired&&s.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,n.source,r)}}class ei{constructor(e){this.parser=e,this.name=Hs.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,s=this.parser,i=s.json,n=i.textures[e];if(!n.extensions||!n.extensions[t])return null;const r=n.extensions[t],o=i.images[r.source];let a=s.textureLoader;if(o.uri){const e=s.options.manager.getHandler(o.uri);null!==e&&(a=e)}return this.detectSupport().then((function(n){if(n)return s.loadTextureImage(e,r.source,a);if(i.extensionsRequired&&i.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return s.loadTexture(e)}))}detectSupport(){return this.isSupported||(this.isSupported=new Promise((function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}}))),this.isSupported}}class ti{constructor(e){this.parser=e,this.name=Hs.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,s=this.parser,i=s.json,n=i.textures[e];if(!n.extensions||!n.extensions[t])return null;const r=n.extensions[t],o=i.images[r.source];let a=s.textureLoader;if(o.uri){const e=s.options.manager.getHandler(o.uri);null!==e&&(a=e)}return this.detectSupport().then((function(n){if(n)return s.loadTextureImage(e,r.source,a);if(i.extensionsRequired&&i.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return s.loadTexture(e)}))}detectSupport(){return this.isSupported||(this.isSupported=new Promise((function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(1===t.height)}}))),this.isSupported}}class si{constructor(e){this.name=Hs.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,s=t.bufferViews[e];if(s.extensions&&s.extensions[this.name]){const e=s.extensions[this.name],i=this.parser.getDependency("buffer",e.buffer),n=this.parser.options.meshoptDecoder;if(!n||!n.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return i.then((function(t){const s=e.byteOffset||0,i=e.byteLength||0,r=e.count,o=e.byteStride,a=new Uint8Array(t,s,i);return n.decodeGltfBufferAsync?n.decodeGltfBufferAsync(r,o,a,e.mode,e.filter).then((function(e){return e.buffer})):n.ready.then((function(){const t=new ArrayBuffer(r*o);return n.decodeGltfBuffer(new Uint8Array(t),r,o,a,e.mode,e.filter),t}))}))}return null}}class ii{constructor(e){this.name=Hs.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(s){const i=this.parser.json,n=i.nodes[s];if(!n.extensions||!n.extensions[this.name]||void 0===n.mesh)return null;const r=i.meshes[n.mesh];for(const e of r.primitives)if(e.mode!==di.TRIANGLES&&e.mode!==di.TRIANGLE_STRIP&&e.mode!==di.TRIANGLE_FAN&&void 0!==e.mode)return null;const o=n.extensions[this.name].attributes,a=[],A={};for(const e in o)a.push(this.parser.getDependency("accessor",o[e]).then((t=>(A[e]=t,A[e]))));return a.length<1?null:(a.push(this.parser.createNodeMesh(s)),Promise.all(a).then((s=>{const i=s.pop(),n=i.isGroup?i.children:[i],r=s[0].count,o=[];for(const s of n){const i=new t,n=new g,a=new e,l=new g(1,1,1),h=new Y(s.geometry,s.material,r);for(let e=0;e<r;e++)A.TRANSLATION&&n.fromBufferAttribute(A.TRANSLATION,e),A.ROTATION&&a.fromBufferAttribute(A.ROTATION,e),A.SCALE&&l.fromBufferAttribute(A.SCALE,e),h.setMatrixAt(e,i.compose(n,a,l));for(const e in A)"TRANSLATION"!==e&&"ROTATION"!==e&&"SCALE"!==e&&s.geometry.setAttribute(e,A[e]);z.prototype.copy.call(h,s),h.frustumCulled=!1,this.parser.assignFinalMaterial(h),o.push(h)}return i.isGroup?(i.clear(),i.add(...o),i):o[0]})))}}const ni="glTF",ri=1313821514,oi=5130562;class ai{constructor(e){this.name=Hs.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12),s=new TextDecoder;if(this.header={magic:s.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==ni)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const i=this.header.length-12,n=new DataView(e,12);let r=0;for(;r<i;){const t=n.getUint32(r,!0);r+=4;const i=n.getUint32(r,!0);if(r+=4,i===ri){const i=new Uint8Array(e,12+r,t);this.content=s.decode(i)}else if(i===oi){const s=12+r;this.body=e.slice(s,s+t)}r+=t}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class Ai{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Hs.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const s=this.json,i=this.dracoLoader,n=e.extensions[this.name].bufferView,r=e.extensions[this.name].attributes,o={},a={},A={};for(const e in r){const t=Ci[e]||e.toLowerCase();o[t]=r[e]}for(const t in e.attributes){const i=Ci[t]||t.toLowerCase();if(void 0!==r[t]){const n=s.accessors[e.attributes[t]],r=pi[n.componentType];A[i]=r.name,a[i]=!0===n.normalized}}return t.getDependency("bufferView",n).then((function(e){return new Promise((function(t){i.decodeDracoFile(e,(function(e){for(const t in e.attributes){const s=e.attributes[t],i=a[t];void 0!==i&&(s.normalized=i)}t(e)}),o,A)}))}))}}class li{constructor(){this.name=Hs.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class hi{constructor(){this.name=Hs.KHR_MESH_QUANTIZATION}}class ci extends rt{constructor(e,t,s,i){super(e,t,s,i)}copySampleValue_(e){const t=this.resultBuffer,s=this.sampleValues,i=this.valueSize,n=e*i*3+i;for(let e=0;e!==i;e++)t[e]=s[n+e];return t}interpolate_(e,t,s,i){const n=this.resultBuffer,r=this.sampleValues,o=this.valueSize,a=2*o,A=3*o,l=i-t,h=(s-t)/l,c=h*h,u=c*h,g=e*A,d=g-A,p=-2*u+3*c,m=u-c,I=1-p,f=m-c+h;for(let e=0;e!==o;e++){const t=r[d+e+o],s=r[d+e+a]*l,i=r[g+e+o],A=r[g+e]*l;n[e]=I*t+f*s+p*i+m*A}return n}}const ui=new e;class gi extends ci{interpolate_(e,t,s,i){const n=super.interpolate_(e,t,s,i);return ui.fromArray(n).normalize().toArray(n),n}}const di={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},pi={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},mi={9728:Je,9729:R,9984:Ke,9985:Ye,9986:ze,9987:T},Ii={33071:je,33648:$e,10497:Z},fi={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Ci={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Ei={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Bi={CUBICSPLINE:void 0,LINEAR:me,STEP:We},wi="OPAQUE",yi="MASK",Qi="BLEND";function vi(e){return void 0===e.DefaultMaterial&&(e.DefaultMaterial=new ie({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Se})),e.DefaultMaterial}function bi(e,t,s){for(const i in s.extensions)void 0===e[i]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[i]=s.extensions[i])}function Si(e,t){void 0!==t.extras&&("object"==typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function xi(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(let s=0,i=t.weights.length;s<i;s++)e.morphTargetInfluences[s]=t.weights[s];if(t.extras&&Array.isArray(t.extras.targetNames)){const s=t.extras.targetNames;if(e.morphTargetInfluences.length===s.length){e.morphTargetDictionary={};for(let t=0,i=s.length;t<i;t++)e.morphTargetDictionary[s[t]]=t}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Mi(e){const t=e.extensions&&e.extensions[Hs.KHR_DRACO_MESH_COMPRESSION];let s;return s=t?"draco:"+t.bufferView+":"+t.indices+":"+Di(t.attributes):e.indices+":"+Di(e.attributes)+":"+e.mode,s}function Di(e){let t="";const s=Object.keys(e).sort();for(let i=0,n=s.length;i<n;i++)t+=s[i]+":"+e[s[i]]+";";return t}function Ri(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const Ti=new t;class Li{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new Os,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let s=!1,i=!1,n=-1;"undefined"!=typeof navigator&&(s=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),i=navigator.userAgent.indexOf("Firefox")>-1,n=i?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),"undefined"==typeof createImageBitmap||s||i&&n<98?this.textureLoader=new j(this.options.manager):this.textureLoader=new $(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new y(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const s=this,i=this.json,n=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll((function(e){return e._markDefs&&e._markDefs()})),Promise.all(this._invokeAll((function(e){return e.beforeRoot&&e.beforeRoot()}))).then((function(){return Promise.all([s.getDependencies("scene"),s.getDependencies("animation"),s.getDependencies("camera")])})).then((function(t){const r={scene:t[0][i.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:i.asset,parser:s,userData:{}};bi(n,r,i),Si(r,i),Promise.all(s._invokeAll((function(e){return e.afterRoot&&e.afterRoot(r)}))).then((function(){e(r)}))})).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],s=this.json.meshes||[];for(let s=0,i=t.length;s<i;s++){const i=t[s].joints;for(let t=0,s=i.length;t<s;t++)e[i[t]].isBone=!0}for(let t=0,i=e.length;t<i;t++){const i=e[t];void 0!==i.mesh&&(this._addNodeRef(this.meshCache,i.mesh),void 0!==i.skin&&(s[i.mesh].isSkinnedMesh=!0)),void 0!==i.camera&&this._addNodeRef(this.cameraCache,i.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,s){if(e.refs[t]<=1)return s;const i=s.clone(),n=(e,t)=>{const s=this.associations.get(e);null!=s&&this.associations.set(t,s);for(const[s,i]of e.children.entries())n(i,t.children[s])};return n(s,i),i.name+="_instance_"+e.uses[t]++,i}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let s=0;s<t.length;s++){const i=e(t[s]);if(i)return i}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const s=[];for(let i=0;i<t.length;i++){const n=e(t[i]);n&&s.push(n)}return s}getDependency(e,t){const s=e+":"+t;let i=this.cache.get(s);if(!i){switch(e){case"scene":i=this.loadScene(t);break;case"node":i=this._invokeOne((function(e){return e.loadNode&&e.loadNode(t)}));break;case"mesh":i=this._invokeOne((function(e){return e.loadMesh&&e.loadMesh(t)}));break;case"accessor":i=this.loadAccessor(t);break;case"bufferView":i=this._invokeOne((function(e){return e.loadBufferView&&e.loadBufferView(t)}));break;case"buffer":i=this.loadBuffer(t);break;case"material":i=this._invokeOne((function(e){return e.loadMaterial&&e.loadMaterial(t)}));break;case"texture":i=this._invokeOne((function(e){return e.loadTexture&&e.loadTexture(t)}));break;case"skin":i=this.loadSkin(t);break;case"animation":i=this._invokeOne((function(e){return e.loadAnimation&&e.loadAnimation(t)}));break;case"camera":i=this.loadCamera(t);break;default:if(i=this._invokeOne((function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)})),!i)throw new Error("Unknown type: "+e)}this.cache.add(s,i)}return i}getDependencies(e){let t=this.cache.get(e);if(!t){const s=this,i=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(i.map((function(t,i){return s.getDependency(e,i)}))),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],s=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[Hs.KHR_BINARY_GLTF].body);const i=this.options;return new Promise((function(e,n){s.load(H.resolveURL(t.uri,i.path),e,void 0,(function(){n(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))}))}))}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(e){const s=t.byteLength||0,i=t.byteOffset||0;return e.slice(i,i+s)}))}loadAccessor(e){const t=this,s=this.json,i=this.json.accessors[e];if(void 0===i.bufferView&&void 0===i.sparse){const e=fi[i.type],t=pi[i.componentType],s=!0===i.normalized,n=new t(i.count*e);return Promise.resolve(new S(n,e,s))}const n=[];return void 0!==i.bufferView?n.push(this.getDependency("bufferView",i.bufferView)):n.push(null),void 0!==i.sparse&&(n.push(this.getDependency("bufferView",i.sparse.indices.bufferView)),n.push(this.getDependency("bufferView",i.sparse.values.bufferView))),Promise.all(n).then((function(e){const n=e[0],r=fi[i.type],o=pi[i.componentType],a=o.BYTES_PER_ELEMENT,A=a*r,l=i.byteOffset||0,h=void 0!==i.bufferView?s.bufferViews[i.bufferView].byteStride:void 0,c=!0===i.normalized;let u,g;if(h&&h!==A){const e=Math.floor(l/h),s="InterleavedBuffer:"+i.bufferView+":"+i.componentType+":"+e+":"+i.count;let A=t.cache.get(s);A||(u=new o(n,e*h,i.count*h/a),A=new W(u,h/a),t.cache.add(s,A)),g=new X(A,r,l%h/a,c)}else u=null===n?new o(i.count*r):new o(n,l,i.count*r),g=new S(u,r,c);if(void 0!==i.sparse){const t=fi.SCALAR,s=pi[i.sparse.indices.componentType],a=i.sparse.indices.byteOffset||0,A=i.sparse.values.byteOffset||0,l=new s(e[1],a,i.sparse.count*t),h=new o(e[2],A,i.sparse.count*r);null!==n&&(g=new S(g.array.slice(),g.itemSize,g.normalized));for(let e=0,t=l.length;e<t;e++){const t=l[e];if(g.setX(t,h[e*r]),r>=2&&g.setY(t,h[e*r+1]),r>=3&&g.setZ(t,h[e*r+2]),r>=4&&g.setW(t,h[e*r+3]),r>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return g}))}loadTexture(e){const t=this.json,s=this.options,i=t.textures[e].source,n=t.images[i];let r=this.textureLoader;if(n.uri){const e=s.manager.getHandler(n.uri);null!==e&&(r=e)}return this.loadTextureImage(e,i,r)}loadTextureImage(e,t,s){const i=this,n=this.json,r=n.textures[e],o=n.images[t],a=(o.uri||o.bufferView)+":"+r.sampler;if(this.textureCache[a])return this.textureCache[a];const A=this.loadImageSource(t,s).then((function(t){t.flipY=!1,t.name=r.name||o.name||"";const s=(n.samplers||{})[r.sampler]||{};return t.magFilter=mi[s.magFilter]||R,t.minFilter=mi[s.minFilter]||T,t.wrapS=Ii[s.wrapS]||Z,t.wrapT=Ii[s.wrapT]||Z,i.associations.set(t,{textures:e}),t})).catch((function(){return null}));return this.textureCache[a]=A,A}loadImageSource(e,t){const s=this,i=this.json,n=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then((e=>e.clone()));const r=i.images[e],o=self.URL||self.webkitURL;let a=r.uri||"",A=!1;if(void 0!==r.bufferView)a=s.getDependency("bufferView",r.bufferView).then((function(e){A=!0;const t=new Blob([e],{type:r.mimeType});return a=o.createObjectURL(t),a}));else if(void 0===r.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const l=Promise.resolve(a).then((function(e){return new Promise((function(s,i){let r=s;!0===t.isImageBitmapLoader&&(r=function(e){const t=new u(e);t.needsUpdate=!0,s(t)}),t.load(H.resolveURL(e,n.path),r,void 0,i)}))})).then((function(e){var t;return!0===A&&o.revokeObjectURL(a),e.userData.mimeType=r.mimeType||((t=r.uri).search(/\.jpe?g($|\?)/i)>0||0===t.search(/^data\:image\/jpeg/)?"image/jpeg":t.search(/\.webp($|\?)/i)>0||0===t.search(/^data\:image\/webp/)?"image/webp":"image/png"),e})).catch((function(e){throw console.error("THREE.GLTFLoader: Couldn't load texture",a),e}));return this.sourceCache[e]=l,l}assignTexture(e,t,s,i){const n=this;return this.getDependency("texture",s.index).then((function(r){if(!r)return null;if(void 0===s.texCoord||0==s.texCoord||"aoMap"===t&&1==s.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+s.texCoord+" for texture "+t+" not yet supported."),n.extensions[Hs.KHR_TEXTURE_TRANSFORM]){const e=void 0!==s.extensions?s.extensions[Hs.KHR_TEXTURE_TRANSFORM]:void 0;if(e){const t=n.associations.get(r);r=n.extensions[Hs.KHR_TEXTURE_TRANSFORM].extendTexture(r,e),n.associations.set(r,t)}}return void 0!==i&&(r.encoding=i),e[t]=r,r}))}assignFinalMaterial(e){const t=e.geometry;let s=e.material;const i=void 0===t.attributes.tangent,n=void 0!==t.attributes.color,r=void 0===t.attributes.normal;if(e.isPoints){const e="PointsMaterial:"+s.uuid;let t=this.cache.get(e);t||(t=new ee,te.prototype.copy.call(t,s),t.color.copy(s.color),t.map=s.map,t.sizeAttenuation=!1,this.cache.add(e,t)),s=t}else if(e.isLine){const e="LineBasicMaterial:"+s.uuid;let t=this.cache.get(e);t||(t=new se,te.prototype.copy.call(t,s),t.color.copy(s.color),this.cache.add(e,t)),s=t}if(i||n||r){let e="ClonedMaterial:"+s.uuid+":";i&&(e+="derivative-tangents:"),n&&(e+="vertex-colors:"),r&&(e+="flat-shading:");let t=this.cache.get(e);t||(t=s.clone(),n&&(t.vertexColors=!0),r&&(t.flatShading=!0),i&&(t.normalScale&&(t.normalScale.y*=-1),t.clearcoatNormalScale&&(t.clearcoatNormalScale.y*=-1)),this.cache.add(e,t),this.associations.set(t,this.associations.get(s))),s=t}s.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&t.setAttribute("uv2",t.attributes.uv),e.material=s}getMaterialType(){return ie}loadMaterial(e){const t=this,s=this.json,i=this.extensions,n=s.materials[e];let r;const o={},a=[];if((n.extensions||{})[Hs.KHR_MATERIALS_UNLIT]){const e=i[Hs.KHR_MATERIALS_UNLIT];r=e.getMaterialType(),a.push(e.extendParams(o,n,t))}else{const s=n.pbrMetallicRoughness||{};if(o.color=new d(1,1,1),o.opacity=1,Array.isArray(s.baseColorFactor)){const e=s.baseColorFactor;o.color.fromArray(e),o.opacity=e[3]}void 0!==s.baseColorTexture&&a.push(t.assignTexture(o,"map",s.baseColorTexture,L)),o.metalness=void 0!==s.metallicFactor?s.metallicFactor:1,o.roughness=void 0!==s.roughnessFactor?s.roughnessFactor:1,void 0!==s.metallicRoughnessTexture&&(a.push(t.assignTexture(o,"metalnessMap",s.metallicRoughnessTexture)),a.push(t.assignTexture(o,"roughnessMap",s.metallicRoughnessTexture))),r=this._invokeOne((function(t){return t.getMaterialType&&t.getMaterialType(e)})),a.push(Promise.all(this._invokeAll((function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,o)}))))}!0===n.doubleSided&&(o.side=ne);const A=n.alphaMode||wi;if(A===Qi?(o.transparent=!0,o.depthWrite=!1):(o.transparent=!1,A===yi&&(o.alphaTest=void 0!==n.alphaCutoff?n.alphaCutoff:.5)),void 0!==n.normalTexture&&r!==I&&(a.push(t.assignTexture(o,"normalMap",n.normalTexture)),o.normalScale=new p(1,1),void 0!==n.normalTexture.scale)){const e=n.normalTexture.scale;o.normalScale.set(e,e)}return void 0!==n.occlusionTexture&&r!==I&&(a.push(t.assignTexture(o,"aoMap",n.occlusionTexture)),void 0!==n.occlusionTexture.strength&&(o.aoMapIntensity=n.occlusionTexture.strength)),void 0!==n.emissiveFactor&&r!==I&&(o.emissive=(new d).fromArray(n.emissiveFactor)),void 0!==n.emissiveTexture&&r!==I&&a.push(t.assignTexture(o,"emissiveMap",n.emissiveTexture,L)),Promise.all(a).then((function(){const s=new r(o);return n.name&&(s.name=n.name),Si(s,n),t.associations.set(s,{materials:e}),n.extensions&&bi(i,s,n),s}))}createUniqueName(e){const t=re.sanitizeNodeName(e||"");let s=t;for(let e=1;this.nodeNamesUsed[s];++e)s=t+"_"+e;return this.nodeNamesUsed[s]=!0,s}loadGeometries(e){const t=this,s=this.extensions,i=this.primitiveCache;function n(e){return s[Hs.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then((function(s){return Fi(s,e,t)}))}const r=[];for(let s=0,o=e.length;s<o;s++){const o=e[s],a=Mi(o),A=i[a];if(A)r.push(A.promise);else{let e;e=o.extensions&&o.extensions[Hs.KHR_DRACO_MESH_COMPRESSION]?n(o):Fi(new b,o,t),i[a]={primitive:o,promise:e},r.push(e)}}return Promise.all(r)}loadMesh(e){const t=this,s=this.json,i=this.extensions,n=s.meshes[e],r=n.primitives,o=[];for(let e=0,t=r.length;e<t;e++){const t=void 0===r[e].material?vi(this.cache):this.getDependency("material",r[e].material);o.push(t)}return o.push(t.loadGeometries(r)),Promise.all(o).then((function(s){const o=s.slice(0,s.length-1),a=s[s.length-1],A=[];for(let s=0,l=a.length;s<l;s++){const l=a[s],h=r[s];let c;const u=o[s];if(h.mode===di.TRIANGLES||h.mode===di.TRIANGLE_STRIP||h.mode===di.TRIANGLE_FAN||void 0===h.mode)c=!0===n.isSkinnedMesh?new oe(l,u):new ae(l,u),!0===c.isSkinnedMesh&&c.normalizeSkinWeights(),h.mode===di.TRIANGLE_STRIP?c.geometry=Gs(c.geometry,Ve):h.mode===di.TRIANGLE_FAN&&(c.geometry=Gs(c.geometry,qe));else if(h.mode===di.LINES)c=new Ae(l,u);else if(h.mode===di.LINE_STRIP)c=new le(l,u);else if(h.mode===di.LINE_LOOP)c=new he(l,u);else{if(h.mode!==di.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+h.mode);c=new ce(l,u)}Object.keys(c.geometry.morphAttributes).length>0&&xi(c,n),c.name=t.createUniqueName(n.name||"mesh_"+e),Si(c,n),h.extensions&&bi(i,c,h),t.assignFinalMaterial(c),A.push(c)}for(let s=0,i=A.length;s<i;s++)t.associations.set(A[s],{meshes:e,primitives:s});if(1===A.length)return A[0];const l=new ue;t.associations.set(l,{meshes:e});for(let e=0,t=A.length;e<t;e++)l.add(A[e]);return l}))}loadCamera(e){let t;const s=this.json.cameras[e],i=s[s.type];if(i)return"perspective"===s.type?t=new m(ge.radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):"orthographic"===s.type&&(t=new de(-i.xmag,i.xmag,i.ymag,-i.ymag,i.znear,i.zfar)),s.name&&(t.name=this.createUniqueName(s.name)),Si(t,s),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const s=this.json.skins[e],i=[];for(let e=0,t=s.joints.length;e<t;e++)i.push(this._loadNodeShallow(s.joints[e]));return void 0!==s.inverseBindMatrices?i.push(this.getDependency("accessor",s.inverseBindMatrices)):i.push(null),Promise.all(i).then((function(e){const i=e.pop(),n=e,r=[],o=[];for(let e=0,a=n.length;e<a;e++){const a=n[e];if(a){r.push(a);const s=new t;null!==i&&s.fromArray(i.array,16*e),o.push(s)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',s.joints[e])}return new pe(r,o)}))}loadAnimation(e){const t=this.json.animations[e],s=[],i=[],n=[],r=[],o=[];for(let e=0,a=t.channels.length;e<a;e++){const a=t.channels[e],A=t.samplers[a.sampler],l=a.target,h=l.node,c=void 0!==t.parameters?t.parameters[A.input]:A.input,u=void 0!==t.parameters?t.parameters[A.output]:A.output;s.push(this.getDependency("node",h)),i.push(this.getDependency("accessor",c)),n.push(this.getDependency("accessor",u)),r.push(A),o.push(l)}return Promise.all([Promise.all(s),Promise.all(i),Promise.all(n),Promise.all(r),Promise.all(o)]).then((function(s){const i=s[0],n=s[1],r=s[2],o=s[3],a=s[4],A=[];for(let e=0,t=i.length;e<t;e++){const t=i[e],s=n[e],l=r[e],h=o[e],c=a[e];if(void 0===t)continue;let u;switch(t.updateMatrix(),Ei[c.path]){case Ei.weights:u=et;break;case Ei.rotation:u=Ze;break;default:u=Xe}const g=t.name?t.name:t.uuid,d=void 0!==h.interpolation?Bi[h.interpolation]:me,p=[];Ei[c.path]===Ei.weights?t.traverse((function(e){e.morphTargetInfluences&&p.push(e.name?e.name:e.uuid)})):p.push(g);let m=l.array;if(l.normalized){const e=Ri(m.constructor),t=new Float32Array(m.length);for(let s=0,i=m.length;s<i;s++)t[s]=m[s]*e;m=t}for(let e=0,t=p.length;e<t;e++){const t=new u(p[e]+"."+Ei[c.path],s.array,m,d);"CUBICSPLINE"===h.interpolation&&(t.createInterpolant=function(e){return new(this instanceof Ze?gi:ci)(this.times,this.values,this.getValueSize()/3,e)},t.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),A.push(t)}}const l=t.name?t.name:"animation_"+e;return new Ie(l,void 0,A)}))}createNodeMesh(e){const t=this.json,s=this,i=t.nodes[e];return void 0===i.mesh?null:s.getDependency("mesh",i.mesh).then((function(e){const t=s._getNodeRef(s.meshCache,i.mesh,e);return void 0!==i.weights&&t.traverse((function(e){if(e.isMesh)for(let t=0,s=i.weights.length;t<s;t++)e.morphTargetInfluences[t]=i.weights[t]})),t}))}loadNode(e){const t=this,s=this.json.nodes[e],i=t._loadNodeShallow(e),n=[],r=s.children||[];for(let e=0,s=r.length;e<s;e++)n.push(t.getDependency("node",r[e]));const o=void 0===s.skin?Promise.resolve(null):t.getDependency("skin",s.skin);return Promise.all([i,Promise.all(n),o]).then((function(e){const t=e[0],s=e[1],i=e[2];null!==i&&t.traverse((function(e){e.isSkinnedMesh&&e.bind(i,Ti)}));for(let e=0,i=s.length;e<i;e++)t.add(s[e]);return t}))}_loadNodeShallow(e){const s=this.json,i=this.extensions,n=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];const r=s.nodes[e],o=r.name?n.createUniqueName(r.name):"",a=[],A=n._invokeOne((function(t){return t.createNodeMesh&&t.createNodeMesh(e)}));return A&&a.push(A),void 0!==r.camera&&a.push(n.getDependency("camera",r.camera).then((function(e){return n._getNodeRef(n.cameraCache,r.camera,e)}))),n._invokeAll((function(t){return t.createNodeAttachment&&t.createNodeAttachment(e)})).forEach((function(e){a.push(e)})),this.nodeCache[e]=Promise.all(a).then((function(s){let a;if(a=!0===r.isBone?new fe:s.length>1?new ue:1===s.length?s[0]:new z,a!==s[0])for(let e=0,t=s.length;e<t;e++)a.add(s[e]);if(r.name&&(a.userData.name=r.name,a.name=o),Si(a,r),r.extensions&&bi(i,a,r),void 0!==r.matrix){const e=new t;e.fromArray(r.matrix),a.applyMatrix4(e)}else void 0!==r.translation&&a.position.fromArray(r.translation),void 0!==r.rotation&&a.quaternion.fromArray(r.rotation),void 0!==r.scale&&a.scale.fromArray(r.scale);return n.associations.has(a)||n.associations.set(a,{}),n.associations.get(a).nodes=e,a})),this.nodeCache[e]}loadScene(e){const t=this.extensions,s=this.json.scenes[e],i=this,n=new ue;s.name&&(n.name=i.createUniqueName(s.name)),Si(n,s),s.extensions&&bi(t,n,s);const r=s.nodes||[],o=[];for(let e=0,t=r.length;e<t;e++)o.push(i.getDependency("node",r[e]));return Promise.all(o).then((function(e){for(let t=0,s=e.length;t<s;t++)n.add(e[t]);return i.associations=(e=>{const t=new Map;for(const[e,s]of i.associations)(e instanceof te||e instanceof u)&&t.set(e,s);return e.traverse((e=>{const s=i.associations.get(e);null!=s&&t.set(e,s)})),t})(n),n}))}}function Fi(e,t,s){const i=t.attributes,n=[];function r(t,i){return s.getDependency("accessor",t).then((function(t){e.setAttribute(i,t)}))}for(const t in i){const s=Ci[t]||t.toLowerCase();s in e.attributes||n.push(r(i[t],s))}if(void 0!==t.indices&&!e.index){const i=s.getDependency("accessor",t.indices).then((function(t){e.setIndex(t)}));n.push(i)}return Si(e,t),function(e,t,s){const i=t.attributes,n=new _e;if(void 0===i.POSITION)return;{const e=s.json.accessors[i.POSITION],t=e.min,r=e.max;if(void 0===t||void 0===r)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(n.set(new g(t[0],t[1],t[2]),new g(r[0],r[1],r[2])),e.normalized){const t=Ri(pi[e.componentType]);n.min.multiplyScalar(t),n.max.multiplyScalar(t)}}const r=t.targets;if(void 0!==r){const e=new g,t=new g;for(let i=0,n=r.length;i<n;i++){const n=r[i];if(void 0!==n.POSITION){const i=s.json.accessors[n.POSITION],r=i.min,o=i.max;if(void 0!==r&&void 0!==o){if(t.setX(Math.max(Math.abs(r[0]),Math.abs(o[0]))),t.setY(Math.max(Math.abs(r[1]),Math.abs(o[1]))),t.setZ(Math.max(Math.abs(r[2]),Math.abs(o[2]))),i.normalized){const e=Ri(pi[i.componentType]);t.multiplyScalar(e)}e.max(t)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}n.expandByVector(e)}e.boundingBox=n;const o=new be;n.getCenter(o.center),o.radius=n.min.distanceTo(n.max)/2,e.boundingSphere=o}(e,t,s),Promise.all(n).then((function(){return void 0!==t.targets?function(e,t,s){let i=!1,n=!1,r=!1;for(let e=0,s=t.length;e<s;e++){const s=t[e];if(void 0!==s.POSITION&&(i=!0),void 0!==s.NORMAL&&(n=!0),void 0!==s.COLOR_0&&(r=!0),i&&n&&r)break}if(!i&&!n&&!r)return Promise.resolve(e);const o=[],a=[],A=[];for(let l=0,h=t.length;l<h;l++){const h=t[l];if(i){const t=void 0!==h.POSITION?s.getDependency("accessor",h.POSITION):e.attributes.position;o.push(t)}if(n){const t=void 0!==h.NORMAL?s.getDependency("accessor",h.NORMAL):e.attributes.normal;a.push(t)}if(r){const t=void 0!==h.COLOR_0?s.getDependency("accessor",h.COLOR_0):e.attributes.color;A.push(t)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(A)]).then((function(t){const s=t[0],o=t[1],a=t[2];return i&&(e.morphAttributes.position=s),n&&(e.morphAttributes.normal=o),r&&(e.morphAttributes.color=a),e.morphTargetsRelative=!0,e}))}(e,t.targets,s):e}))}class ki{constructor(e=4){this.pool=e,this.queue=[],this.workers=[],this.workersResolve=[],this.workerStatus=0}_initWorker(e){if(!this.workers[e]){const t=this.workerCreator();t.addEventListener("message",this._onMessage.bind(this,e)),this.workers[e]=t}}_getIdleWorker(){for(let e=0;e<this.pool;e++)if(!(this.workerStatus&1<<e))return e;return-1}_onMessage(e,t){const s=this.workersResolve[e];if(s&&s(t),this.queue.length){const{resolve:t,msg:s,transfer:i}=this.queue.shift();this.workersResolve[e]=t,this.workers[e].postMessage(s,i)}else this.workerStatus^=1<<e}setWorkerCreator(e){this.workerCreator=e}setWorkerLimit(e){this.pool=e}postMessage(e,t){return new Promise((s=>{const i=this._getIdleWorker();-1!==i?(this._initWorker(i),this.workerStatus|=1<<i,this.workersResolve[i]=s,this.workers[i].postMessage(e,t)):this.queue.push({resolve:s,msg:e,transfer:t})}))}dispose(){this.workers.forEach((e=>e.terminate())),this.workersResolve.length=0,this.workers.length=0,this.queue.length=0,this.workerStatus=0}}const Ui=0,_i=2;class Ni{constructor(){this.vkFormat=0,this.typeSize=1,this.pixelWidth=0,this.pixelHeight=0,this.pixelDepth=0,this.layerCount=0,this.faceCount=1,this.supercompressionScheme=0,this.levels=[],this.dataFormatDescriptor=[{vendorId:0,descriptorType:0,descriptorBlockSize:0,versionNumber:2,colorModel:0,colorPrimaries:1,transferFunction:2,flags:0,texelBlockDimension:[0,0,0,0],bytesPlane:[0,0,0,0,0,0,0,0],samples:[]}],this.keyValue={},this.globalData=null}}class Gi{constructor(e,t,s,i){this._dataView=new DataView(e.buffer,e.byteOffset+t,s),this._littleEndian=i,this._offset=0}_nextUint8(){const e=this._dataView.getUint8(this._offset);return this._offset+=1,e}_nextUint16(){const e=this._dataView.getUint16(this._offset,this._littleEndian);return this._offset+=2,e}_nextUint32(){const e=this._dataView.getUint32(this._offset,this._littleEndian);return this._offset+=4,e}_nextUint64(){const e=this._dataView.getUint32(this._offset,this._littleEndian)+2**32*this._dataView.getUint32(this._offset+4,this._littleEndian);return this._offset+=8,e}_nextInt32(){const e=this._dataView.getInt32(this._offset,this._littleEndian);return this._offset+=4,e}_skip(e){return this._offset+=e,this}_scan(e,t=0){const s=this._offset;let i=0;for(;this._dataView.getUint8(this._offset)!==t&&i<e;)i++,this._offset++;return i<e&&this._offset++,new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+s,i)}}const Pi=[171,75,84,88,32,50,48,187,13,10,26,10];function Oi(e){return"undefined"!=typeof TextDecoder?(new TextDecoder).decode(e):Buffer.from(e).toString("utf8")}let Hi,qi,Vi;const Ji={env:{emscripten_notify_memory_growth:function(e){Vi=new Uint8Array(qi.exports.memory.buffer)}}};class Ki{init(){return Hi||(Hi="undefined"!=typeof fetch?fetch("data:application/wasm;base64,"+Yi).then((e=>e.arrayBuffer())).then((e=>WebAssembly.instantiate(e,Ji))).then(this._init):WebAssembly.instantiate(Buffer.from(Yi,"base64"),Ji).then(this._init),Hi)}_init(e){qi=e.instance,Ji.env.emscripten_notify_memory_growth(0)}decode(e,t=0){if(!qi)throw new Error("ZSTDDecoder: Await .init() before decoding.");const s=e.byteLength,i=qi.exports.malloc(s);Vi.set(e,i),t=t||Number(qi.exports.ZSTD_findDecompressedSize(i,s));const n=qi.exports.malloc(t),r=qi.exports.ZSTD_decompress(n,t,i,s),o=Vi.slice(n,n+r);return qi.exports.free(i),qi.exports.free(n),o}}const Yi="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IAMNACAEQQNxBEADQCACRQ0FIAAgAkF/aiICaiIDIAEgAmotAAA6AAAgA0EDcQ0ACwsgAkEDTQ0AA0AgACACQXxqIgJqIAEgAmooAgA2AgAgAkEDSw0ACwsgAkUNAgNAIAAgAkF/aiICaiABIAJqLQAAOgAAIAINAAsMAgsgAkEDTQ0AIAIhBANAIAMgASgCADYCACABQQRqIQEgA0EEaiEDIARBfGoiBEEDSw0ACyACQQNxIQILIAJFDQADQCADIAEtAAA6AAAgA0EBaiEDIAFBAWohASACQX9qIgINAAsLIAAL8wICAn8BfgJAIAJFDQAgACACaiIDQX9qIAE6AAAgACABOgAAIAJBA0kNACADQX5qIAE6AAAgACABOgABIANBfWogAToAACAAIAE6AAIgAkEHSQ0AIANBfGogAToAACAAIAE6AAMgAkEJSQ0AIABBACAAa0EDcSIEaiIDIAFB/wFxQYGChAhsIgE2AgAgAyACIARrQXxxIgRqIgJBfGogATYCACAEQQlJDQAgAyABNgIIIAMgATYCBCACQXhqIAE2AgAgAkF0aiABNgIAIARBGUkNACADIAE2AhggAyABNgIUIAMgATYCECADIAE2AgwgAkFwaiABNgIAIAJBbGogATYCACACQWhqIAE2AgAgAkFkaiABNgIAIAQgA0EEcUEYciIEayICQSBJDQAgAa0iBUIghiAFhCEFIAMgBGohAQNAIAEgBTcDGCABIAU3AxAgASAFNwMIIAEgBTcDACABQSBqIQEgAkFgaiICQR9LDQALCyAACy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAIajYCACADCy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAFajYCACADCx8AIAAgASACKAIEEAg2AgAgARAEGiAAIAJBCGo2AgQLCAAgAGdBH3MLugUBDX8jAEEQayIKJAACfyAEQQNNBEAgCkEANgIMIApBDGogAyAEEAsaIAAgASACIApBDGpBBBAVIgBBbCAAEAMbIAAgACAESxsMAQsgAEEAIAEoAgBBAXRBAmoQECENQVQgAygAACIGQQ9xIgBBCksNABogAiAAQQVqNgIAIAMgBGoiAkF8aiEMIAJBeWohDiACQXtqIRAgAEEGaiELQQQh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ASIDNgLE4AEgACgCvOABIQQgACABNgK84AEgACABIAJqNgK44AEgACABIAQgA2tqNgLA4AELpgEBAX8gACAAKALs4QEQFjYCyOABIABCADcD+OABIABCADcDuOABIABBwOABakIANwMAIABBqNAAaiIBQYyAgOAANgIAIABBADYCmOIBIABCADcDiOEBIABCAzcDgOEBIABBrNABakHgEikCADcCACAAQbTQAWpB6BIoAgA2AgAgACABNgIMIAAgAEGYIGo2AgggACAAQaAwajYCBCAAIABBEGo2AgALYQEBf0G4fyEDAkAgAUEDSQ0AIAIgABAhIgFBA3YiADYCCCACIAFBAXE2AgQgAiABQQF2QQNxIgM2AgACQCADQX9qIgFBAksNAAJAIAFBAWsOAgEAAgtBbA8LIAAhAwsgAwsMACAAIAEgAkEAEC4LiAQCA38CfiADEBYhBCAAQQBBKBAQIQAgBCACSwRAIAQPCyABRQRAQX8PCwJAAkAgA0EBRg0AIAEoAAAiBkGo6r5pRg0AQXYhAyAGQXBxQdDUtMIBRw0BQQghAyACQQhJDQEgAEEAQSgQECEAIAEoAAQhASAAQQE2AhQgACABrTcDAEEADwsgASACIAMQLyIDIAJLDQAgACADNgIYQXIhAyABIARqIgVBf2otAAAiAkEIcQ0AIAJBIHEiBkUEQEFwIQMgBS0AACIFQacBSw0BIAVBB3GtQgEgBUEDdkEKaq2GIgdCA4h+IAd8IQggBEEBaiEECyACQQZ2IQMgAkECdiEFAkAgAkEDcUF/aiICQQJLBEBBACECDAELAkACQAJAIAJBAWsOAgECAAsgASAEai0AACECIARBAWohBAwCCyABIARqLwAAIQIgBEECaiEEDAELIAEgBGooAAAhAiAEQQRqIQQLIAVBAXEhBQJ+AkACQAJAIANBf2oiA0ECTQRAIANBAWsOAgIDAQtCfyAGRQ0DGiABIARqMQAADAMLIAEgBGovAACtQoACfAwCCyABIARqKAAArQwBCyABIARqKQAACyEHIAAgBTYCICAAIAI2AhwgACAHNwMAQQAhAyAAQQA2AhQgACAHIAggBhsiBzcDCCAAIAdCgIAIIAdCgIAIVBs+AhALIAMLWwEBf0G4fyEDIAIQFiICIAFNBH8gACACakF/ai0AACIAQQNxQQJ0QaAeaigCACACaiAAQQZ2IgFBAnRBsB5qKAIAaiAAQSBxIgBFaiABRSAAQQV2cWoFQbh/CwsdACAAKAKQ4gEQWiAAQQA2AqDiASAAQgA3A5DiAQu1AwEFfyMAQZACayIKJABBuH8hBgJAIAVFDQAgBCwAACIIQf8BcSEHAkAgCEF/TARAIAdBgn9qQQF2IgggBU8NAkFsIQYgB0GBf2oiBUGAAk8NAiAEQQFqIQdBACEGA0AgBiAFTwRAIAUhBiAIIQcMAwUgACAGaiAHIAZBAXZqIgQtAABBBHY6AAAgACAGQQFyaiAELQAAQQ9xOgAAIAZBAmohBgwBCwAACwALIAcgBU8NASAAIARBAWogByAKEFMiBhADDQELIAYhBEEAIQYgAUEAQTQQECEJQQAhBQNAIAQgBkcEQCAAIAZqIggtAAAiAUELSwRAQWwhBgwDBSAJIAFBAnRqIgEgASgCAEEBajYCACAGQQFqIQZBASAILQAAdEEBdSAFaiEFDAILAAsLQWwhBiAFRQ0AIAUQFEEBaiIBQQxLDQAgAyABNgIAQQFBASABdCAFayIDEBQiAXQgA0cNACAAIARqIAFBAWoiADoAACAJIABBAnRqIgAgACgCAEEBajYCACAJKAIEIgBBAkkgAEEBcXINACACIARBAWo2AgAgB0EBaiEGCyAKQZACaiQAIAYLxhEBDH8jAEHwAGsiBSQAQWwhCwJAIANBCkkNACACLwAAIQogAi8AAiEJIAIvAAQhByAFQQhqIAQQDgJAIAMgByAJIApqakEGaiIMSQ0AIAUtAAohCCAFQdgAaiACQQZqIgIgChAGIgsQAw0BIAVBQGsgAiAKaiICIAkQBiILEAMNASAFQShqIAIgCWoiAiAHEAYiCxADDQEgBUEQaiACIAdqIAMgDGsQBiILEAMNASAAIAFqIg9BfWohECAEQQRqIQZBASELIAAgAUEDakECdiIDaiIMIANqIgIgA2oiDiEDIAIhBCAMIQcDQCALIAMgEElxBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgCS0AAyELIAcgBiAFQUBrIAgQAkECdGoiCS8BADsAACAFQUBrIAktAAIQASAJLQADIQogBCAGIAVBKGogCBACQQJ0aiIJLwEAOwAAIAVBKGogCS0AAhABIAktAAMhCSADIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgDS0AAyENIAAgC2oiCyAGIAVB2ABqIAgQAkECdGoiAC8BADsAACAFQdgAaiAALQACEAEgAC0AAyEAIAcgCmoiCiAGIAVBQGsgCBACQQJ0aiIHLwEAOwAAIAVBQGsgBy0AAhABIActAAMhByAEIAlqIgkgBiAFQShqIAgQAkECdGoiBC8BADsAACAFQShqIAQtAAIQASAELQADIQQgAyANaiIDIAYgBUEQaiAIEAJBAnRqIg0vAQA7AAAgBUEQaiANLQACEAEgACALaiEAIAcgCmohByAEIAlqIQQgAyANLQADaiEDIAVB2ABqEA0gBUFAaxANciAFQShqEA1yIAVBEGoQDXJFIQsMAQsLIAQgDksgByACS3INAEFsIQsgACAMSw0BIAxBfWohCQNAQQAgACAJSSAFQdgAahAEGwRAIAAgBiAFQdgAaiAIEAJBAnRqIgovAQA7AAAgBUHYAGogCi0AAhABIAAgCi0AA2oiACAGIAVB2ABqIAgQAkECdGoiCi8BADsAACAFQdgAaiAKLQACEAEgACAKLQADaiEADAEFIAxBfmohCgNAIAVB2ABqEAQgACAKS3JFBEAgACAGIAVB2ABqIAgQAkECdGoiCS8BADsAACAFQdgAaiAJLQACEAEgACAJLQADaiEADAELCwNAIAAgCk0EQCAAIAYgBUHYAGogCBACQQJ0aiIJLwEAOwAAIAVB2ABqIAktAAIQASAAIAktAANqIQAMAQsLAkAgACAMTw0AIAAgBiAFQdgAaiAIEAIiAEECdGoiDC0AADoAACAMLQADQQFGBEAgBUHYAGogDC0AAhABDAELIAUoAlxBH0sNACAFQdgAaiAGIABBAnRqLQACEAEgBSgCXEEhSQ0AIAVBIDYCXAsgAkF9aiEMA0BBACAHIAxJIAVBQGsQBBsEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiIAIAYgBUFAayAIEAJBAnRqIgcvAQA7AAAgBUFAayAHLQACEAEgACAHLQADaiEHDAEFIAJBfmohDANAIAVBQGsQBCAHIAxLckUEQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwNAIAcgDE0EQCAHIAYgBUFAayAIEAJBAnRqIgAvAQA7AAAgBUFAayAALQACEAEgByAALQADaiEHDAELCwJAIAcgAk8NACAHIAYgBUFAayAIEAIiAEECdGoiAi0AADoAACACLQADQQFGBEAgBUFAayACLQACEAEMAQsgBSgCREEfSw0AIAVBQGsgBiAAQQJ0ai0AAhABIAUoAkRBIUkNACAFQSA2AkQLIA5BfWohAgNAQQAgBCACSSAFQShqEAQbBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2oiACAGIAVBKGogCBACQQJ0aiIELwEAOwAAIAVBKGogBC0AAhABIAAgBC0AA2ohBAwBBSAOQX5qIQIDQCAFQShqEAQgBCACS3JFBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsDQCAEIAJNBEAgBCAGIAVBKGogCBACQQJ0aiIALwEAOwAAIAVBKGogAC0AAhABIAQgAC0AA2ohBAwBCwsCQCAEIA5PDQAgBCAGIAVBKGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBKGogAi0AAhABDAELIAUoAixBH0sNACAFQShqIAYgAEECdGotAAIQASAFKAIsQSFJDQAgBUEgNgIsCwNAQQAgAyAQSSAFQRBqEAQbBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2oiACAGIAVBEGogCBACQQJ0aiICLwEAOwAAIAVBEGogAi0AAhABIAAgAi0AA2ohAwwBBSAPQX5qIQIDQCAFQRBqEAQgAyACS3JFBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsDQCADIAJNBEAgAyAGIAVBEGogCBACQQJ0aiIALwEAOwAAIAVBEGogAC0AAhABIAMgAC0AA2ohAwwBCwsCQCADIA9PDQAgAyAGIAVBEGogCBACIgBBAnRqIgItAAA6AAAgAi0AA0EBRgRAIAVBEGogAi0AAhABDAELIAUoAhRBH0sNACAFQRBqIAYgAEECdGotAAIQASAFKAIUQSFJDQAgBUEgNgIUCyABQWwgBUHYAGoQCiAFQUBrEApxIAVBKGoQCnEgBUEQahAKcRshCwwJCwAACwALAAALAAsAAAsACwAACwALQWwhCwsgBUHwAGokACALC7UEAQ5/IwBBEGsiBiQAIAZBBGogABAOQVQhBQJAIARB3AtJDQAgBi0ABCEHIANB8ARqQQBB7AAQECEIIAdBDEsNACADQdwJaiIJIAggBkEIaiAGQQxqIAEgAhAxIhAQA0UEQCAGKAIMIgQgB0sNASADQdwFaiEPIANBpAVqIREgAEEEaiESIANBqAVqIQEgBCEFA0AgBSICQX9qIQUgCCACQQJ0aigCAEUNAAsgAkEBaiEOQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgASALaiAKNgIAIAVBAWohBSAKIAxqIQoMAQsLIAEgCjYCAEEAIQUgBigCCCELA0AgBSALRkUEQCABIAUgCWotAAAiDEECdGoiDSANKAIAIg1BAWo2AgAgDyANQQF0aiINIAw6AAEgDSAFOgAAIAVBAWohBQwBCwtBACEBIANBADYCqAUgBEF/cyAHaiEJQQEhBQNAIAUgDk9FBEAgCCAFQQJ0IgtqKAIAIQwgAyALaiABNgIAIAwgBSAJanQgAWohASAFQQFqIQUMAQsLIAcgBEEBaiIBIAJrIgRrQQFqIQgDQEEBIQUgBCAIT0UEQANAIAUgDk9FBEAgBUECdCIJIAMgBEE0bGpqIAMgCWooAgAgBHY2AgAgBUEBaiEFDAELCyAEQQFqIQQMAQsLIBIgByAPIAogESADIAIgARBkIAZBAToABSAGIAc6AAYgACAGKAIENgIACyAQIQULIAZBEGokACAFC8ENAQt/IwBB8ABrIgUkAEFsIQkCQCADQQpJDQAgAi8AACEKIAIvAAIhDCACLwAEIQYgBUEIaiAEEA4CQCADIAYgCiAMampBBmoiDUkNACAFLQAKIQcgBUHYAGogAkEGaiICIAoQBiIJEAMNASAFQUBrIAIgCmoiAiAMEAYiCRADDQEgBUEoaiACIAxqIgIgBhAGIgkQAw0BIAVBEGogAiAGaiADIA1rEAYiCRADDQEgACABaiIOQX1qIQ8gBEEEaiEGQQEhCSAAIAFBA2pBAnYiAmoiCiACaiIMIAJqIg0hAyAMIQQgCiECA0AgCSADIA9JcQRAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAACAGIAVBQGsgBxACQQF0aiIILQAAIQsgBUFAayAILQABEAEgAiALOgAAIAYgBUEoaiAHEAJBAXRqIggtAAAhCyAFQShqIAgtAAEQASAEIAs6AAAgBiAFQRBqIAcQAkEBdGoiCC0AACELIAVBEGogCC0AARABIAMgCzoAACAGIAVB2ABqIAcQAkEBdGoiCC0AACELIAVB2ABqIAgtAAEQASAAIAs6AAEgBiAFQUBrIAcQAkEBdGoiCC0AACELIAVBQGsgCC0AARABIAIgCzoAASAGIAVBKGogBxACQQF0aiIILQAAIQsgBUEoaiAILQABEAEgBCALOgABIAYgBUEQaiAHEAJBAXRqIggtAAAhCyAFQRBqIAgtAAEQASADIAs6AAEgA0ECaiEDIARBAmohBCACQQJqIQIgAEECaiEAIAkgBUHYAGoQDUVxIAVBQGsQDUVxIAVBKGoQDUVxIAVBEGoQDUVxIQkMAQsLIAQgDUsgAiAMS3INAEFsIQkgACAKSw0BIApBfWohCQNAIAVB2ABqEAQgACAJT3JFBEAgBiAFQdgAaiAHEAJBAXRqIggtAAAhCyAFQdgAaiAILQABEAEgACALOgAAIAYgBUHYAGogBxACQQF0aiIILQAAIQsgBUHYAGogCC0AARABIAAgCzoAASAAQQJqIQAMAQsLA0AgBUHYAGoQBCAAIApPckUEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCwNAIAAgCkkEQCAGIAVB2ABqIAcQAkEBdGoiCS0AACEIIAVB2ABqIAktAAEQASAAIAg6AAAgAEEBaiEADAELCyAMQX1qIQADQCAFQUBrEAQgAiAAT3JFBEAgBiAFQUBrIAcQAkEBdGoiCi0AACEJIAVBQGsgCi0AARABIAIgCToAACAGIAVBQGsgBxACQQF0aiIKLQAAIQkgBUFAayAKLQABEAEgAiAJOgABIAJBAmohAgwBCwsDQCAFQUBrEAQgAiAMT3JFBEAgBiAFQUBrIAcQAkEBdGoiAC0AACEKIAVBQGsgAC0AARABIAIgCjoAACACQQFqIQIMAQsLA0AgAiAMSQRAIAYgBUFAayAHEAJBAXRqIgAtAAAhCiAFQUBrIAAtAAEQASACIAo6AAAgAkEBaiECDAELCyANQX1qIQADQCAFQShqEAQgBCAAT3JFBEAgBiAFQShqIAcQAkEBdGoiAi0AACEKIAVBKGogAi0AARABIAQgCjoAACAGIAVBKGogBxACQQF0aiICLQAAIQogBUEoaiACLQABEAEgBCAKOgABIARBAmohBAwBCwsDQCAFQShqEAQgBCANT3JFBEAgBiAFQShqIAcQAkEBdGoiAC0AACECIAVBKGogAC0AARABIAQgAjoAACAEQQFqIQQMAQsLA0AgBCANSQRAIAYgBUEoaiAHEAJBAXRqIgAtAAAhAiAFQShqIAAtAAEQASAEIAI6AAAgBEEBaiEEDAELCwNAIAVBEGoQBCADIA9PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIAYgBUEQaiAHEAJBAXRqIgAtAAAhAiAFQRBqIAAtAAEQASADIAI6AAEgA0ECaiEDDAELCwNAIAVBEGoQBCADIA5PckUEQCAGIAVBEGogBxACQQF0aiIALQAAIQIgBUEQaiAALQABEAEgAyACOgAAIANBAWohAwwBCwsDQCADIA5JBEAgBiAFQRBqIAcQAkEBdGoiAC0AACECIAVBEGogAC0AARABIAMgAjoAACADQQFqIQMMAQsLIAFBbCAFQdgAahAKIAVBQGsQCnEgBUEoahAKcSAFQRBqEApxGyEJDAELQWwhCQsgBUHwAGokACAJC8oCAQR/IwBBIGsiBSQAIAUgBBAOIAUtAAIhByAFQQhqIAIgAxAGIgIQA0UEQCAEQQRqIQIgACABaiIDQX1qIQQDQCAFQQhqEAQgACAET3JFBEAgAiAFQQhqIAcQAkEBdGoiBi0AACEIIAVBCGogBi0AARABIAAgCDoAACACIAVBCGogBxACQQF0aiIGLQAAIQggBUEIaiAGLQABEAEgACAIOgABIABBAmohAAwBCwsDQCAFQQhqEAQgACADT3JFBEAgAiAFQQhqIAcQAkEBdGoiBC0AACEGIAVBCGogBC0AARABIAAgBjoAACAAQQFqIQAMAQsLA0AgACADT0UEQCACIAVBCGogBxACQQF0aiIELQAAIQYgBUEIaiAELQABEAEgACAGOgAAIABBAWohAAwBCwsgAUFsIAVBCGoQChshAgsgBUEgaiQAIAILtgMBCX8jAEEQayIGJAAgBkEANgIMIAZBADYCCEFUIQQCQAJAIANBQGsiDCADIAZBCGogBkEMaiABIAIQMSICEAMNACAGQQRqIAAQDiAGKAIMIgcgBi0ABEEBaksNASAAQQRqIQogBkEAOgAFIAYgBzoABiAAIAYoAgQ2AgAgB0EBaiEJQQEhBANAIAQgCUkEQCADIARBAnRqIgEoAgAhACABIAU2AgAgACAEQX9qdCAFaiEFIARBAWohBAwBCwsgB0EBaiEHQQAhBSAGKAIIIQkDQCAFIAlGDQEgAyAFIAxqLQAAIgRBAnRqIgBBASAEdEEBdSILIAAoAgAiAWoiADYCACAHIARrIQhBACEEAkAgC0EDTQRAA0AgBCALRg0CIAogASAEakEBdGoiACAIOgABIAAgBToAACAEQQFqIQQMAAALAAsDQCABIABPDQEgCiABQQF0aiIEIAg6AAEgBCAFOgAAIAQgCDoAAyAEIAU6AAIgBCAIOgAFIAQgBToABCAEIAg6AAcgBCAFOgAGIAFBBGohAQwAAAsACyAFQQFqIQUMAAALAAsgAiEECyAGQRBqJAAgBAutAQECfwJAQYQgKAIAIABHIAAoAgBBAXYiAyABa0F4aiICQXhxQQhHcgR/IAIFIAMQJ0UNASACQQhqC0EQSQ0AIAAgACgCACICQQFxIAAgAWpBD2pBeHEiASAAa0EBdHI2AgAgASAANgIEIAEgASgCAEEBcSAAIAJBAXZqIAFrIgJBAXRyNgIAQYQgIAEgAkH/////B3FqQQRqQYQgKAIAIABGGyABNgIAIAEQJQsLygIBBX8CQAJAAkAgAEEIIABBCEsbZ0EfcyAAaUEBR2oiAUEESSAAIAF2cg0AIAFBAnRB/B5qKAIAIgJFDQADQCACQXhqIgMoAgBBAXZBeGoiBSAATwRAIAIgBUEIIAVBCEsbZ0Efc0ECdEGAH2oiASgCAEYEQCABIAIoAgQ2AgALDAMLIARBHksNASAEQQFqIQQgAigCBCICDQALC0EAIQMgAUEgTw0BA0AgAUECdEGAH2ooAgAiAkUEQCABQR5LIQIgAUEBaiEBIAJFDQEMAwsLIAIgAkF4aiIDKAIAQQF2QXhqIgFBCCABQQhLG2dBH3NBAnRBgB9qIgEoAgBGBEAgASACKAIENgIACwsgAigCACIBBEAgASACKAIENgIECyACKAIEIgEEQCABIAIoAgA2AgALIAMgAygCAEEBcjYCACADIAAQNwsgAwvhCwINfwV+IwBB8ABrIgckACAHIAAoAvDhASIINgJcIAEgAmohDSAIIAAoAoDiAWohDwJAAkAgBUUEQCABIQQMAQsgACgCxOABIRAgACgCwOABIREgACgCvOABIQ4gAEEBNgKM4QFBACEIA0AgCEEDRwRAIAcgCEECdCICaiAAIAJqQazQAWooAgA2AkQgCEEBaiEIDAELC0FsIQwgB0EYaiADIAQQBhADDQEgB0EsaiAHQRhqIAAoAgAQEyAHQTRqIAdBGGogACgCCBATIAdBPGogB0EYaiAAKAIEEBMgDUFgaiESIAEhBEEAIQwDQCAHKAIwIAcoAixBA3RqKQIAIhRCEIinQf8BcSEIIAcoAkAgBygCPEEDdGopAgAiFUIQiKdB/wFxIQsgBygCOCAHKAI0QQN0aikCACIWQiCIpyEJIBVCIIghFyAUQiCIpyECAkAgFkIQiKdB/wFxIgNBAk8EQAJAIAZFIANBGUlyRQRAIAkgB0EYaiADQSAgBygCHGsiCiAKIANLGyIKEAUgAyAKayIDdGohCSAHQRhqEAQaIANFDQEgB0EYaiADEAUgCWohCQwBCyAHQRhqIAMQBSAJaiEJIAdBGGoQBBoLIAcpAkQhGCAHIAk2AkQgByAYNwNIDAELAkAgA0UEQCACBEAgBygCRCEJDAMLIAcoAkghCQwBCwJAAkAgB0EYakEBEAUgCSACRWpqIgNBA0YEQCAHKAJEQX9qIgMgA0VqIQkMAQsgA0ECdCAHaigCRCIJIAlFaiEJIANBAUYNAQsgByAHKAJINgJMCwsgByAHKAJENgJIIAcgCTYCRAsgF6chAyALBEAgB0EYaiALEAUgA2ohAwsgCCALakEUTwRAIAdBGGoQBBoLIAgEQCAHQRhqIAgQBSACaiECCyAHQRhqEAQaIAcgB0EYaiAUQhiIp0H/AXEQCCAUp0H//wNxajYCLCAHIAdBGGogFUIYiKdB/wFxEAggFadB//8DcWo2AjwgB0EYahAEGiAHIAdBGGogFkIYiKdB/wFxEAggFqdB//8DcWo2AjQgByACNgJgIAcoAlwhCiAHIAk2AmggByADNgJkAkACQAJAIAQgAiADaiILaiASSw0AIAIgCmoiEyAPSw0AIA0gBGsgC0Egak8NAQsgByAHKQNoNwMQIAcgBykDYDcDCCAEIA0gB0EIaiAHQdwAaiAPIA4gESAQEB4hCwwBCyACIARqIQggBCAKEAcgAkERTwRAIARBEGohAgNAIAIgCkEQaiIKEAcgAkEQaiICIAhJDQALCyAIIAlrIQIgByATNgJcIAkgCCAOa0sEQCAJIAggEWtLBEBBbCELDAILIBAgAiAOayICaiIKIANqIBBNBEAgCCAKIAMQDxoMAgsgCCAKQQAgAmsQDyEIIAcgAiADaiIDNgJkIAggAmshCCAOIQILIAlBEE8EQCADIAhqIQMDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALDAELAkAgCUEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgCUECdCIDQcAeaigCAGoiAhAXIAIgA0HgHmooAgBrIQIgBygCZCEDDAELIAggAhAMCyADQQlJDQAgAyAIaiEDIAhBCGoiCCACQQhqIgJrQQ9MBEADQCAIIAIQDCACQQhqIQIgCEEIaiIIIANJDQAMAgALAAsDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALCyAHQRhqEAQaIAsgDCALEAMiAhshDCAEIAQgC2ogAhshBCAFQX9qIgUNAAsgDBADDQFBbCEMIAdBGGoQBEECSQ0BQQAhCANAIAhBA0cEQCAAIAhBAnQiAmpBrNABaiACIAdqKAJENgIAIAhBAWohCAwBCwsgBygCXCEIC0G6fyEMIA8gCGsiACANIARrSw0AIAQEfyAEIAggABALIABqBUEACyABayEMCyAHQfAAaiQAIAwLkRcCFn8FfiMAQdABayIHJAAgByAAKALw4QEiCDYCvAEgASACaiESIAggACgCgOIBaiETAkACQCAFRQRAIAEhAwwBCyAAKALE4AEhESAAKALA4AEhFSAAKAK84AEhDyAAQQE2AozhAUEAIQgDQCAIQQNHBEAgByAIQQJ0IgJqIAAgAmpBrNABaigCADYCVCAIQQFqIQgMAQsLIAcgETYCZCAHIA82AmAgByABIA9rNgJoQWwhECAHQShqIAMgBBAGEAMNASAFQQQgBUEESBshFyAHQTxqIAdBKGogACgCABATIAdBxABqIAdBKGogACgCCBATIAdBzABqIAdB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IAdB0AFqJAAgEAslACAAQgA3AgAgAEEAOwEIIABBADoACyAAIAE2AgwgACACOgAKC7QFAQN/IwBBMGsiBCQAIABB/wFqIgVBfWohBgJAIAMvAQIEQCAEQRhqIAEgAhAGIgIQAw0BIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahASOgAAIAMgBEEIaiAEQRhqEBI6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0FIAEgBEEQaiAEQRhqEBI6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBSABIARBCGogBEEYahASOgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEjoAACABIAJqIABrIQIMAwsgAyAEQRBqIARBGGoQEjoAAiADIARBCGogBEEYahASOgADIANBBGohAwwAAAsACyAEQRhqIAEgAhAGIgIQAw0AIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahAROgAAIAMgBEEIaiAEQRhqEBE6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0EIAEgBEEQaiAEQRhqEBE6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBCABIARBCGogBEEYahAROgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEToAACABIAJqIABrIQIMAgsgAyAEQRBqIARBGGoQEToAAiADIARBCGogBEEYahAROgADIANBBGohAwwAAAsACyAEQTBqJAAgAgtpAQF/An8CQAJAIAJBB00NACABKAAAQbfIwuF+Rw0AIAAgASgABDYCmOIBQWIgAEEQaiABIAIQPiIDEAMNAhogAEKBgICAEDcDiOEBIAAgASADaiACIANrECoMAQsgACABIAIQKgtBAAsLrQMBBn8jAEGAAWsiAyQAQWIhCAJAIAJBCUkNACAAQZjQAGogAUEIaiIEIAJBeGogAEGY0AAQMyIFEAMiBg0AIANBHzYCfCADIANB/ABqIANB+ABqIAQgBCAFaiAGGyIEIAEgAmoiAiAEaxAVIgUQAw0AIAMoAnwiBkEfSw0AIAMoAngiB0EJTw0AIABBiCBqIAMgBkGAC0GADCAHEBggA0E0NgJ8IAMgA0H8AGogA0H4AGogBCAFaiIEIAIgBGsQFSIFEAMNACADKAJ8IgZBNEsNACADKAJ4IgdBCk8NACAAQZAwaiADIAZBgA1B4A4gBxAYIANBIzYCfCADIANB/ABqIANB+ABqIAQgBWoiBCACIARrEBUiBRADDQAgAygCfCIGQSNLDQAgAygCeCIHQQpPDQAgACADIAZBwBBB0BEgBxAYIAQgBWoiBEEMaiIFIAJLDQAgAiAFayEFQQAhAgNAIAJBA0cEQCAEKAAAIgZBf2ogBU8NAiAAIAJBAnRqQZzQAWogBjYCACACQQFqIQIgBEEEaiEEDAELCyAEIAFrIQgLIANBgAFqJAAgCAtGAQN/IABBCGohAyAAKAIEIQJBACEAA0AgACACdkUEQCABIAMgAEEDdGotAAJBFktqIQEgAEEBaiEADAELCyABQQggAmt0C4YDAQV/Qbh/IQcCQCADRQ0AIAItAAAiBEUEQCABQQA2AgBBAUG4fyADQQFGGw8LAn8gAkEBaiIFIARBGHRBGHUiBkF/Sg0AGiAGQX9GBEAgA0EDSA0CIAUvAABBgP4BaiEEIAJBA2oMAQsgA0ECSA0BIAItAAEgBEEIdHJBgIB+aiEEIAJBAmoLIQUgASAENgIAIAVBAWoiASACIANqIgNLDQBBbCEHIABBEGogACAFLQAAIgVBBnZBI0EJIAEgAyABa0HAEEHQEUHwEiAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBmCBqIABBCGogBUEEdkEDcUEfQQggASABIAZqIAgbIgEgAyABa0GAC0GADEGAFyAAKAKM4QEgACgCnOIBIAQQHyIGEAMiCA0AIABBoDBqIABBBGogBUECdkEDcUE0QQkgASABIAZqIAgbIgEgAyABa0GADUHgDkGQGSAAKAKM4QEgACgCnOIBIAQQHyIAEAMNACAAIAFqIAJrIQcLIAcLrQMBCn8jAEGABGsiCCQAAn9BUiACQf8BSw0AGkFUIANBDEsNABogAkEBaiELIABBBGohCUGAgAQgA0F/anRBEHUhCkEAIQJBASEEQQEgA3QiB0F/aiIMIQUDQCACIAtGRQRAAkAgASACQQF0Ig1qLwEAIgZB//8DRgRAIAkgBUECdGogAjoAAiAFQX9qIQVBASEGDAELIARBACAKIAZBEHRBEHVKGyEECyAIIA1qIAY7AQAgAkEBaiECDAELCyAAIAQ7AQIgACADOwEAIAdBA3YgB0EBdmpBA2ohBkEAIQRBACECA0AgBCALRkUEQCABIARBAXRqLgEAIQpBACEAA0AgACAKTkUEQCAJIAJBAnRqIAQ6AAIDQCACIAZqIAxxIgIgBUsNAAsgAEEBaiEADAELCyAEQQFqIQQMAQsLQX8gAg0AGkEAIQIDfyACIAdGBH9BAAUgCCAJIAJBAnRqIgAtAAJBAXRqIgEgAS8BACIBQQFqOwEAIAAgAyABEBRrIgU6AAMgACABIAVB/wFxdCAHazsBACACQQFqIQIMAQsLCyEFIAhBgARqJAAgBQvjBgEIf0FsIQcCQCACQQNJDQACQAJAAkACQCABLQAAIgNBA3EiCUEBaw4DAwEAAgsgACgCiOEBDQBBYg8LIAJBBUkNAkEDIQYgASgAACEFAn8CQAJAIANBAnZBA3EiCEF+aiIEQQFNBEAgBEEBaw0BDAILIAVBDnZB/wdxIQQgBUEEdkH/B3EhAyAIRQwCCyAFQRJ2IQRBBCEGIAVBBHZB//8AcSEDQQAMAQsgBUEEdkH//w9xIgNBgIAISw0DIAEtAARBCnQgBUEWdnIhBEEFIQZBAAshBSAEIAZqIgogAksNAgJAIANBgQZJDQAgACgCnOIBRQ0AQQAhAgNAIAJBg4ABSw0BIAJBQGshAgwAAAsACwJ/IAlBA0YEQCABIAZqIQEgAEHw4gFqIQIgACgCDCEGIAUEQCACIAMgASAEIAYQXwwCCyACIAMgASAEIAYQXQwBCyAAQbjQAWohAiABIAZqIQEgAEHw4gFqIQYgAEGo0ABqIQggBQRAIAggBiADIAEgBCACEF4MAQsgCCAGIAMgASAEIAIQXAsQAw0CIAAgAzYCgOIBIABBATYCiOEBIAAgAEHw4gFqNgLw4QEgCUECRgRAIAAgAEGo0ABqNgIMCyAAIANqIgBBiOMBakIANwAAIABBgOMBakIANwAAIABB+OIBakIANwAAIABB8OIBakIANwAAIAoPCwJ/AkACQAJAIANBAnZBA3FBf2oiBEECSw0AIARBAWsOAgACAQtBASEEIANBA3YMAgtBAiEEIAEvAABBBHYMAQtBAyEEIAEQIUEEdgsiAyAEaiIFQSBqIAJLBEAgBSACSw0CIABB8OIBaiABIARqIAMQCyEBIAAgAzYCgOIBIAAgATYC8OEBIAEgA2oiAEIANwAYIABCADcAECAAQgA3AAggAEIANwAAIAUPCyAAIAM2AoDiASAAIAEgBGo2AvDhASAFDwsCfwJAAkACQCADQQJ2QQNxQX9qIgRBAksNACAEQQFrDgIAAgELQQEhByADQQN2DAILQQIhByABLwAAQQR2DAELIAJBBEkgARAhIgJBj4CAAUtyDQFBAyEHIAJBBHYLIQIgAEHw4gFqIAEgB2otAAAgAkEgahAQIQEgACACNgKA4gEgACABNgLw4QEgB0EBaiEHCyAHC0sAIABC+erQ0OfJoeThADcDICAAQgA3AxggAELP1tO+0ser2UI3AxAgAELW64Lu6v2J9eAANwMIIABCADcDACAAQShqQQBBKBAQGgviAgICfwV+IABBKGoiASAAKAJIaiECAn4gACkDACIDQiBaBEAgACkDECIEQgeJIAApAwgiBUIBiXwgACkDGCIGQgyJfCAAKQMgIgdCEol8IAUQGSAEEBkgBhAZIAcQGQwBCyAAKQMYQsXP2bLx5brqJ3wLIAN8IQMDQCABQQhqIgAgAk0EQEIAIAEpAAAQCSADhUIbiUKHla+vmLbem55/fkLj3MqV/M7y9YV/fCEDIAAhAQwBCwsCQCABQQRqIgAgAksEQCABIQAMAQsgASgAAK1Ch5Wvr5i23puef34gA4VCF4lCz9bTvtLHq9lCfkL5893xmfaZqxZ8IQMLA0AgACACSQRAIAAxAABCxc/ZsvHluuonfiADhUILiUKHla+vmLbem55/fiEDIABBAWohAAwBCwsgA0IhiCADhULP1tO+0ser2UJ+IgNCHYggA4VC+fPd8Zn2masWfiIDQiCIIAOFC+8CAgJ/BH4gACAAKQMAIAKtfDcDAAJAAkAgACgCSCIDIAJqIgRBH00EQCABRQ0BIAAgA2pBKGogASACECAgACgCSCACaiEEDAELIAEgAmohAgJ/IAMEQCAAQShqIgQgA2ogAUEgIANrECAgACAAKQMIIAQpAAAQCTcDCCAAIAApAxAgACkAMBAJNwMQIAAgACkDGCAAKQA4EAk3AxggACAAKQMgIABBQGspAAAQCTcDICAAKAJIIQMgAEEANgJIIAEgA2tBIGohAQsgAUEgaiACTQsEQCACQWBqIQMgACkDICEFIAApAxghBiAAKQMQIQcgACkDCCEIA0AgCCABKQAAEAkhCCAHIAEpAAgQCSEHIAYgASkAEBAJIQYgBSABKQAYEAkhBSABQSBqIgEgA00NAAsgACAFNwMgIAAgBjcDGCAAIAc3AxAgACAINwMICyABIAJPDQEgAEEoaiABIAIgAWsiBBAgCyAAIAQ2AkgLCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQEBogAwVBun8LCy8BAX8gAEUEQEG2f0EAIAMbDwtBun8hBCADIAFNBH8gACACIAMQCxogAwVBun8LC6gCAQZ/IwBBEGsiByQAIABB2OABaikDAEKAgIAQViEIQbh/IQUCQCAEQf//B0sNACAAIAMgBBBCIgUQAyIGDQAgACgCnOIBIQkgACAHQQxqIAMgAyAFaiAGGyIKIARBACAFIAYbayIGEEAiAxADBEAgAyEFDAELIAcoAgwhBCABRQRAQbp/IQUgBEEASg0BCyAGIANrIQUgAyAKaiEDAkAgCQRAIABBADYCnOIBDAELAkACQAJAIARBBUgNACAAQdjgAWopAwBCgICACFgNAAwBCyAAQQA2ApziAQwBCyAAKAIIED8hBiAAQQA2ApziASAGQRRPDQELIAAgASACIAMgBSAEIAgQOSEFDAELIAAgASACIAMgBSAEIAgQOiEFCyAHQRBqJAAgBQtnACAAQdDgAWogASACIAAoAuzhARAuIgEQAwRAIAEPC0G4fyECAkAgAQ0AIABB7OABaigCACIBBEBBYCECIAAoApjiASABRw0BC0EAIQIgAEHw4AFqKAIARQ0AIABBkOEBahBDCyACCycBAX8QVyIERQRAQUAPCyAEIAAgASACIAMgBBBLEE8hACAEEFYgAAs/AQF/AkACQAJAIAAoAqDiAUEBaiIBQQJLDQAgAUEBaw4CAAECCyAAEDBBAA8LIABBADYCoOIBCyAAKAKU4gELvAMCB38BfiMAQRBrIgkkAEG4fyEGAkAgBCgCACIIQQVBCSAAKALs4QEiBRtJDQAgAygCACIHQQFBBSAFGyAFEC8iBRADBEAgBSEGDAELIAggBUEDakkNACAAIAcgBRBJIgYQAw0AIAEgAmohCiAAQZDhAWohCyAIIAVrIQIgBSAHaiEHIAEhBQNAIAcgAiAJECwiBhADDQEgAkF9aiICIAZJBEBBuH8hBgwCCyAJKAIAIghBAksEQEFsIQYMAgsgB0EDaiEHAn8CQAJAAkAgCEEBaw4CAgABCyAAIAUgCiAFayAHIAYQSAwCCyAFIAogBWsgByAGEEcMAQsgBSAKIAVrIActAAAgCSgCCBBGCyIIEAMEQCAIIQYMAgsgACgC8OABBEAgCyAFIAgQRQsgAiAGayECIAYgB2ohByAFIAhqIQUgCSgCBEUNAAsgACkD0OABIgxCf1IEQEFsIQYgDCAFIAFrrFINAQsgACgC8OABBEBBaiEGIAJBBEkNASALEEQhDCAHKAAAIAynRw0BIAdBBGohByACQXxqIQILIAMgBzYCACAEIAI2AgAgBSABayEGCyAJQRBqJAAgBgsuACAAECsCf0EAQQAQAw0AGiABRSACRXJFBEBBYiAAIAEgAhA9EAMNARoLQQALCzcAIAEEQCAAIAAoAsTgASABKAIEIAEoAghqRzYCnOIBCyAAECtBABADIAFFckUEQCAAIAEQWwsL0QIBB38jAEEQayIGJAAgBiAENgIIIAYgAzYCDCAFBEAgBSgCBCEKIAUoAgghCQsgASEIAkACQANAIAAoAuzhARAWIQsCQANAIAQgC0kNASADKAAAQXBxQdDUtMIBRgRAIAMgBBAiIgcQAw0EIAQgB2shBCADIAdqIQMMAQsLIAYgAzYCDCAGIAQ2AggCQCAFBEAgACAFEE5BACEHQQAQA0UNAQwFCyAAIAogCRBNIgcQAw0ECyAAIAgQUCAMQQFHQQAgACAIIAIgBkEMaiAGQQhqEEwiByIDa0EAIAMQAxtBCkdyRQRAQbh/IQcMBAsgBxADDQMgAiAHayECIAcgCGohCEEBIQwgBigCDCEDIAYoAgghBAwBCwsgBiADNgIMIAYgBDYCCEG4fyEHIAQNASAIIAFrIQcMAQsgBiADNgIMIAYgBDYCCAsgBkEQaiQAIAcLRgECfyABIAAoArjgASICRwRAIAAgAjYCxOABIAAgATYCuOABIAAoArzgASEDIAAgATYCvOABIAAgASADIAJrajYCwOABCwutAgIEfwF+IwBBQGoiBCQAAkACQCACQQhJDQAgASgAAEFwcUHQ1LTCAUcNACABIAIQIiEBIABCADcDCCAAQQA2AgQgACABNgIADAELIARBGGogASACEC0iAxADBEAgACADEBoMAQsgAwRAIABBuH8QGgwBCyACIAQoAjAiA2shAiABIANqIQMDQAJAIAAgAyACIARBCGoQLCIFEAMEfyAFBSACIAVBA2oiBU8NAUG4fwsQGgwCCyAGQQFqIQYgAiAFayECIAMgBWohAyAEKAIMRQ0ACyAEKAI4BEAgAkEDTQRAIABBuH8QGgwCCyADQQRqIQMLIAQoAighAiAEKQMYIQcgAEEANgIEIAAgAyABazYCACAAIAIgBmytIAcgB0J/URs3AwgLIARBQGskAAslAQF/IwBBEGsiAiQAIAIgACABEFEgAigCACEAIAJBEGokACAAC30BBH8jAEGQBGsiBCQAIARB/wE2AggCQCAEQRBqIARBCGogBEEMaiABIAIQFSIGEAMEQCAGIQUMAQtBVCEFIAQoAgwiB0EGSw0AIAMgBEEQaiAEKAIIIAcQQSIFEAMNACAAIAEgBmogAiAGayADEDwhBQsgBEGQBGokACAFC4cBAgJ/An5BABAWIQMCQANAIAEgA08EQAJAIAAoAABBcHFB0NS0wgFGBEAgACABECIiAhADRQ0BQn4PCyAAIAEQVSIEQn1WDQMgBCAFfCIFIARUIQJCfiEEIAINAyAAIAEQUiICEAMNAwsgASACayEBIAAgAmohAAwBCwtCfiAFIAEbIQQLIAQLPwIBfwF+IwBBMGsiAiQAAn5CfiACQQhqIAAgARAtDQAaQgAgAigCHEEBRg0AGiACKQMICyEDIAJBMGokACADC40BAQJ/IwBBMGsiASQAAkAgAEUNACAAKAKI4gENACABIABB/OEBaigCADYCKCABIAApAvThATcDICAAEDAgACgCqOIBIQIgASABKAIoNgIYIAEgASkDIDcDECACIAFBEGoQGyAAQQA2AqjiASABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALKgECfyMAQRBrIgAkACAAQQA2AgggAEIANwMAIAAQWCEBIABBEGokACABC4cBAQN/IwBBEGsiAiQAAkAgACgCAEUgACgCBEVzDQAgAiAAKAIINgIIIAIgACkCADcDAAJ/IAIoAgAiAQRAIAIoAghBqOMJIAERBQAMAQtBqOMJECgLIgFFDQAgASAAKQIANwL04QEgAUH84QFqIAAoAgg2AgAgARBZIAEhAwsgAkEQaiQAIAMLywEBAn8jAEEgayIBJAAgAEGBgIDAADYCtOIBIABBADYCiOIBIABBADYC7OEBIABCADcDkOIBIABBADYCpOMJIABBADYC3OIBIABCADcCzOIBIABBADYCvOIBIABBADYCxOABIABCADcCnOIBIABBpOIBakIANwIAIABBrOIBakEANgIAIAFCADcCECABQgA3AhggASABKQMYNwMIIAEgASkDEDcDACABKAIIQQh2QQFxIQIgAEEANgLg4gEgACACNgKM4gEgAUEgaiQAC3YBA38jAEEwayIBJAAgAARAIAEgAEHE0AFqIgIoAgA2AiggASAAKQK80AE3AyAgACgCACEDIAEgAigCADYCGCABIAApArzQATcDECADIAFBEGoQGyABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALzAEBAX8gACABKAK00AE2ApjiASAAIAEoAgQiAjYCwOABIAAgAjYCvOABIAAgAiABKAIIaiICNgK44AEgACACNgLE4AEgASgCuNABBEAgAEKBgICAEDcDiOEBIAAgAUGk0ABqNgIMIAAgAUGUIGo2AgggACABQZwwajYCBCAAIAFBDGo2AgAgAEGs0AFqIAFBqNABaigCADYCACAAQbDQAWogAUGs0AFqKAIANgIAIABBtNABaiABQbDQAWooAgA2AgAPCyAAQgA3A4jhAQs7ACACRQRAQbp/DwsgBEUEQEFsDwsgAiAEEGAEQCAAIAEgAiADIAQgBRBhDwsgACABIAIgAyAEIAUQZQtGAQF/IwBBEGsiBSQAIAVBCGogBBAOAn8gBS0ACQRAIAAgASACIAMgBBAyDAELIAAgASACIAMgBBA0CyEAIAVBEGokACAACzQAIAAgAyAEIAUQNiIFEAMEQCAFDwsgBSAESQR/IAEgAiADIAVqIAQgBWsgABA1BUG4fwsLRgEBfyMAQRBrIgUkACAFQQhqIAQQDgJ/IAUtAAkEQCAAIAEgAiADIAQQYgwBCyAAIAEgAiADIAQQNQshACAFQRBqJAAgAAtZAQF/QQ8hAiABIABJBEAgAUEE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",zi=new WeakMap;let ji,$i=0;class Wi extends w{constructor(e){super(e),this.transcoderPath="",this.transcoderBinary=null,this.transcoderPending=null,this.workerPool=new ki,this.workerSourceURL="",this.workerConfig=null,"undefined"!=typeof MSC_TRANSCODER&&console.warn('THREE.KTX2Loader: Please update to latest "basis_transcoder". "msc_basis_transcoder" is no longer supported in three.js r125+.')}setTranscoderPath(e){return this.transcoderPath=e,this}setWorkerLimit(e){return this.workerPool.setWorkerLimit(e),this}detectSupport(e){return this.workerConfig={astcSupported:e.extensions.has("WEBGL_compressed_texture_astc"),etc1Supported:e.extensions.has("WEBGL_compressed_texture_etc1"),etc2Supported:e.extensions.has("WEBGL_compressed_texture_etc"),dxtSupported:e.extensions.has("WEBGL_compressed_texture_s3tc"),bptcSupported:e.extensions.has("EXT_texture_compression_bptc"),pvrtcSupported:e.extensions.has("WEBGL_compressed_texture_pvrtc")||e.extensions.has("WEBKIT_WEBGL_compressed_texture_pvrtc")},e.capabilities.isWebGL2&&(this.workerConfig.etc1Supported=!1),this}init(){if(!this.transcoderPending){const e=new y(this.manager);e.setPath(this.transcoderPath),e.setWithCredentials(this.withCredentials);const t=e.loadAsync("basis_transcoder.js"),s=new y(this.manager);s.setPath(this.transcoderPath),s.setResponseType("arraybuffer"),s.setWithCredentials(this.withCredentials);const i=s.loadAsync("basis_transcoder.wasm");this.transcoderPending=Promise.all([t,i]).then((([e,t])=>{const s=Wi.BasisWorker.toString(),i=["/* constants */","let _EngineFormat = "+JSON.stringify(Wi.EngineFormat),"let _TranscoderFormat = "+JSON.stringify(Wi.TranscoderFormat),"let _BasisFormat = "+JSON.stringify(Wi.BasisFormat),"/* basis_transcoder.js */",e,"/* worker */",s.substring(s.indexOf("{")+1,s.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([i])),this.transcoderBinary=t,this.workerPool.setWorkerCreator((()=>{const e=new Worker(this.workerSourceURL),t=this.transcoderBinary.slice(0);return e.postMessage({type:"init",config:this.workerConfig,transcoderBinary:t},[t]),e}))})),$i>0&&console.warn("THREE.KTX2Loader: Multiple active KTX2 loaders may cause performance issues. Use a single KTX2Loader instance, or call .dispose() on old instances."),$i++}return this.transcoderPending}load(e,t,s,i){if(null===this.workerConfig)throw new Error("THREE.KTX2Loader: Missing initialization with `.detectSupport( renderer )`.");const n=new y(this.manager);n.setResponseType("arraybuffer"),n.setWithCredentials(this.withCredentials),n.load(e,(e=>{if(zi.has(e)){return zi.get(e).promise.then(t).catch(i)}this._createTexture(e).then((e=>t?t(e):null)).catch(i)}),s,i)}_createTextureFrom(e,t){const{mipmaps:s,width:i,height:n,format:r,type:o,error:a,dfdTransferFn:A,dfdFlags:l}=e;if("error"===o)return Promise.reject(a);const h=t.layerCount>1?new x(s,i,n,t.layerCount,r,M):new D(s,i,n,r,M);return h.minFilter=1===s.length?R:T,h.magFilter=R,h.generateMipmaps=!1,h.needsUpdate=!0,h.encoding=2===A?L:F,h.premultiplyAlpha=!!(1&l),h}async _createTexture(e,t={}){const s=function(e){const t=new Uint8Array(e.buffer,e.byteOffset,Pi.length);if(t[0]!==Pi[0]||t[1]!==Pi[1]||t[2]!==Pi[2]||t[3]!==Pi[3]||t[4]!==Pi[4]||t[5]!==Pi[5]||t[6]!==Pi[6]||t[7]!==Pi[7]||t[8]!==Pi[8]||t[9]!==Pi[9]||t[10]!==Pi[10]||t[11]!==Pi[11])throw new Error("Missing KTX 2.0 identifier.");const s=new Ni,i=17*Uint32Array.BYTES_PER_ELEMENT,n=new Gi(e,Pi.length,i,!0);s.vkFormat=n._nextUint32(),s.typeSize=n._nextUint32(),s.pixelWidth=n._nextUint32(),s.pixelHeight=n._nextUint32(),s.pixelDepth=n._nextUint32(),s.layerCount=n._nextUint32(),s.faceCount=n._nextUint32();const r=n._nextUint32();s.supercompressionScheme=n._nextUint32();const o=n._nextUint32(),a=n._nextUint32(),A=n._nextUint32(),l=n._nextUint32(),h=n._nextUint64(),c=n._nextUint64(),u=new Gi(e,Pi.length+i,3*r*8,!0);for(let t=0;t<r;t++)s.levels.push({levelData:new Uint8Array(e.buffer,e.byteOffset+u._nextUint64(),u._nextUint64()),uncompressedByteLength:u._nextUint64()});const g=new Gi(e,o,a,!0),d={vendorId:g._skip(4)._nextUint16(),descriptorType:g._nextUint16(),versionNumber:g._nextUint16(),descriptorBlockSize:g._nextUint16(),colorModel:g._nextUint8(),colorPrimaries:g._nextUint8(),transferFunction:g._nextUint8(),flags:g._nextUint8(),texelBlockDimension:[g._nextUint8(),g._nextUint8(),g._nextUint8(),g._nextUint8()],bytesPlane:[g._nextUint8(),g._nextUint8(),g._nextUint8(),g._nextUint8(),g._nextUint8(),g._nextUint8(),g._nextUint8(),g._nextUint8()],samples:[]},p=(d.descriptorBlockSize/4-6)/4;for(let e=0;e<p;e++){const t={bitOffset:g._nextUint16(),bitLength:g._nextUint8(),channelType:g._nextUint8(),samplePosition:[g._nextUint8(),g._nextUint8(),g._nextUint8(),g._nextUint8()],sampleLower:-1/0,sampleUpper:1/0};64&t.channelType?(t.sampleLower=g._nextInt32(),t.sampleUpper=g._nextInt32()):(t.sampleLower=g._nextUint32(),t.sampleUpper=g._nextUint32()),d.samples[e]=t}s.dataFormatDescriptor.length=0,s.dataFormatDescriptor.push(d);const m=new Gi(e,A,l,!0);for(;m._offset<l;){const e=m._nextUint32(),t=m._scan(e),i=Oi(t),n=m._scan(e-t.byteLength);s.keyValue[i]=i.match(/^ktx/i)?Oi(n):n,m._offset%4&&m._skip(4-m._offset%4)}if(c<=0)return s;const I=new Gi(e,h,c,!0),f=I._nextUint16(),C=I._nextUint16(),E=I._nextUint32(),B=I._nextUint32(),w=I._nextUint32(),y=I._nextUint32(),Q=[];for(let e=0;e<r;e++)Q.push({imageFlags:I._nextUint32(),rgbSliceByteOffset:I._nextUint32(),rgbSliceByteLength:I._nextUint32(),alphaSliceByteOffset:I._nextUint32(),alphaSliceByteLength:I._nextUint32()});const v=h+I._offset,b=v+E,S=b+B,x=S+w,M=new Uint8Array(e.buffer,e.byteOffset+v,E),D=new Uint8Array(e.buffer,e.byteOffset+b,B),R=new Uint8Array(e.buffer,e.byteOffset+S,w),T=new Uint8Array(e.buffer,e.byteOffset+x,y);return s.globalData={endpointCount:f,selectorCount:C,imageDescs:Q,endpointsData:M,selectorsData:D,tablesData:R,extendedData:T},s}(new Uint8Array(e));if(0!==s.vkFormat)return async function(e){const{vkFormat:t,pixelWidth:s,pixelHeight:i,pixelDepth:n}=e;if(void 0===Xi[t])throw new Error("THREE.KTX2Loader: Unsupported vkFormat.");const r=e.levels[0];let o,a;if(e.supercompressionScheme===Ui)o=r.levelData;else{if(e.supercompressionScheme!==_i)throw new Error("THREE.KTX2Loader: Unsupported supercompressionScheme.");ji||(ji=new Promise((async e=>{const t=new Ki;await t.init(),e(t)}))),o=(await ji).decode(r.levelData,r.uncompressedByteLength)}a=Zi[t]===k?new Float32Array(o.buffer,o.byteOffset,o.byteLength/Float32Array.BYTES_PER_ELEMENT):Zi[t]===U?new Uint16Array(o.buffer,o.byteOffset,o.byteLength/Uint16Array.BYTES_PER_ELEMENT):o;const A=0===n?new _(a,s,i):new N(a,s,i,n);return A.type=Zi[t],A.format=Xi[t],A.encoding=en[t]||F,A.needsUpdate=!0,Promise.resolve(A)}
/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(s);const i=t,n=this.init().then((()=>this.workerPool.postMessage({type:"transcode",buffer:e,taskConfig:i},[e]))).then((e=>this._createTextureFrom(e.data,s)));return zi.set(e,{promise:n}),n}dispose(){return this.workerPool.dispose(),this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),$i--,this}}Wi.BasisFormat={ETC1S:0,UASTC_4x4:1},Wi.TranscoderFormat={ETC1:0,ETC2:1,BC1:2,BC3:3,BC4:4,BC5:5,BC7_M6_OPAQUE_ONLY:6,BC7_M5:7,PVRTC1_4_RGB:8,PVRTC1_4_RGBA:9,ASTC_4x4:10,ATC_RGB:11,ATC_RGBA_INTERPOLATED_ALPHA:12,RGBA32:13,RGB565:14,BGR565:15,RGBA4444:16},Wi.EngineFormat={RGBAFormat:s,RGBA_ASTC_4x4_Format:i,RGBA_BPTC_Format:n,RGBA_ETC2_EAC_Format:r,RGBA_PVRTC_4BPPV1_Format:o,RGBA_S3TC_DXT5_Format:a,RGB_ETC1_Format:A,RGB_ETC2_Format:l,RGB_PVRTC_4BPPV1_Format:h,RGB_S3TC_DXT1_Format:c},Wi.BasisWorker=function(){let e,t,s;const i=_EngineFormat,n=_TranscoderFormat,r=_BasisFormat;self.addEventListener("message",(function(o){const c=o.data;switch(c.type){case"init":e=c.config,u=c.transcoderBinary,t=new Promise((e=>{s={wasmBinary:u,onRuntimeInitialized:e},BASIS(s)})).then((()=>{s.initializeBasis(),void 0===s.KTX2File&&console.warn("THREE.KTX2Loader: Please update Basis Universal transcoder.")}));break;case"transcode":t.then((()=>{try{const{width:t,height:o,hasAlpha:u,mipmaps:g,format:d,dfdTransferFn:p,dfdFlags:m}=function(t){const o=new s.KTX2File(new Uint8Array(t));function c(){o.close(),o.delete()}if(!o.isValid())throw c(),new Error("THREE.KTX2Loader:\tInvalid or unsupported .ktx2 file");const u=o.isUASTC()?r.UASTC_4x4:r.ETC1S,g=o.getWidth(),d=o.getHeight(),p=o.getLayers()||1,m=o.getLevels(),I=o.getHasAlpha(),f=o.getDFDTransferFunc(),C=o.getDFDFlags(),{transcoderFormat:E,engineFormat:B}=function(t,s,o,h){let c,u;const g=t===r.ETC1S?a:A;for(let i=0;i<g.length;i++){const n=g[i];if(e[n.if]&&(n.basisFormat.includes(t)&&!(h&&n.transcoderFormat.length<2)&&(!n.needsPowerOfTwo||l(s)&&l(o))))return c=n.transcoderFormat[h?1:0],u=n.engineFormat[h?1:0],{transcoderFormat:c,engineFormat:u}}return console.warn("THREE.KTX2Loader: No suitable compressed texture format found. Decoding to RGBA32."),c=n.RGBA32,u=i.RGBAFormat,{transcoderFormat:c,engineFormat:u}}(u,g,d,I);if(!g||!d||!m)throw c(),new Error("THREE.KTX2Loader:\tInvalid texture");if(!o.startTranscoding())throw c(),new Error("THREE.KTX2Loader: .startTranscoding failed");const w=[];for(let e=0;e<m;e++){const t=[];let s,i;for(let n=0;n<p;n++){const r=o.getImageLevelInfo(e,n,0);s=r.origWidth<4?r.origWidth:r.width,i=r.origHeight<4?r.origHeight:r.height;const a=new Uint8Array(o.getImageTranscodedSizeInBytes(e,n,0,E));if(!o.transcodeImage(a,e,n,0,E,0,-1,-1))throw c(),new Error("THREE.KTX2Loader: .transcodeImage failed.");t.push(a)}w.push({data:h(t),width:s,height:i})}return c(),{width:g,height:d,hasAlpha:I,mipmaps:w,format:B,dfdTransferFn:f,dfdFlags:C}}(c.buffer),I=[];for(let e=0;e<g.length;++e)I.push(g[e].data.buffer);self.postMessage({type:"transcode",id:c.id,width:t,height:o,hasAlpha:u,mipmaps:g,format:d,dfdTransferFn:p,dfdFlags:m},I)}catch(e){console.error(e),self.postMessage({type:"error",id:c.id,error:e.message})}}))}var u}));const o=[{if:"astcSupported",basisFormat:[r.UASTC_4x4],transcoderFormat:[n.ASTC_4x4,n.ASTC_4x4],engineFormat:[i.RGBA_ASTC_4x4_Format,i.RGBA_ASTC_4x4_Format],priorityETC1S:1/0,priorityUASTC:1,needsPowerOfTwo:!1},{if:"bptcSupported",basisFormat:[r.ETC1S,r.UASTC_4x4],transcoderFormat:[n.BC7_M5,n.BC7_M5],engineFormat:[i.RGBA_BPTC_Format,i.RGBA_BPTC_Format],priorityETC1S:3,priorityUASTC:2,needsPowerOfTwo:!1},{if:"dxtSupported",basisFormat:[r.ETC1S,r.UASTC_4x4],transcoderFormat:[n.BC1,n.BC3],engineFormat:[i.RGB_S3TC_DXT1_Format,i.RGBA_S3TC_DXT5_Format],priorityETC1S:4,priorityUASTC:5,needsPowerOfTwo:!1},{if:"etc2Supported",basisFormat:[r.ETC1S,r.UASTC_4x4],transcoderFormat:[n.ETC1,n.ETC2],engineFormat:[i.RGB_ETC2_Format,i.RGBA_ETC2_EAC_Format],priorityETC1S:1,priorityUASTC:3,needsPowerOfTwo:!1},{if:"etc1Supported",basisFormat:[r.ETC1S,r.UASTC_4x4],transcoderFormat:[n.ETC1],engineFormat:[i.RGB_ETC1_Format],priorityETC1S:2,priorityUASTC:4,needsPowerOfTwo:!1},{if:"pvrtcSupported",basisFormat:[r.ETC1S,r.UASTC_4x4],transcoderFormat:[n.PVRTC1_4_RGB,n.PVRTC1_4_RGBA],engineFormat:[i.RGB_PVRTC_4BPPV1_Format,i.RGBA_PVRTC_4BPPV1_Format],priorityETC1S:5,priorityUASTC:6,needsPowerOfTwo:!0}],a=o.sort((function(e,t){return e.priorityETC1S-t.priorityETC1S})),A=o.sort((function(e,t){return e.priorityUASTC-t.priorityUASTC}));function l(e){return e<=2||0==(e&e-1)&&0!==e}function h(e){let t=0;for(const s of e)t+=s.byteLength;const s=new Uint8Array(t);let i=0;for(const t of e)s.set(t,i),i+=t.byteLength;return s}};const Xi={109:s,97:s,37:s,43:s,103:Ce,83:Ce,16:Ce,22:Ce,100:Ee,76:Ee,15:Ee,9:Ee},Zi={109:k,97:U,37:M,43:M,103:k,83:U,16:M,22:M,100:k,76:U,15:M,9:M},en={43:L,22:L,15:L};var tn,sn;const nn=Symbol("retainerCount"),rn=Symbol("recentlyUsed"),on=Symbol("evict"),an=Symbol("evictionThreshold"),An=Symbol("cache");class ln{constructor(e,t=5){this[tn]=new Map,this[sn]=[],this[An]=e,this[an]=t}set evictionThreshold(e){this[an]=e,this[on]()}get evictionThreshold(){return this[an]}get cache(){return this[An]}retainerCount(e){return this[nn].get(e)||0}reset(){this[nn].clear(),this[rn]=[]}retain(e){this[nn].has(e)||this[nn].set(e,0),this[nn].set(e,this[nn].get(e)+1);const t=this[rn].indexOf(e);-1!==t&&this[rn].splice(t,1),this[rn].unshift(e),this[on]()}release(e){this[nn].has(e)&&this[nn].set(e,Math.max(this[nn].get(e)-1,0)),this[on]()}[(tn=nn,sn=rn,on)](){if(!(this[rn].length<this[an]))for(let e=this[rn].length-1;e>=this[an];--e){const t=this[rn][e];0===this[nn].get(t)&&(this[An].delete(t),this[rn].splice(e,1))}}}
/* @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hn=e=>{const t=new Map;for(const s of e.mappings)for(const e of s.variants)t.set(e,{material:null,gltfMaterialIndex:s.material});return t};class cn{constructor(e){this.parser=e,this.name="KHR_materials_variants"}afterRoot(e){const t=this.parser,s=t.json;if(void 0===s.extensions||void 0===s.extensions[this.name])return null;const i=(e=>{const t=[],s=new Set;for(const i of e){let e=i,n=0;for(;s.has(e);)e=i+"."+ ++n;s.add(e),t.push(e)}return t})((s.extensions[this.name].variants||[]).map((e=>e.name)));for(const i of e.scenes)i.traverse((e=>{const i=e;if(!i.isMesh)return;const n=t.associations.get(i);if(null==n||null==n.meshes||null==n.primitives)return;const r=s.meshes[n.meshes].primitives[n.primitives].extensions;r&&r[this.name]&&(i.userData.variantMaterials=hn(r[this.name]))}));return e.userData.variants=i,Promise.resolve()}}
/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var un,gn;u.DEFAULT_ANISOTROPY=4;const dn=new Map,pn=new Map;let mn;const In=new class extends w{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,s,i){const n=new y(this.manager);n.setPath(this.path),n.setResponseType("arraybuffer"),n.setRequestHeader(this.requestHeader),n.setWithCredentials(this.withCredentials),n.load(e,(e=>{this.parse(e,t,i)}),s,i)}parse(e,t,s){this.decodeDracoFile(e,t,null,null,Q).catch(s)}decodeDracoFile(e,t,s,i,n=v){const r={attributeIDs:s||this.defaultAttributeIDs,attributeTypes:i||this.defaultAttributeTypes,useUniqueIDs:!!s,vertexColorSpace:n};return this.decodeGeometry(e,r).then(t)}decodeGeometry(e,t){const s=JSON.stringify(t);if(_s.has(e)){const t=_s.get(e);if(t.key===s)return t.promise;if(0===e.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let i;const n=this.workerNextTaskID++,r=e.byteLength,o=this._getWorker(n,r).then((s=>(i=s,new Promise(((s,r)=>{i._callbacks[n]={resolve:s,reject:r},i.postMessage({type:"decode",id:n,taskConfig:t,buffer:e},[e])}))))).then((e=>this._createGeometry(e.geometry)));return o.catch((()=>!0)).then((()=>{i&&n&&this._releaseTask(i,n)})),_s.set(e,{key:s,promise:o}),o}_createGeometry(e){const t=new b;e.index&&t.setIndex(new S(e.index.array,1));for(let s=0;s<e.attributes.length;s++){const i=e.attributes[s],n=i.name,r=i.array,o=i.itemSize,a=new S(r,o);"color"===n&&this._assignVertexColorSpace(a,i.vertexColorSpace),t.setAttribute(n,a)}return t}_assignVertexColorSpace(e,t){if(t!==Q)return;const s=new d;for(let t=0,i=e.count;t<i;t++)s.fromBufferAttribute(e,t).convertSRGBToLinear(),e.setXYZ(t,s.r,s.g,s.b)}_loadLibrary(e,t){const s=new y(this.manager);return s.setPath(this.decoderPath),s.setResponseType(t),s.setWithCredentials(this.withCredentials),new Promise(((t,i)=>{s.load(e,t,void 0,i)}))}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e="object"!=typeof WebAssembly||"js"===this.decoderConfig.type,t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then((t=>{const s=t[0];e||(this.decoderConfig.wasmBinary=t[1]);const i=Ns.toString(),n=["/* draco decoder */",s,"","/* worker */",i.substring(i.indexOf("{")+1,i.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([n]))})),this.decoderPending}_getWorker(e,t){return this._initDecoder().then((()=>{if(this.workerPool.length<this.workerLimit){const e=new Worker(this.workerSourceURL);e._callbacks={},e._taskCosts={},e._taskLoad=0,e.postMessage({type:"init",decoderConfig:this.decoderConfig}),e.onmessage=function(t){const s=t.data;switch(s.type){case"decode":e._callbacks[s.id].resolve(s);break;case"error":e._callbacks[s.id].reject(s);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+s.type+'"')}},this.workerPool.push(e)}else this.workerPool.sort((function(e,t){return e._taskLoad>t._taskLoad?-1:1}));const s=this.workerPool[this.workerPool.length-1];return s._taskCosts[e]=t,s._taskLoad+=t,s}))}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map((e=>e._taskLoad)))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,""!==this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),this}};let fn;const Cn=new Wi;let En,Bn;const wn=Symbol("loader"),yn=Symbol("evictionPolicy"),Qn=Symbol("GLTFInstance");class vn extends G{constructor(e){super(),this[gn]=(new Ps).register((e=>new cn(e))),this[Qn]=e,this[wn].setDRACOLoader(In),this[wn].setKTX2Loader(Cn)}static setDRACODecoderLocation(e){mn=e,In.setDecoderPath(e)}static getDRACODecoderLocation(){return mn}static setKTX2TranscoderLocation(e){fn=e,Cn.setTranscoderPath(e)}static getKTX2TranscoderLocation(){return fn}static setMeshoptDecoderLocation(e){var t;En!==e&&(En=e,Bn=(t=e,new Promise(((e,s)=>{const i=document.createElement("script");document.body.appendChild(i),i.onload=e,i.onerror=s,i.async=!0,i.src=t}))).then((()=>MeshoptDecoder.ready)).then((()=>MeshoptDecoder)))}static getMeshoptDecoderLocation(){return En}static initializeKTX2Loader(e){Cn.detectSupport(e)}static get cache(){return dn}static clearCache(){dn.forEach(((e,t)=>{this.delete(t)})),this[yn].reset()}static has(e){return dn.has(e)}static async delete(e){if(!this.has(e))return;const t=dn.get(e);pn.delete(e),dn.delete(e);(await t).dispose()}static hasFinishedLoading(e){return!!pn.get(e)}get[(un=yn,gn=wn,yn)](){return this.constructor[yn]}async preload(e,t,s=(()=>{})){if(this[wn].setWithCredentials(vn.withCredentials),this.dispatchEvent({type:"preload",element:t,src:e}),!dn.has(e)){null!=Bn&&this[wn].setMeshoptDecoder(await Bn);const t=((e,t,s=(()=>{}))=>{const i=e=>{const t=e.loaded/e.total;s(Math.max(0,Math.min(1,isFinite(t)?t:1)))};return new Promise(((s,n)=>{t.load(e,s,i,n)}))})(e,this[wn],(e=>{s(.8*e)})),i=this[Qn],n=t.then((e=>i.prepare(e))).then((e=>(s(.9),new i(e)))).catch((e=>(console.error(e),new i)));dn.set(e,n)}await dn.get(e),pn.set(e,!0),s&&s(1)}async load(e,t,s=(()=>{})){await this.preload(e,t,s);const i=await dn.get(e),n=await i.clone();return this[yn].retain(e),n.dispose=()=>{this[yn].release(e)},n}}vn[un]=new ln(vn);class bn extends z{constructor(e=document.createElement("div")){super(),this.isCSS2DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",(function(){this.traverse((function(e){e.element instanceof Element&&null!==e.element.parentNode&&e.element.parentNode.removeChild(e.element)}))}))}copy(e,t){return super.copy(e,t),this.element=e.element.cloneNode(!0),this}}const Sn=new g,xn=new t,Mn=new t,Dn=new g,Rn=new g;class Tn{constructor(e={}){const t=this;let s,i,n,r;const o={objects:new WeakMap},a=void 0!==e.element?e.element:document.createElement("div");function A(e,s,i){if(e.isCSS2DObject){Sn.setFromMatrixPosition(e.matrixWorld),Sn.applyMatrix4(Mn);const A=!0===e.visible&&Sn.z>=-1&&Sn.z<=1&&!0===e.layers.test(i.layers);if(e.element.style.display=!0===A?"":"none",!0===A){e.onBeforeRender(t,s,i);const o=e.element;o.style.transform="translate(-50%,-50%) translate("+(Sn.x*n+n)+"px,"+(-Sn.y*r+r)+"px)",o.parentNode!==a&&a.appendChild(o),e.onAfterRender(t,s,i)}const h={distanceToCameraSquared:l(i,e)};o.objects.set(e,h)}for(let t=0,n=e.children.length;t<n;t++)A(e.children[t],s,i)}function l(e,t){return Dn.setFromMatrixPosition(e.matrixWorld),Rn.setFromMatrixPosition(t.matrixWorld),Dn.distanceToSquared(Rn)}a.style.overflow="hidden",this.domElement=a,this.getSize=function(){return{width:s,height:i}},this.render=function(e,t){!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),xn.copy(t.matrixWorldInverse),Mn.multiplyMatrices(t.projectionMatrix,xn),A(e,e,t),function(e){const t=function(e){const t=[];return e.traverse((function(e){e.isCSS2DObject&&t.push(e)})),t}(e).sort((function(e,t){if(e.renderOrder!==t.renderOrder)return t.renderOrder-e.renderOrder;return o.objects.get(e).distanceToCameraSquared-o.objects.get(t).distanceToCameraSquared})),s=t.length;for(let e=0,i=t.length;e<i;e++)t[e].element.style.zIndex=s-e}(e)},this.setSize=function(e,t){s=e,i=t,n=s/2,r=i/2,a.style.width=e+"px",a.style.height=t+"px"}}}function Ln(e,t,s){let i=s;const n=new g;return e.updateWorldMatrix(!0,!0),e.traverseVisible((e=>{const{geometry:s}=e;if(void 0!==s){const{position:r}=s.attributes;if(void 0!==r)for(let s=0,o=r.count;s<o;s++)e.isMesh?e.getVertexPosition(s,n):n.fromBufferAttribute(r,s),e.isSkinnedMesh||n.applyMatrix4(e.matrixWorld),i=t(i,n)}})),i}const Fn={POSITION:["byte","byte normalized","unsigned byte","unsigned byte normalized","short","short normalized","unsigned short","unsigned short normalized"],NORMAL:["byte normalized","short normalized"],TANGENT:["byte normalized","short normalized"],TEXCOORD:["byte","byte normalized","unsigned byte","short","short normalized","unsigned short"]};class kn{constructor(){this.pluginCallbacks=[],this.register((function(e){return new pr(e)})),this.register((function(e){return new mr(e)})),this.register((function(e){return new Cr(e)})),this.register((function(e){return new Er(e)})),this.register((function(e){return new Br(e)})),this.register((function(e){return new wr(e)})),this.register((function(e){return new Ir(e)})),this.register((function(e){return new fr(e)})),this.register((function(e){return new yr(e)})),this.register((function(e){return new Qr(e)}))}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,s,i){const n=new dr,r=[];for(let e=0,t=this.pluginCallbacks.length;e<t;e++)r.push(this.pluginCallbacks[e](n));n.setPlugins(r),n.write(e,t,i).catch(s)}parseAsync(e,t){const s=this;return new Promise((function(i,n){s.parse(e,i,n,t)}))}}const Un=0,_n=1,Nn=2,Gn=3,Pn=4,On=5120,Hn=5121,qn=5122,Vn=5123,Jn=5124,Kn=5125,Yn=5126,zn=34962,jn=34963,$n=9728,Wn=9729,Xn=9984,Zn=9985,er=9986,tr=9987,sr=33071,ir=33648,nr=10497,rr="KHR_mesh_quantization",or={};or[Je]=$n,or[Ke]=Xn,or[ze]=er,or[R]=Wn,or[Ye]=Zn,or[T]=tr,or[je]=sr,or[Z]=nr,or[$e]=ir;const ar={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"},Ar=new d;function lr(e,t){return e.length===t.length&&e.every((function(e,s){return e===t[s]}))}function hr(e){return 4*Math.ceil(e/4)}function cr(e,t=0){const s=hr(e.byteLength);if(s!==e.byteLength){const i=new Uint8Array(s);if(i.set(new Uint8Array(e)),0!==t)for(let n=e.byteLength;n<s;n++)i[n]=t;return i.buffer}return e}function ur(){return"undefined"==typeof document&&"undefined"!=typeof OffscreenCanvas?new OffscreenCanvas(1,1):document.createElement("canvas")}function gr(e,t){if(void 0!==e.toBlob)return new Promise((s=>e.toBlob(s,t)));let s;return"image/jpeg"===t?s=.92:"image/webp"===t&&(s=.8),e.convertToBlob({type:t,quality:s})}class dr{constructor(){this.plugins=[],this.options={},this.pending=[],this.buffers=[],this.byteOffset=0,this.buffers=[],this.nodeMap=new Map,this.skins=[],this.extensionsUsed={},this.extensionsRequired={},this.uids=new Map,this.uid=0,this.json={asset:{version:"2.0",generator:"THREE.GLTFExporter"}},this.cache={meshes:new Map,attributes:new Map,attributesNormalized:new Map,materials:new Map,textures:new Map,images:new Map}}setPlugins(e){this.plugins=e}async write(e,t,s={}){this.options=Object.assign({binary:!1,trs:!1,onlyVisible:!0,maxTextureSize:1/0,animations:[],includeCustomExtensions:!1},s),this.options.animations.length>0&&(this.options.trs=!0),this.processInput(e),await Promise.all(this.pending);const i=this,n=i.buffers,r=i.json;s=i.options;const o=i.extensionsUsed,a=i.extensionsRequired,A=new Blob(n,{type:"application/octet-stream"}),l=Object.keys(o),h=Object.keys(a);if(l.length>0&&(r.extensionsUsed=l),h.length>0&&(r.extensionsRequired=h),r.buffers&&r.buffers.length>0&&(r.buffers[0].byteLength=A.size),!0===s.binary){const e=new FileReader;e.readAsArrayBuffer(A),e.onloadend=function(){const s=cr(e.result),i=new DataView(new ArrayBuffer(8));i.setUint32(0,s.byteLength,!0),i.setUint32(4,5130562,!0);const n=cr((o=JSON.stringify(r),(new TextEncoder).encode(o).buffer),32);var o;const a=new DataView(new ArrayBuffer(8));a.setUint32(0,n.byteLength,!0),a.setUint32(4,1313821514,!0);const A=new ArrayBuffer(12),l=new DataView(A);l.setUint32(0,1179937895,!0),l.setUint32(4,2,!0);const h=12+a.byteLength+n.byteLength+i.byteLength+s.byteLength;l.setUint32(8,h,!0);const c=new Blob([A,a,n,i,s],{type:"application/octet-stream"}),u=new FileReader;u.readAsArrayBuffer(c),u.onloadend=function(){t(u.result)}}}else if(r.buffers&&r.buffers.length>0){const e=new FileReader;e.readAsDataURL(A),e.onloadend=function(){const s=e.result;r.buffers[0].uri=s,t(r)}}else t(r)}serializeUserData(e,t){if(0===Object.keys(e.userData).length)return;const s=this.options,i=this.extensionsUsed;try{const n=JSON.parse(JSON.stringify(e.userData));if(s.includeCustomExtensions&&n.gltfExtensions){void 0===t.extensions&&(t.extensions={});for(const e in n.gltfExtensions)t.extensions[e]=n.gltfExtensions[e],i[e]=!0;delete n.gltfExtensions}Object.keys(n).length>0&&(t.extras=n)}catch(t){console.warn("THREE.GLTFExporter: userData of '"+e.name+"' won't be serialized because of JSON.stringify error - "+t.message)}}getUID(e,t=!1){if(!1===this.uids.has(e)){const t=new Map;t.set(!0,this.uid++),t.set(!1,this.uid++),this.uids.set(e,t)}return this.uids.get(e).get(t)}isNormalizedNormalAttribute(e){if(this.cache.attributesNormalized.has(e))return!1;const t=new g;for(let s=0,i=e.count;s<i;s++)if(Math.abs(t.fromBufferAttribute(e,s).length()-1)>5e-4)return!1;return!0}createNormalizedNormalAttribute(e){const t=this.cache;if(t.attributesNormalized.has(e))return t.attributesNormalized.get(e);const s=e.clone(),i=new g;for(let e=0,t=s.count;e<t;e++)i.fromBufferAttribute(s,e),0===i.x&&0===i.y&&0===i.z?i.setX(1):i.normalize(),s.setXYZ(e,i.x,i.y,i.z);return t.attributesNormalized.set(e,s),s}applyTextureTransform(e,t){let s=!1;const i={};0===t.offset.x&&0===t.offset.y||(i.offset=t.offset.toArray(),s=!0),0!==t.rotation&&(i.rotation=t.rotation,s=!0),1===t.repeat.x&&1===t.repeat.y||(i.scale=t.repeat.toArray(),s=!0),s&&(e.extensions=e.extensions||{},e.extensions.KHR_texture_transform=i,this.extensionsUsed.KHR_texture_transform=!0)}buildMetalRoughTexture(e,t){if(e===t)return e;function s(e){return e.encoding===L?function(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}:function(e){return e}}console.warn("THREE.GLTFExporter: Merged metalnessMap and roughnessMap textures.");const i=e?e.image:null,n=t?t.image:null,r=Math.max(i?i.width:0,n?n.width:0),o=Math.max(i?i.height:0,n?n.height:0),a=ur();a.width=r,a.height=o;const A=a.getContext("2d");A.fillStyle="#00ffff",A.fillRect(0,0,r,o);const l=A.getImageData(0,0,r,o);if(i){A.drawImage(i,0,0,r,o);const t=s(e),n=A.getImageData(0,0,r,o).data;for(let e=2;e<n.length;e+=4)l.data[e]=256*t(n[e]/256)}if(n){A.drawImage(n,0,0,r,o);const e=s(t),i=A.getImageData(0,0,r,o).data;for(let t=1;t<i.length;t+=4)l.data[t]=256*e(i[t]/256)}A.putImageData(l,0,0);const h=(e||t).clone();return h.source=new ot(a),h.encoding=F,h}processBuffer(e){const t=this.json,s=this.buffers;return t.buffers||(t.buffers=[{byteLength:0}]),s.push(e),0}processBufferView(e,t,s,i,n){const r=this.json;let o;switch(r.bufferViews||(r.bufferViews=[]),t){case On:case Hn:o=1;break;case qn:case Vn:o=2;break;default:o=4}const a=hr(i*e.itemSize*o),A=new DataView(new ArrayBuffer(a));let l=0;for(let n=s;n<s+i;n++)for(let s=0;s<e.itemSize;s++){let i;e.itemSize>4?i=e.array[n*e.itemSize+s]:(0===s?i=e.getX(n):1===s?i=e.getY(n):2===s?i=e.getZ(n):3===s&&(i=e.getW(n)),!0===e.normalized&&(i=ge.normalize(i,e.array))),t===Yn?A.setFloat32(l,i,!0):t===Jn?A.setInt32(l,i,!0):t===Kn?A.setUint32(l,i,!0):t===qn?A.setInt16(l,i,!0):t===Vn?A.setUint16(l,i,!0):t===On?A.setInt8(l,i):t===Hn&&A.setUint8(l,i),l+=o}const h={buffer:this.processBuffer(A.buffer),byteOffset:this.byteOffset,byteLength:a};void 0!==n&&(h.target=n),n===zn&&(h.byteStride=e.itemSize*o),this.byteOffset+=a,r.bufferViews.push(h);return{id:r.bufferViews.length-1,byteLength:0}}processBufferViewImage(e){const t=this,s=t.json;return s.bufferViews||(s.bufferViews=[]),new Promise((function(i){const n=new FileReader;n.readAsArrayBuffer(e),n.onloadend=function(){const e=cr(n.result),r={buffer:t.processBuffer(e),byteOffset:t.byteOffset,byteLength:e.byteLength};t.byteOffset+=e.byteLength,i(s.bufferViews.push(r)-1)}}))}processAccessor(e,t,s,i){const n=this.json;let r;if(e.array.constructor===Float32Array)r=Yn;else if(e.array.constructor===Int32Array)r=Jn;else if(e.array.constructor===Uint32Array)r=Kn;else if(e.array.constructor===Int16Array)r=qn;else if(e.array.constructor===Uint16Array)r=Vn;else if(e.array.constructor===Int8Array)r=On;else{if(e.array.constructor!==Uint8Array)throw new Error("THREE.GLTFExporter: Unsupported bufferAttribute component type.");r=Hn}if(void 0===s&&(s=0),void 0===i&&(i=e.count),0===i)return null;const o=function(e,t,s){const i={min:new Array(e.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(e.itemSize).fill(Number.NEGATIVE_INFINITY)};for(let n=t;n<t+s;n++)for(let t=0;t<e.itemSize;t++){let s;e.itemSize>4?s=e.array[n*e.itemSize+t]:(0===t?s=e.getX(n):1===t?s=e.getY(n):2===t?s=e.getZ(n):3===t&&(s=e.getW(n)),!0===e.normalized&&(s=ge.normalize(s,e.array))),i.min[t]=Math.min(i.min[t],s),i.max[t]=Math.max(i.max[t],s)}return i}(e,s,i);let a;void 0!==t&&(a=e===t.index?jn:zn);const A=this.processBufferView(e,r,s,i,a),l={bufferView:A.id,byteOffset:A.byteOffset,componentType:r,count:i,max:o.max,min:o.min,type:{1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",9:"MAT3",16:"MAT4"}[e.itemSize]};return!0===e.normalized&&(l.normalized=!0),n.accessors||(n.accessors=[]),n.accessors.push(l)-1}processImage(e,t,i,n="image/png"){if(null!==e){const r=this,o=r.cache,a=r.json,A=r.options,l=r.pending;o.images.has(e)||o.images.set(e,{});const h=o.images.get(e),c=n+":flipY/"+i.toString();if(void 0!==h[c])return h[c];a.images||(a.images=[]);const u={mimeType:n},g=ur();g.width=Math.min(e.width,A.maxTextureSize),g.height=Math.min(e.height,A.maxTextureSize);const d=g.getContext("2d");if(!0===i&&(d.translate(0,g.height),d.scale(1,-1)),void 0!==e.data){t!==s&&console.error("GLTFExporter: Only RGBAFormat is supported."),(e.width>A.maxTextureSize||e.height>A.maxTextureSize)&&console.warn("GLTFExporter: Image size is bigger than maxTextureSize",e);const i=new Uint8ClampedArray(e.height*e.width*4);for(let t=0;t<i.length;t+=4)i[t+0]=e.data[t+0],i[t+1]=e.data[t+1],i[t+2]=e.data[t+2],i[t+3]=e.data[t+3];d.putImageData(new ImageData(i,e.width,e.height),0,0)}else d.drawImage(e,0,0,g.width,g.height);!0===A.binary?l.push(gr(g,n).then((e=>r.processBufferViewImage(e))).then((e=>{u.bufferView=e}))):void 0!==g.toDataURL?u.uri=g.toDataURL(n):l.push(gr(g,n).then((e=>(new FileReader).readAsDataURL(e))).then((e=>{u.uri=e})));const p=a.images.push(u)-1;return h[c]=p,p}throw new Error("THREE.GLTFExporter: No valid image data found. Unable to process texture.")}processSampler(e){const t=this.json;t.samplers||(t.samplers=[]);const s={magFilter:or[e.magFilter],minFilter:or[e.minFilter],wrapS:or[e.wrapS],wrapT:or[e.wrapT]};return t.samplers.push(s)-1}processTexture(e){const t=this.cache,s=this.json;if(t.textures.has(e))return t.textures.get(e);s.textures||(s.textures=[]);let i=e.userData.mimeType;"image/webp"===i&&(i="image/png");const n={sampler:this.processSampler(e),source:this.processImage(e.image,e.format,e.flipY,i)};e.name&&(n.name=e.name),this._invokeAll((function(t){t.writeTexture&&t.writeTexture(e,n)}));const r=s.textures.push(n)-1;return t.textures.set(e,r),r}processMaterial(e){const t=this.cache,s=this.json;if(t.materials.has(e))return t.materials.get(e);if(e.isShaderMaterial)return console.warn("GLTFExporter: THREE.ShaderMaterial not supported."),null;s.materials||(s.materials=[]);const i={pbrMetallicRoughness:{}};!0!==e.isMeshStandardMaterial&&!0!==e.isMeshBasicMaterial&&console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");const n=e.color.toArray().concat([e.opacity]);if(lr(n,[1,1,1,1])||(i.pbrMetallicRoughness.baseColorFactor=n),e.isMeshStandardMaterial?(i.pbrMetallicRoughness.metallicFactor=e.metalness,i.pbrMetallicRoughness.roughnessFactor=e.roughness):(i.pbrMetallicRoughness.metallicFactor=.5,i.pbrMetallicRoughness.roughnessFactor=.5),e.metalnessMap||e.roughnessMap){const t=this.buildMetalRoughTexture(e.metalnessMap,e.roughnessMap),s={index:this.processTexture(t)};this.applyTextureTransform(s,t),i.pbrMetallicRoughness.metallicRoughnessTexture=s}if(e.map){const t={index:this.processTexture(e.map)};this.applyTextureTransform(t,e.map),i.pbrMetallicRoughness.baseColorTexture=t}if(e.emissive){const t=e.emissive;if(Math.max(t.r,t.g,t.b)>0&&(i.emissiveFactor=e.emissive.toArray()),e.emissiveMap){const t={index:this.processTexture(e.emissiveMap)};this.applyTextureTransform(t,e.emissiveMap),i.emissiveTexture=t}}if(e.normalMap){const t={index:this.processTexture(e.normalMap)};e.normalScale&&1!==e.normalScale.x&&(t.scale=e.normalScale.x),this.applyTextureTransform(t,e.normalMap),i.normalTexture=t}if(e.aoMap){const t={index:this.processTexture(e.aoMap),texCoord:1};1!==e.aoMapIntensity&&(t.strength=e.aoMapIntensity),this.applyTextureTransform(t,e.aoMap),i.occlusionTexture=t}e.transparent?i.alphaMode="BLEND":e.alphaTest>0&&(i.alphaMode="MASK",i.alphaCutoff=e.alphaTest),e.side===ne&&(i.doubleSided=!0),""!==e.name&&(i.name=e.name),this.serializeUserData(e,i),this._invokeAll((function(t){t.writeMaterial&&t.writeMaterial(e,i)}));const r=s.materials.push(i)-1;return t.materials.set(e,r),r}processMesh(e){const t=this.cache,s=this.json,i=[e.geometry.uuid];if(Array.isArray(e.material))for(let t=0,s=e.material.length;t<s;t++)i.push(e.material[t].uuid);else i.push(e.material.uuid);const n=i.join(":");if(t.meshes.has(n))return t.meshes.get(n);const r=e.geometry;let o;o=e.isLineSegments?_n:e.isLineLoop?Nn:e.isLine?Gn:e.isPoints?Un:e.material.wireframe?_n:Pn;const a={},A={},l=[],h=[],c={uv:"TEXCOORD_0",uv2:"TEXCOORD_1",color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},u=r.getAttribute("normal");void 0===u||this.isNormalizedNormalAttribute(u)||(console.warn("THREE.GLTFExporter: Creating normalized normal attribute from the non-normalized one."),r.setAttribute("normal",this.createNormalizedNormalAttribute(u)));let g=null;for(let e in r.attributes){if("morph"===e.slice(0,5))continue;const s=r.attributes[e];e=c[e]||e.toUpperCase();if(/^(POSITION|NORMAL|TANGENT|TEXCOORD_\d+|COLOR_\d+|JOINTS_\d+|WEIGHTS_\d+)$/.test(e)||(e="_"+e),t.attributes.has(this.getUID(s))){A[e]=t.attributes.get(this.getUID(s));continue}g=null;const i=s.array;"JOINTS_0"!==e||i instanceof Uint16Array||i instanceof Uint8Array||(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),g=new S(new Uint16Array(i),s.itemSize,s.normalized));const n=this.processAccessor(g||s,r);null!==n&&(e.startsWith("_")||this.detectMeshQuantization(e,s),A[e]=n,t.attributes.set(this.getUID(s),n))}if(void 0!==u&&r.setAttribute("normal",u),0===Object.keys(A).length)return null;if(void 0!==e.morphTargetInfluences&&e.morphTargetInfluences.length>0){const s=[],i=[],n={};if(void 0!==e.morphTargetDictionary)for(const t in e.morphTargetDictionary)n[e.morphTargetDictionary[t]]=t;for(let o=0;o<e.morphTargetInfluences.length;++o){const a={};let A=!1;for(const e in r.morphAttributes){if("position"!==e&&"normal"!==e){A||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),A=!0);continue}const s=r.morphAttributes[e][o],i=e.toUpperCase(),n=r.attributes[e];if(t.attributes.has(this.getUID(s,!0))){a[i]=t.attributes.get(this.getUID(s,!0));continue}const l=s.clone();if(!r.morphTargetsRelative)for(let e=0,t=s.count;e<t;e++)for(let t=0;t<s.itemSize;t++)0===t&&l.setX(e,s.getX(e)-n.getX(e)),1===t&&l.setY(e,s.getY(e)-n.getY(e)),2===t&&l.setZ(e,s.getZ(e)-n.getZ(e)),3===t&&l.setW(e,s.getW(e)-n.getW(e));a[i]=this.processAccessor(l,r),t.attributes.set(this.getUID(n,!0),a[i])}h.push(a),s.push(e.morphTargetInfluences[o]),void 0!==e.morphTargetDictionary&&i.push(n[o])}a.weights=s,i.length>0&&(a.extras={},a.extras.targetNames=i)}const d=Array.isArray(e.material);if(d&&0===r.groups.length)return null;const p=d?e.material:[e.material],m=d?r.groups:[{materialIndex:0,start:void 0,count:void 0}];for(let e=0,s=m.length;e<s;e++){const s={mode:o,attributes:A};if(this.serializeUserData(r,s),h.length>0&&(s.targets=h),null!==r.index){let i=this.getUID(r.index);void 0===m[e].start&&void 0===m[e].count||(i+=":"+m[e].start+":"+m[e].count),t.attributes.has(i)?s.indices=t.attributes.get(i):(s.indices=this.processAccessor(r.index,r,m[e].start,m[e].count),t.attributes.set(i,s.indices)),null===s.indices&&delete s.indices}const i=this.processMaterial(p[m[e].materialIndex]);null!==i&&(s.material=i),l.push(s)}a.primitives=l,s.meshes||(s.meshes=[]),this._invokeAll((function(t){t.writeMesh&&t.writeMesh(e,a)}));const I=s.meshes.push(a)-1;return t.meshes.set(n,I),I}detectMeshQuantization(e,t){if(this.extensionsUsed[rr])return;let s;switch(t.array.constructor){case Int8Array:s="byte";break;case Uint8Array:s="unsigned byte";break;case Int16Array:s="short";break;case Uint16Array:s="unsigned short";break;default:return}t.normalized&&(s+=" normalized");const i=e.split("_",1)[0];Fn[i]&&Fn[i].includes(s)&&(this.extensionsUsed[rr]=!0,this.extensionsRequired[rr]=!0)}processCamera(e){const t=this.json;t.cameras||(t.cameras=[]);const s=e.isOrthographicCamera,i={type:s?"orthographic":"perspective"};return s?i.orthographic={xmag:2*e.right,ymag:2*e.top,zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near}:i.perspective={aspectRatio:e.aspect,yfov:ge.degToRad(e.fov),zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near},""!==e.name&&(i.name=e.type),t.cameras.push(i)-1}processAnimation(e,t){const s=this.json,i=this.nodeMap;s.animations||(s.animations=[]);const n=(e=kn.Utils.mergeMorphTargetTracks(e.clone(),t)).tracks,r=[],o=[];for(let e=0;e<n.length;++e){const s=n[e],a=re.parseTrackName(s.name);let A=re.findNode(t,a.nodeName);const l=ar[a.propertyName];if("bones"===a.objectName&&(A=!0===A.isSkinnedMesh?A.skeleton.getBoneByName(a.objectIndex):void 0),!A||!l)return console.warn('THREE.GLTFExporter: Could not export animation track "%s".',s.name),null;const h=1;let c,u=s.values.length/s.times.length;l===ar.morphTargetInfluences&&(u/=A.morphTargetInfluences.length),!0===s.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline?(c="CUBICSPLINE",u/=3):c=s.getInterpolation()===We?"STEP":"LINEAR",o.push({input:this.processAccessor(new S(s.times,h)),output:this.processAccessor(new S(s.values,u)),interpolation:c}),r.push({sampler:o.length-1,target:{node:i.get(A),path:l}})}return s.animations.push({name:e.name||"clip_"+s.animations.length,samplers:o,channels:r}),s.animations.length-1}processSkin(e){const s=this.json,i=this.nodeMap,n=s.nodes[i.get(e)],r=e.skeleton;if(void 0===r)return null;const o=e.skeleton.bones[0];if(void 0===o)return null;const a=[],A=new Float32Array(16*r.bones.length),l=new t;for(let t=0;t<r.bones.length;++t)a.push(i.get(r.bones[t])),l.copy(r.boneInverses[t]),l.multiply(e.bindMatrix).toArray(A,16*t);void 0===s.skins&&(s.skins=[]),s.skins.push({inverseBindMatrices:this.processAccessor(new S(A,16)),joints:a,skeleton:i.get(o)});return n.skin=s.skins.length-1}processNode(e){const t=this.json,s=this.options,i=this.nodeMap;t.nodes||(t.nodes=[]);const n={};if(s.trs){const t=e.quaternion.toArray(),s=e.position.toArray(),i=e.scale.toArray();lr(t,[0,0,0,1])||(n.rotation=t),lr(s,[0,0,0])||(n.translation=s),lr(i,[1,1,1])||(n.scale=i)}else e.matrixAutoUpdate&&e.updateMatrix(),!1===lr(e.matrix.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])&&(n.matrix=e.matrix.elements);if(""!==e.name&&(n.name=String(e.name)),this.serializeUserData(e,n),e.isMesh||e.isLine||e.isPoints){const t=this.processMesh(e);null!==t&&(n.mesh=t)}else e.isCamera&&(n.camera=this.processCamera(e));if(e.isSkinnedMesh&&this.skins.push(e),e.children.length>0){const t=[];for(let i=0,n=e.children.length;i<n;i++){const n=e.children[i];if(n.visible||!1===s.onlyVisible){const e=this.processNode(n);null!==e&&t.push(e)}}t.length>0&&(n.children=t)}this._invokeAll((function(t){t.writeNode&&t.writeNode(e,n)}));const r=t.nodes.push(n)-1;return i.set(e,r),r}processScene(e){const t=this.json,s=this.options;t.scenes||(t.scenes=[],t.scene=0);const i={};""!==e.name&&(i.name=e.name),t.scenes.push(i);const n=[];for(let t=0,i=e.children.length;t<i;t++){const i=e.children[t];if(i.visible||!1===s.onlyVisible){const e=this.processNode(i);null!==e&&n.push(e)}}n.length>0&&(i.nodes=n),this.serializeUserData(e,i)}processObjects(e){const t=new Qe;t.name="AuxScene";for(let s=0;s<e.length;s++)t.children.push(e[s]);this.processScene(t)}processInput(e){const t=this.options;e=e instanceof Array?e:[e],this._invokeAll((function(t){t.beforeParse&&t.beforeParse(e)}));const s=[];for(let t=0;t<e.length;t++)e[t]instanceof Qe?this.processScene(e[t]):s.push(e[t]);s.length>0&&this.processObjects(s);for(let e=0;e<this.skins.length;++e)this.processSkin(this.skins[e]);for(let s=0;s<t.animations.length;++s)this.processAnimation(t.animations[s],e[0]);this._invokeAll((function(t){t.afterParse&&t.afterParse(e)}))}_invokeAll(e){for(let t=0,s=this.plugins.length;t<s;t++)e(this.plugins[t])}}class pr{constructor(e){this.writer=e,this.name="KHR_lights_punctual"}writeNode(e,t){if(!e.isLight)return;if(!e.isDirectionalLight&&!e.isPointLight&&!e.isSpotLight)return void console.warn("THREE.GLTFExporter: Only directional, point, and spot lights are supported.",e);const s=this.writer,i=s.json,n=s.extensionsUsed,r={};e.name&&(r.name=e.name),r.color=e.color.toArray(),r.intensity=e.intensity,e.isDirectionalLight?r.type="directional":e.isPointLight?(r.type="point",e.distance>0&&(r.range=e.distance)):e.isSpotLight&&(r.type="spot",e.distance>0&&(r.range=e.distance),r.spot={},r.spot.innerConeAngle=(e.penumbra-1)*e.angle*-1,r.spot.outerConeAngle=e.angle),void 0!==e.decay&&2!==e.decay&&console.warn("THREE.GLTFExporter: Light decay may be lost. glTF is physically-based, and expects light.decay=2."),!e.target||e.target.parent===e&&0===e.target.position.x&&0===e.target.position.y&&-1===e.target.position.z||console.warn("THREE.GLTFExporter: Light direction may be lost. For best results, make light.target a child of the light with position 0,0,-1."),n[this.name]||(i.extensions=i.extensions||{},i.extensions[this.name]={lights:[]},n[this.name]=!0);const o=i.extensions[this.name].lights;o.push(r),t.extensions=t.extensions||{},t.extensions[this.name]={light:o.length-1}}}class mr{constructor(e){this.writer=e,this.name="KHR_materials_unlit"}writeMaterial(e,t){if(!e.isMeshBasicMaterial)return;const s=this.writer.extensionsUsed;t.extensions=t.extensions||{},t.extensions[this.name]={},s[this.name]=!0,t.pbrMetallicRoughness.metallicFactor=0,t.pbrMetallicRoughness.roughnessFactor=.9}}class Ir{constructor(e){this.writer=e,this.name="KHR_materials_clearcoat"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0===e.clearcoat)return;const s=this.writer,i=s.extensionsUsed,n={};if(n.clearcoatFactor=e.clearcoat,e.clearcoatMap){const t={index:s.processTexture(e.clearcoatMap)};s.applyTextureTransform(t,e.clearcoatMap),n.clearcoatTexture=t}if(n.clearcoatRoughnessFactor=e.clearcoatRoughness,e.clearcoatRoughnessMap){const t={index:s.processTexture(e.clearcoatRoughnessMap)};s.applyTextureTransform(t,e.clearcoatRoughnessMap),n.clearcoatRoughnessTexture=t}if(e.clearcoatNormalMap){const t={index:s.processTexture(e.clearcoatNormalMap)};s.applyTextureTransform(t,e.clearcoatNormalMap),n.clearcoatNormalTexture=t}t.extensions=t.extensions||{},t.extensions[this.name]=n,i[this.name]=!0}}class fr{constructor(e){this.writer=e,this.name="KHR_materials_iridescence"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0===e.iridescence)return;const s=this.writer,i=s.extensionsUsed,n={};if(n.iridescenceFactor=e.iridescence,e.iridescenceMap){const t={index:s.processTexture(e.iridescenceMap)};s.applyTextureTransform(t,e.iridescenceMap),n.iridescenceTexture=t}if(n.iridescenceIor=e.iridescenceIOR,n.iridescenceThicknessMinimum=e.iridescenceThicknessRange[0],n.iridescenceThicknessMaximum=e.iridescenceThicknessRange[1],e.iridescenceThicknessMap){const t={index:s.processTexture(e.iridescenceThicknessMap)};s.applyTextureTransform(t,e.iridescenceThicknessMap),n.iridescenceThicknessTexture=t}t.extensions=t.extensions||{},t.extensions[this.name]=n,i[this.name]=!0}}class Cr{constructor(e){this.writer=e,this.name="KHR_materials_transmission"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0===e.transmission)return;const s=this.writer,i=s.extensionsUsed,n={};if(n.transmissionFactor=e.transmission,e.transmissionMap){const t={index:s.processTexture(e.transmissionMap)};s.applyTextureTransform(t,e.transmissionMap),n.transmissionTexture=t}t.extensions=t.extensions||{},t.extensions[this.name]=n,i[this.name]=!0}}class Er{constructor(e){this.writer=e,this.name="KHR_materials_volume"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0===e.transmission)return;const s=this.writer,i=s.extensionsUsed,n={};if(n.thicknessFactor=e.thickness,e.thicknessMap){const t={index:s.processTexture(e.thicknessMap)};s.applyTextureTransform(t,e.thicknessMap),n.thicknessTexture=t}n.attenuationDistance=e.attenuationDistance,n.attenuationColor=e.attenuationColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=n,i[this.name]=!0}}class Br{constructor(e){this.writer=e,this.name="KHR_materials_ior"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||1.5===e.ior)return;const s=this.writer.extensionsUsed,i={};i.ior=e.ior,t.extensions=t.extensions||{},t.extensions[this.name]=i,s[this.name]=!0}}class wr{constructor(e){this.writer=e,this.name="KHR_materials_specular"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||1===e.specularIntensity&&e.specularColor.equals(Ar)&&!e.specularIntensityMap&&!e.specularColorTexture)return;const s=this.writer,i=s.extensionsUsed,n={};if(e.specularIntensityMap){const t={index:s.processTexture(e.specularIntensityMap)};s.applyTextureTransform(t,e.specularIntensityMap),n.specularTexture=t}if(e.specularColorMap){const t={index:s.processTexture(e.specularColorMap)};s.applyTextureTransform(t,e.specularColorMap),n.specularColorTexture=t}n.specularFactor=e.specularIntensity,n.specularColorFactor=e.specularColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=n,i[this.name]=!0}}class yr{constructor(e){this.writer=e,this.name="KHR_materials_sheen"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||0==e.sheen)return;const s=this.writer,i=s.extensionsUsed,n={};if(e.sheenRoughnessMap){const t={index:s.processTexture(e.sheenRoughnessMap)};s.applyTextureTransform(t,e.sheenRoughnessMap),n.sheenRoughnessTexture=t}if(e.sheenColorMap){const t={index:s.processTexture(e.sheenColorMap)};s.applyTextureTransform(t,e.sheenColorMap),n.sheenColorTexture=t}n.sheenRoughnessFactor=e.sheenRoughness,n.sheenColorFactor=e.sheenColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=n,i[this.name]=!0}}class Qr{constructor(e){this.writer=e,this.name="KHR_materials_emissive_strength"}writeMaterial(e,t){if(!e.isMeshStandardMaterial||1===e.emissiveIntensity)return;const s=this.writer.extensionsUsed,i={};i.emissiveStrength=e.emissiveIntensity,t.extensions=t.extensions||{},t.extensions[this.name]=i,s[this.name]=!0}}kn.Utils={insertKeyframe:function(e,t){const s=.001,i=e.getValueSize(),n=new e.TimeBufferType(e.times.length+1),r=new e.ValueBufferType(e.values.length+i),o=e.createInterpolant(new e.ValueBufferType(i));let a;if(0===e.times.length){n[0]=t;for(let e=0;e<i;e++)r[e]=0;a=0}else if(t<e.times[0]){if(Math.abs(e.times[0]-t)<s)return 0;n[0]=t,n.set(e.times,1),r.set(o.evaluate(t),0),r.set(e.values,i),a=0}else if(t>e.times[e.times.length-1]){if(Math.abs(e.times[e.times.length-1]-t)<s)return e.times.length-1;n[n.length-1]=t,n.set(e.times,0),r.set(e.values,0),r.set(o.evaluate(t),e.values.length),a=n.length-1}else for(let A=0;A<e.times.length;A++){if(Math.abs(e.times[A]-t)<s)return A;if(e.times[A]<t&&e.times[A+1]>t){n.set(e.times.slice(0,A+1),0),n[A+1]=t,n.set(e.times.slice(A+1),A+2),r.set(e.values.slice(0,(A+1)*i),0),r.set(o.evaluate(t),(A+1)*i),r.set(e.values.slice((A+1)*i),(A+2)*i),a=A+1;break}}return e.times=n,e.values=r,a},mergeMorphTargetTracks:function(e,t){const s=[],i={},n=e.tracks;for(let e=0;e<n.length;++e){let r=n[e];const o=re.parseTrackName(r.name),a=re.findNode(t,o.nodeName);if("morphTargetInfluences"!==o.propertyName||void 0===o.propertyIndex){s.push(r);continue}if(r.createInterpolant!==r.InterpolantFactoryMethodDiscrete&&r.createInterpolant!==r.InterpolantFactoryMethodLinear){if(r.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline)throw new Error("THREE.GLTFExporter: Cannot merge tracks with glTF CUBICSPLINE interpolation.");console.warn("THREE.GLTFExporter: Morph target interpolation mode not yet supported. Using LINEAR instead."),r=r.clone(),r.setInterpolation(me)}const A=a.morphTargetInfluences.length,l=a.morphTargetDictionary[o.propertyIndex];if(void 0===l)throw new Error("THREE.GLTFExporter: Morph target name not found: "+o.propertyIndex);let h;if(void 0===i[a.uuid]){h=r.clone();const e=new h.ValueBufferType(A*h.times.length);for(let t=0;t<h.times.length;t++)e[t*A+l]=h.values[t];h.name=(o.nodeName||"")+".morphTargetInfluences",h.values=e,i[a.uuid]=h,s.push(h);continue}const c=r.createInterpolant(new r.ValueBufferType(1));h=i[a.uuid];for(let e=0;e<h.times.length;e++)h.values[e*A+l]=c.evaluate(h.times[e]);for(let e=0;e<r.times.length;e++){const t=this.insertKeyframe(h,r.times[e]);h.values[t*A+l]=r.values[e]}}return e.tracks=s,e}};
/* @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const vr=e=>void 0!==e.material&&e.userData&&e.userData.variantMaterials&&!!Array.from(e.userData.variantMaterials.values()).filter((e=>br(e.material))),br=e=>e&&e.isMaterial&&!Array.isArray(e);class Sr{constructor(e){this.writer=e,this.name="KHR_materials_variants",this.variantNames=[]}beforeParse(e){const t=new Set;for(const s of e)s.traverse((e=>{if(!vr(e))return;const s=e.userData.variantMaterials,i=e.userData.variantData;for(const[e,n]of i){const i=s.get(n.index);i&&br(i.material)&&t.add(e)}}));t.forEach((e=>this.variantNames.push(e)))}writeMesh(e,t){if(!vr(e))return;const s=e.userData,i=s.variantMaterials,n=s.variantData,r=new Map,o=new Map,a=Array.from(n.values()).sort(((e,t)=>e.index-t.index));for(const[e,t]of a.entries())o.set(t.index,e);for(const e of n.values()){const t=i.get(e.index);if(!t||!br(t.material))continue;const s=this.writer.processMaterial(t.material);r.has(s)||r.set(s,{material:s,variants:[]}),r.get(s).variants.push(o.get(e.index))}const A=Array.from(r.values()).map((e=>e.variants.sort(((e,t)=>e-t))&&e)).sort(((e,t)=>e.material-t.material));if(0===A.length)return;const l=br(s.originalMaterial)?this.writer.processMaterial(s.originalMaterial):-1;for(const e of t.primitives)l>=0&&(e.material=l),e.extensions=e.extensions||{},e.extensions[this.name]={mappings:A}}afterParse(){if(0===this.variantNames.length)return;const e=this.writer.json;e.extensions=e.extensions||{};const t=this.variantNames.map((e=>({name:e})));e.extensions[this.name]={variants:t},this.writer.extensionsUsed[this.name]=!0}}class xr{constructor(e,t,s,i,n){this.xrLight=e,this.renderer=t,this.lightProbe=s,this.xrWebGLBinding=null,this.estimationStartCallback=n,this.frameCallback=this.onXRFrame.bind(this);const r=t.xr.getSession();if(i&&"XRWebGLBinding"in window){const s=new Me(16);e.environment=s.texture;const i=t.getContext();switch(r.preferredReflectionFormat){case"srgba8":i.getExtension("EXT_sRGB");break;case"rgba16f":i.getExtension("OES_texture_half_float")}this.xrWebGLBinding=new XRWebGLBinding(r,i),this.lightProbe.addEventListener("reflectionchange",(()=>{this.updateReflection()}))}r.requestAnimationFrame(this.frameCallback)}updateReflection(){const e=this.renderer.properties.get(this.xrLight.environment);if(e){const t=this.xrWebGLBinding.getReflectionCubeMap(this.lightProbe);t&&(e.__webglTexture=t,this.xrLight.environment.needsPMREMUpdate=!0)}}onXRFrame(e,t){if(!this.xrLight)return;t.session.requestAnimationFrame(this.frameCallback);const s=t.getLightEstimate(this.lightProbe);if(s){this.xrLight.lightProbe.sh.fromArray(s.sphericalHarmonicsCoefficients),this.xrLight.lightProbe.intensity=1;const e=Math.max(1,Math.max(s.primaryLightIntensity.x,Math.max(s.primaryLightIntensity.y,s.primaryLightIntensity.z)));this.xrLight.directionalLight.color.setRGB(s.primaryLightIntensity.x/e,s.primaryLightIntensity.y/e,s.primaryLightIntensity.z/e),this.xrLight.directionalLight.intensity=e,this.xrLight.directionalLight.position.copy(s.primaryLightDirection),this.estimationStartCallback&&(this.estimationStartCallback(),this.estimationStartCallback=null)}}dispose(){this.xrLight=null,this.renderer=null,this.lightProbe=null,this.xrWebGLBinding=null}}class Mr extends ue{constructor(e,t=!0){super(),this.lightProbe=new tt,this.lightProbe.intensity=0,this.add(this.lightProbe),this.directionalLight=new J,this.directionalLight.intensity=0,this.add(this.directionalLight),this.environment=null;let s=null,i=!1;e.xr.addEventListener("sessionstart",(()=>{const n=e.xr.getSession();"requestLightProbe"in n&&n.requestLightProbe({reflectionFormat:n.preferredReflectionFormat}).then((n=>{s=new xr(this,e,n,t,(()=>{i=!0,this.dispatchEvent({type:"estimationstart"})}))}))})),e.xr.addEventListener("sessionend",(()=>{s&&(s.dispose(),s=null),i&&this.dispatchEvent({type:"estimationend"})})),this.dispose=()=>{s&&(s.dispose(),s=null),this.remove(this.lightProbe),this.lightProbe=null,this.remove(this.directionalLight),this.directionalLight=null,this.environment=null}}}
/* @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr{constructor(e=50){this.velocity=0,this.naturalFrequency=0,this.setDecayTime(e)}setDecayTime(e){this.naturalFrequency=1/Math.max(.001,e)}update(e,t,s,i){const n=2e-4*this.naturalFrequency;if(null==e||0===i)return t;if(e===t&&0===this.velocity)return t;if(s<0)return e;const r=e-t,o=this.velocity+this.naturalFrequency*r,a=r+s*o,A=Math.exp(-this.naturalFrequency*s),l=(o-this.naturalFrequency*a)*A,h=-this.naturalFrequency*(l+o*A);return Math.abs(l)<n*Math.abs(i)&&h*r>=0?(this.velocity=0,t):(this.velocity=l,t+a*A)}}
/* @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rr=.2,Tr=Math.PI/24,Lr=new p,Fr=(e,t,s)=>{let i=t>0?s>0?0:-Math.PI/2:s>0?Math.PI/2:Math.PI;for(let n=0;n<=12;++n)e.push(t+.17*Math.cos(i),s+.17*Math.sin(i),0,t+Rr*Math.cos(i),s+Rr*Math.sin(i),0),i+=Tr};class kr extends ae{constructor(e,t){const s=new b,i=[],n=[],{size:r,boundingBox:o}=e,a=r.x/2,A=("back"===t?r.y:r.z)/2;Fr(n,a,A),Fr(n,-a,A),Fr(n,-a,-A),Fr(n,a,-A);const l=n.length/3;for(let e=0;e<l-2;e+=2)i.push(e,e+1,e+3,e,e+3,e+2);const h=l-2;i.push(h,h+1,1,h,1,0),s.setAttribute("position",new st(n,3)),s.setIndex(i),super(s),this.side=t;const c=this.material;switch(c.side=ne,c.transparent=!0,c.opacity=0,this.goalOpacity=0,this.opacityDamper=new Dr,this.hitPlane=new ae(new f(2*(a+Rr),2*(A+Rr))),this.hitPlane.visible=!1,this.hitPlane.material.side=ne,this.add(this.hitPlane),o.getCenter(this.position),t){case"bottom":this.rotateX(-Math.PI/2),this.shadowHeight=o.min.y,this.position.y=this.shadowHeight;break;case"back":this.shadowHeight=o.min.z,this.position.z=this.shadowHeight}e.target.add(this),this.offsetHeight=0}getHit(e,t,s){Lr.set(t,-s),this.hitPlane.visible=!0;const i=e.positionAndNormalFromPoint(Lr,this.hitPlane);return this.hitPlane.visible=!1,null==i?null:i.position}getExpandedHit(e,t,s){this.hitPlane.scale.set(1e3,1e3,1e3),this.hitPlane.updateMatrixWorld();const i=this.getHit(e,t,s);return this.hitPlane.scale.set(1,1,1),i}set offsetHeight(e){e-=.001,"back"===this.side?this.position.z=this.shadowHeight+e:this.position.y=this.shadowHeight+e}get offsetHeight(){return"back"===this.side?this.position.z-this.shadowHeight:this.position.y-this.shadowHeight}set show(e){this.goalOpacity=e?.75:0}updateOpacity(e){const t=this.material;t.opacity=this.opacityDamper.update(t.opacity,this.goalOpacity,e,1),this.visible=t.opacity>0}dispose(){var e;const{geometry:t,material:s}=this.hitPlane;t.dispose(),s.dispose(),this.geometry.dispose(),this.material.dispose(),null===(e=this.parent)||void 0===e||e.remove(this)}}
/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ur=(e,t)=>({type:"number",number:e,unit:t}),_r=(()=>{const e={};return t=>{const s=t;if(s in e)return e[s];const i=[];let n=0;for(;t;){if(++n>1e3){t="";break}const e=Nr(t),s=e.nodes[0];if(null==s||0===s.terms.length)break;i.push(s),t=e.remainingInput}return e[s]=i}})(),Nr=(()=>{const e=/^(\-\-|[a-z\u0240-\uffff])/i,t=/^([\*\+\/]|[\-]\s)/i,s=/^[\),]/;return i=>{const n=[];for(;i.length&&(i=i.trim(),!s.test(i));)if("("===i[0]){const{nodes:e,remainingInput:t}=Hr(i);i=t,n.push({type:"function",name:{type:"ident",value:"calc"},arguments:e})}else if(e.test(i)){const e=Gr(i),t=e.nodes[0];if("("===(i=e.remainingInput)[0]){const{nodes:e,remainingInput:s}=Hr(i);n.push({type:"function",name:t,arguments:e}),i=s}else n.push(t)}else if(t.test(i))n.push({type:"operator",value:i[0]}),i=i.slice(1);else{const{nodes:e,remainingInput:t}="#"===i[0]?Or(i):Pr(i);if(0===e.length)break;n.push(e[0]),i=t}return{nodes:[{type:"expression",terms:n}],remainingInput:i}}})(),Gr=(()=>{const e=/[^a-z0-9_\-\u0240-\uffff]/i;return t=>{const s=t.match(e);return{nodes:[{type:"ident",value:null==s?t:t.substr(0,s.index)}],remainingInput:null==s?"":t.substr(s.index)}}})(),Pr=(()=>{const e=/[\+\-]?(\d+[\.]\d+|\d+|[\.]\d+)([eE][\+\-]?\d+)?/,t=/^[a-z%]+/i,s=/^(m|mm|cm|rad|deg|[%])$/;return i=>{const n=i.match(e),r=null==n?"0":n[0],o=(i=null==r?i:i.slice(r.length)).match(t);let a=null!=o&&""!==o[0]?o[0]:null;const A=null==o?i:i.slice(a.length);return null==a||s.test(a)||(a=null),{nodes:[{type:"number",number:parseFloat(r)||0,unit:a}],remainingInput:A}}})(),Or=(()=>{const e=/^[a-f0-9]*/i;return t=>{const s=(t=t.slice(1).trim()).match(e);return{nodes:null==s?[]:[{type:"hex",value:s[0]}],remainingInput:null==s?t:t.slice(s[0].length)}}})(),Hr=e=>{const t=[];for(e=e.slice(1).trim();e.length;){const s=Nr(e);if(t.push(s.nodes[0]),","===(e=s.remainingInput.trim())[0])e=e.slice(1).trim();else if(")"===e[0]){e=e.slice(1);break}}return{nodes:t,remainingInput:e}},qr=Symbol("visitedTypes");class Vr{constructor(e){this[qr]=e}walk(e,t){const s=e.slice();for(;s.length;){const e=s.shift();switch(this[qr].indexOf(e.type)>-1&&t(e),e.type){case"expression":s.unshift(...e.terms);break;case"function":s.unshift(e.name,...e.arguments)}}}}const Jr=Object.freeze({type:"number",number:0,unit:null}),Kr=(e,t=0)=>{let{number:s,unit:i}=e;if(isFinite(s)){if("rad"===e.unit||null==e.unit)return e}else s=t,i="rad";return{type:"number",number:("deg"===i&&null!=s?s:0)*Math.PI/180,unit:"rad"}},Yr=(e,t=0)=>{let s,{number:i,unit:n}=e;if(isFinite(i)){if("m"===e.unit)return e}else i=t,n="m";switch(n){default:s=1;break;case"cm":s=.01;break;case"mm":s=.001}return{type:"number",number:s*i,unit:"m"}},zr=(()=>{const e=e=>e,t={rad:e,deg:Kr,m:e,mm:Yr,cm:Yr};return(e,s=Jr)=>{isFinite(e.number)||(e.number=s.number,e.unit=s.unit);const{unit:i}=e;if(null==i)return e;const n=t[i];return null==n?s:n(e)}})();
/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var jr,$r,Wr;const Xr=Symbol("evaluate"),Zr=Symbol("lastValue");class eo{constructor(){this[jr]=null}static evaluatableFor(e,t=Jr){if(e instanceof eo)return e;if("number"===e.type)return"%"===e.unit?new io(e,t):e;switch(e.name.value){case"calc":return new Ao(e,t);case"env":return new ro(e)}return Jr}static evaluate(e){return e instanceof eo?e.evaluate():e}static isConstant(e){return!(e instanceof eo)||e.isConstant}static applyIntrinsics(e,t){const{basis:s,keywords:i}=t,{auto:n}=i;return s.map(((t,s)=>{const r=null==n[s]?t:n[s];let o=e[s]?e[s]:r;if("ident"===o.type){const e=o.value;e in i&&(o=i[e][s])}return null!=o&&"ident"!==o.type||(o=r),"%"===o.unit?Ur(o.number/100*t.number,t.unit):(o=zr(o,t),o.unit!==t.unit?t:o)}))}get isConstant(){return!1}evaluate(){return this.isConstant&&null!=this[Zr]||(this[Zr]=this[Xr]()),this[Zr]}}jr=Zr;const to=Symbol("percentage"),so=Symbol("basis");class io extends eo{constructor(e,t){super(),this[to]=e,this[so]=t}get isConstant(){return!0}[Xr](){return Ur(this[to].number/100*this[so].number,this[so].unit)}}const no=Symbol("identNode");class ro extends eo{constructor(e){super(),this[$r]=null;const t=e.arguments.length?e.arguments[0].terms[0]:null;null!=t&&"ident"===t.type&&(this[no]=t)}get isConstant(){return!1}[($r=no,Xr)](){if(null!=this[no]&&"window-scroll-y"===this[no].value){return{type:"number",number:window.pageYOffset/(Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)-window.innerHeight)||0,unit:null}}return Jr}}const oo=/[\*\/]/,ao=Symbol("evaluator");class Ao extends eo{constructor(e,t=Jr){if(super(),this[Wr]=null,1!==e.arguments.length)return;const s=e.arguments[0].terms.slice(),i=[];for(;s.length;){const e=s.shift();if(i.length>0){const s=i[i.length-1];if("operator"===s.type&&oo.test(s.value)){const s=i.pop(),n=i.pop();if(null==n)return;i.push(new uo(s,eo.evaluatableFor(n,t),eo.evaluatableFor(e,t)));continue}}i.push("operator"===e.type?e:eo.evaluatableFor(e,t))}for(;i.length>2;){const[e,s,n]=i.splice(0,3);if("operator"!==s.type)return;i.unshift(new uo(s,eo.evaluatableFor(e,t),eo.evaluatableFor(n,t)))}1===i.length&&(this[ao]=i[0])}get isConstant(){return null==this[ao]||eo.isConstant(this[ao])}[(Wr=ao,Xr)](){return null!=this[ao]?eo.evaluate(this[ao]):Jr}}const lo=Symbol("operator"),ho=Symbol("left"),co=Symbol("right");class uo extends eo{constructor(e,t,s){super(),this[lo]=e,this[ho]=t,this[co]=s}get isConstant(){return eo.isConstant(this[ho])&&eo.isConstant(this[co])}[Xr](){const e=zr(eo.evaluate(this[ho])),t=zr(eo.evaluate(this[co])),{number:s,unit:i}=e,{number:n,unit:r}=t;if(null!=r&&null!=i&&r!=i)return Jr;const o=i||r;let a;switch(this[lo].value){case"+":a=s+n;break;case"-":a=s-n;break;case"/":a=s/n;break;case"*":a=s*n;break;default:return Jr}return{type:"number",number:a,unit:o}}}const go=Symbol("evaluatables"),po=Symbol("intrinsics");class mo extends eo{constructor(e,t){super(),this[po]=t;const s=e[0],i=null!=s?s.terms:[];this[go]=t.basis.map(((e,t)=>{const s=i[t];return null==s?{type:"ident",value:"auto"}:"ident"===s.type?s:eo.evaluatableFor(s,e)}))}get isConstant(){for(const e of this[go])if(!eo.isConstant(e))return!1;return!0}[Xr](){const e=this[go].map((e=>eo.evaluate(e)));return eo.applyIntrinsics(e,this[po]).map((e=>e.number))}}
/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Io,fo,Co,Eo;const Bo=Symbol("instances"),wo=Symbol("activateListener"),yo=Symbol("deactivateListener"),Qo=Symbol("notifyInstances"),vo=Symbol("notify"),bo=Symbol("callback");class So{constructor(e){this[bo]=e}static[Qo](){for(const e of So[Bo])e[vo]()}static[(Io=Bo,wo)](){window.addEventListener("scroll",this[Qo],{passive:!0})}static[yo](){window.removeEventListener("scroll",this[Qo])}observe(){0===So[Bo].size&&So[wo](),So[Bo].add(this)}disconnect(){So[Bo].delete(this),0===So[Bo].size&&So[yo]()}[vo](){this[bo]()}}So[Io]=new Set;const xo=Symbol("computeStyleCallback"),Mo=Symbol("astWalker"),Do=Symbol("dependencies"),Ro=Symbol("onScroll");class To{constructor(e){this[fo]={},this[Co]=new Vr(["function"]),this[Eo]=()=>{this[xo]({relatedState:"window-scroll"})},this[xo]=e}observeEffectsFor(e){const t={},s=this[Do];this[Mo].walk(e,(e=>{const{name:i}=e,n=e.arguments[0].terms[0];if("env"===i.value&&null!=n&&"ident"===n.type&&"window-scroll-y"===n.value)if(null==t["window-scroll"]){const e="window-scroll"in s?s["window-scroll"]:new So(this[Ro]);e.observe(),delete s["window-scroll"],t["window-scroll"]=e}}));for(const e in s){s[e].disconnect()}this[Do]=t}dispose(){for(const e in this[Do]){this[Do][e].disconnect()}}}fo=Do,Co=Mo,Eo=Ro;
/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const Lo=e=>{const t=e.observeEffects||!1,s=e.intrinsics instanceof Function?e.intrinsics:()=>e.intrinsics;return(i,n)=>{const r=i.updated,o=i.connectedCallback,a=i.disconnectedCallback,A=Symbol(`${n}StyleEffector`),l=Symbol(`${n}StyleEvaluator`),h=Symbol(`${n}UpdateEvaluator`),c=Symbol(`${n}EvaluateAndSync`);Object.defineProperties(i,{[A]:{value:null,writable:!0},[l]:{value:null,writable:!0},[h]:{value:function(){const e=_r(this[n]);this[l]=new mo(e,s(this)),null==this[A]&&t&&(this[A]=new To((()=>this[c]()))),null!=this[A]&&this[A].observeEffectsFor(e)}},[c]:{value:function(){if(null==this[l])return;const t=this[l].evaluate();this[e.updateHandler](t)}},updated:{value:function(e){e.has(n)&&(this[h](),this[c]()),r.call(this,e)}},connectedCallback:{value:function(){o.call(this),this.requestUpdate(n,this[n])}},disconnectedCallback:{value:function(){a.call(this),null!=this[A]&&(this[A].dispose(),this[A]=null)}}})}},Fo=e=>e<.5?2*e*e:(4-2*e)*e-1,ko=(e,t,s=Fo)=>i=>e+(t-e)*s(i),Uo=e=>{const t=[],s=[];let i=e.initialValue;for(let n=0;n<e.keyframes.length;++n){const r=e.keyframes[n],{value:o,frames:a}=r,A=r.ease||Fo,l=ko(i,o,A);t.push(l),s.push(a),i=o}return((e,t)=>{const s=t.map((i=0,e=>i+=e));var i;return t=>{t=xs(t,0,1),t*=s[s.length-1];const i=s.findIndex((e=>e>=t)),n=i<1?0:s[i-1],r=s[i];return e[i]((t-n)/(r-n))}})(t,s)};
/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var _o=function(e,t,s,i){for(var n,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,s):i,a=e.length-1;a>=0;a--)(n=e[a])&&(o=(r<3?n(o):r>3?n(t,s,o):n(t,s))||o);return r>3&&o&&Object.defineProperty(t,s,o),o};const No=Uo({initialValue:0,keyframes:[{frames:5,value:-1},{frames:1,value:-1},{frames:8,value:1},{frames:1,value:1},{frames:5,value:0},{frames:18,value:0}]}),Go=Uo({initialValue:0,keyframes:[{frames:1,value:1},{frames:5,value:1},{frames:1,value:0},{frames:6,value:0}]}),Po="0deg 75deg 105%",Oo=["front","right","back","left"],Ho=["upper-","","lower-"],qo="auto",Vo="basic",Jo="wiggle",Ko="none",Yo=()=>({basis:[Kr(Ur(30,"deg"))],keywords:{auto:[null]}}),zo=()=>({basis:[Kr(Ur(12,"deg"))],keywords:{auto:[null]}}),jo=(()=>{const e=_r(Po)[0].terms,t=zr(e[0]),s=zr(e[1]);return e=>{const i=e[sc].idealCameraDistance();return{basis:[t,s,Ur(i,"m")],keywords:{auto:[null,null,Ur(105,"%")]}}}})(),$o=e=>{const t=2.2*e[sc].boundingSphere.radius;return{basis:[Ur(-1/0,"rad"),Ur(Math.PI/8,"rad"),Ur(t,"m")],keywords:{auto:[null,null,null]}}},Wo=e=>{const t=jo(e),s=new mo([],t).evaluate()[2];return{basis:[Ur(1/0,"rad"),Ur(Math.PI-Math.PI/8,"rad"),Ur(s,"m")],keywords:{auto:[null,null,null]}}},Xo=e=>{const t=e[sc].boundingBox.getCenter(new g);return{basis:[Ur(t.x,"m"),Ur(t.y,"m"),Ur(t.z,"m")],keywords:{auto:[null,null,null]}}},Zo=Math.PI/2,ea=Math.PI/3,ta=Zo/2,sa=2*Math.PI,ia=Symbol("controls"),na=Symbol("panElement"),ra=Symbol("promptElement"),oa=Symbol("promptAnimatedContainer"),aa=Symbol("fingerAnimatedContainers"),Aa=Symbol("deferInteractionPrompt"),la=Symbol("updateAria"),ha=Symbol("updateCameraForRadius"),ca=Symbol("cancelPrompts"),ua=Symbol("onChange"),ga=Symbol("onPointerChange"),da=Symbol("waitingToPromptUser"),pa=Symbol("userHasInteracted"),ma=Symbol("promptElementVisibleTime"),Ia=Symbol("lastPromptOffset"),fa=Symbol("cancellationSource"),Ca=Symbol("lastSpherical"),Ea=Symbol("jumpCamera"),Ba=Symbol("initialized"),wa=Symbol("maintainThetaPhi"),ya=Symbol("syncCameraOrbit"),Qa=Symbol("syncFieldOfView"),va=Symbol("syncCameraTarget"),ba=Symbol("syncMinCameraOrbit"),Sa=Symbol("syncMaxCameraOrbit"),xa=Symbol("syncMinFieldOfView"),Ma=Symbol("syncMaxFieldOfView"),Da=new p,Ra=new g,Ta=Object.freeze({minimumRadius:0,maximumRadius:1/0,minimumPolarAngle:Math.PI/8,maximumPolarAngle:Math.PI-Math.PI/8,minimumAzimuthalAngle:-1/0,maximumAzimuthalAngle:1/0,minimumFieldOfView:10,maximumFieldOfView:45,touchAction:"none"}),La=Math.PI/8,Fa=.04,ka={USER_INTERACTION:"user-interaction",NONE:"none",AUTOMATIC:"automatic"};class Ua extends G{constructor(e,t,s){super(),this.camera=e,this.element=t,this.scene=s,this.orbitSensitivity=1,this.inputSensitivity=1,this.changeSource=ka.NONE,this._interactionEnabled=!1,this._disableZoom=!1,this.isUserPointing=!1,this.enablePan=!0,this.enableTap=!0,this.panProjection=new C,this.panPerPixel=0,this.spherical=new Be,this.goalSpherical=new Be,this.thetaDamper=new Dr,this.phiDamper=new Dr,this.radiusDamper=new Dr,this.logFov=Math.log(Ta.maximumFieldOfView),this.goalLogFov=this.logFov,this.fovDamper=new Dr,this.touchMode=null,this.pointers=[],this.startTime=0,this.startPointerPosition={clientX:0,clientY:0},this.lastSeparation=0,this.touchDecided=!1,this.onContext=e=>{if(this.enablePan)e.preventDefault();else for(const e of this.pointers)this.onPointerUp(new PointerEvent("pointercancel",Object.assign(Object.assign({},this.startPointerPosition),{pointerId:e.id})))},this.touchModeZoom=(e,t)=>{if(!this._disableZoom){const e=this.twoTouchDistance(this.pointers[0],this.pointers[1]),t=Fa*(this.lastSeparation-e)*50/this.scene.height;this.lastSeparation=e,this.userAdjustOrbit(0,0,t)}this.panPerPixel>0&&this.movePan(e,t)},this.disableScroll=e=>{e.preventDefault()},this.touchModeRotate=(e,t)=>{const{touchAction:s}=this._options;if(!this.touchDecided&&"none"!==s){this.touchDecided=!0;const i=Math.abs(e),n=Math.abs(t);if(this.changeSource===ka.USER_INTERACTION&&("pan-y"===s&&n>i||"pan-x"===s&&i>n))return void(this.touchMode=null);this.element.addEventListener("touchmove",this.disableScroll,{passive:!1})}this.handleSinglePointerMove(e,t)},this.onPointerDown=e=>{if(this.pointers.length>2)return;const{element:t}=this;0===this.pointers.length&&(t.addEventListener("pointermove",this.onPointerMove),t.addEventListener("pointerup",this.onPointerUp),this.touchMode=null,this.touchDecided=!1,this.startPointerPosition.clientX=e.clientX,this.startPointerPosition.clientY=e.clientY,this.startTime=performance.now());try{t.setPointerCapture(e.pointerId)}catch(e){}this.pointers.push({clientX:e.clientX,clientY:e.clientY,id:e.pointerId}),this.isUserPointing=!1,"touch"===e.pointerType?(this.changeSource=e.altKey?ka.AUTOMATIC:ka.USER_INTERACTION,this.onTouchChange(e)):(this.changeSource=ka.USER_INTERACTION,this.onMouseDown(e)),this.changeSource===ka.USER_INTERACTION&&this.dispatchEvent({type:"user-interaction"})},this.onPointerMove=e=>{const t=this.pointers.find((t=>t.id===e.pointerId));if(null==t)return;const s=this.pointers.length,i=(e.clientX-t.clientX)/s,n=(e.clientY-t.clientY)/s;0===i&&0===n||(t.clientX=e.clientX,t.clientY=e.clientY,"touch"===e.pointerType?(this.changeSource=e.altKey?ka.AUTOMATIC:ka.USER_INTERACTION,null!==this.touchMode&&this.touchMode(i,n)):(this.changeSource=ka.USER_INTERACTION,this.panPerPixel>0?this.movePan(i,n):this.handleSinglePointerMove(i,n)))},this.onPointerUp=e=>{const{element:t}=this,s=this.pointers.findIndex((t=>t.id===e.pointerId));-1!==s&&this.pointers.splice(s,1),this.panPerPixel>0&&!e.altKey&&this.resetRadius(),0===this.pointers.length?(t.removeEventListener("pointermove",this.onPointerMove),t.removeEventListener("pointerup",this.onPointerUp),t.removeEventListener("touchmove",this.disableScroll),this.enablePan&&this.enableTap&&this.recenter(e)):null!==this.touchMode&&this.onTouchChange(e),this.scene.element[na].style.opacity=0,t.style.cursor="grab",this.panPerPixel=0,this.isUserPointing&&this.dispatchEvent({type:"pointer-change-end"})},this.onWheel=e=>{this.changeSource=ka.USER_INTERACTION;const t=e.deltaY*(1==e.deltaMode?18:1)*Fa/30;this.userAdjustOrbit(0,0,t),e.preventDefault(),this.dispatchEvent({type:"user-interaction"})},this.onKeyDown=e=>{const{changeSource:t}=this;this.changeSource=ka.USER_INTERACTION;(e.shiftKey&&this.enablePan?this.panKeyCodeHandler(e):this.orbitZoomKeyCodeHandler(e))?(e.preventDefault(),this.dispatchEvent({type:"user-interaction"})):this.changeSource=t},this._options=Object.assign({},Ta),this.setOrbit(0,Math.PI/2,1),this.setFieldOfView(100),this.jumpToGoal()}get interactionEnabled(){return this._interactionEnabled}enableInteraction(){if(!1===this._interactionEnabled){const{element:e}=this;e.addEventListener("pointerdown",this.onPointerDown),e.addEventListener("pointercancel",this.onPointerUp),this._disableZoom||e.addEventListener("wheel",this.onWheel),e.addEventListener("keydown",this.onKeyDown),e.addEventListener("touchmove",(()=>{}),{passive:!1}),e.addEventListener("contextmenu",this.onContext),this.element.style.cursor="grab",this._interactionEnabled=!0,this.updateTouchActionStyle()}}disableInteraction(){if(!0===this._interactionEnabled){const{element:e}=this;e.removeEventListener("pointerdown",this.onPointerDown),e.removeEventListener("pointermove",this.onPointerMove),e.removeEventListener("pointerup",this.onPointerUp),e.removeEventListener("pointercancel",this.onPointerUp),e.removeEventListener("wheel",this.onWheel),e.removeEventListener("keydown",this.onKeyDown),e.removeEventListener("contextmenu",this.onContext),e.style.cursor="",this.touchMode=null,this._interactionEnabled=!1,this.updateTouchActionStyle()}}get options(){return this._options}set disableZoom(e){this._disableZoom!=e&&(this._disableZoom=e,!0===e?this.element.removeEventListener("wheel",this.onWheel):this.element.addEventListener("wheel",this.onWheel),this.updateTouchActionStyle())}getCameraSpherical(e=new Be){return e.copy(this.spherical)}getFieldOfView(){return this.camera.fov}applyOptions(e){Object.assign(this._options,e),this.setOrbit(),this.setFieldOfView(Math.exp(this.goalLogFov))}updateNearFar(e,t){this.camera.far=0===t?2:t,this.camera.near=Math.max(e,this.camera.far/1e3),this.camera.updateProjectionMatrix()}updateAspect(e){this.camera.aspect=e,this.camera.updateProjectionMatrix()}setOrbit(e=this.goalSpherical.theta,t=this.goalSpherical.phi,s=this.goalSpherical.radius){const{minimumAzimuthalAngle:i,maximumAzimuthalAngle:n,minimumPolarAngle:r,maximumPolarAngle:o,minimumRadius:a,maximumRadius:A}=this._options,{theta:l,phi:h,radius:c}=this.goalSpherical,u=xs(e,i,n);isFinite(i)||isFinite(n)||(this.spherical.theta=this.wrapAngle(this.spherical.theta-u)+u);const g=xs(t,r,o),d=xs(s,a,A);return(u!==l||g!==h||d!==c)&&(!!(isFinite(u)&&isFinite(g)&&isFinite(d))&&(this.goalSpherical.theta=u,this.goalSpherical.phi=g,this.goalSpherical.radius=d,this.goalSpherical.makeSafe(),!0))}setRadius(e){this.goalSpherical.radius=e,this.setOrbit()}setFieldOfView(e){const{minimumFieldOfView:t,maximumFieldOfView:s}=this._options;e=xs(e,t,s),this.goalLogFov=Math.log(e)}setDamperDecayTime(e){this.thetaDamper.setDecayTime(e),this.phiDamper.setDecayTime(e),this.radiusDamper.setDecayTime(e),this.fovDamper.setDecayTime(e)}adjustOrbit(e,t,s){const{theta:i,phi:n,radius:r}=this.goalSpherical,{minimumRadius:o,maximumRadius:a,minimumFieldOfView:A,maximumFieldOfView:l}=this._options,h=this.spherical.theta-i,c=Math.PI-.001,u=i-xs(e,-c-h,c-h),g=n-t,d=0===s?0:((s>0?a:o)-r)/(Math.log(s>0?l:A)-this.goalLogFov),p=r+s*(isFinite(d)?d:2*(a-o));if(this.setOrbit(u,g,p),0!==s){const e=this.goalLogFov+s;this.setFieldOfView(Math.exp(e))}}jumpToGoal(){this.update(0,1e4)}update(e,t){if(this.isStationary())return!1;const{maximumPolarAngle:s,maximumRadius:i}=this._options,n=this.spherical.theta-this.goalSpherical.theta;return Math.abs(n)>Math.PI&&!isFinite(this._options.minimumAzimuthalAngle)&&!isFinite(this._options.maximumAzimuthalAngle)&&(this.spherical.theta-=2*Math.sign(n)*Math.PI),this.spherical.theta=this.thetaDamper.update(this.spherical.theta,this.goalSpherical.theta,t,Math.PI),this.spherical.phi=this.phiDamper.update(this.spherical.phi,this.goalSpherical.phi,t,s),this.spherical.radius=this.radiusDamper.update(this.spherical.radius,this.goalSpherical.radius,t,i),this.logFov=this.fovDamper.update(this.logFov,this.goalLogFov,t,1),this.moveCamera(),!0}updateTouchActionStyle(){const{style:e}=this.element;if(this._interactionEnabled){const{touchAction:t}=this._options;this._disableZoom&&"none"!==t?e.touchAction="manipulation":e.touchAction=t}else e.touchAction=""}isStationary(){return this.goalSpherical.theta===this.spherical.theta&&this.goalSpherical.phi===this.spherical.phi&&this.goalSpherical.radius===this.spherical.radius&&this.goalLogFov===this.logFov}moveCamera(){this.spherical.makeSafe(),this.camera.position.setFromSpherical(this.spherical),this.camera.setRotationFromEuler(new we(this.spherical.phi-Math.PI/2,this.spherical.theta,0,"YXZ")),this.camera.fov!==Math.exp(this.logFov)&&(this.camera.fov=Math.exp(this.logFov),this.camera.updateProjectionMatrix())}userAdjustOrbit(e,t,s){this.adjustOrbit(e*this.orbitSensitivity*this.inputSensitivity,t*this.orbitSensitivity*this.inputSensitivity,s*this.inputSensitivity)}wrapAngle(e){const t=(e+Math.PI)/(2*Math.PI);return 2*(t-Math.floor(t))*Math.PI-Math.PI}pixelLengthToSphericalAngle(e){return 2*Math.PI*e/this.scene.height}twoTouchDistance(e,t){const{clientX:s,clientY:i}=e,{clientX:n,clientY:r}=t,o=n-s,a=r-i;return Math.sqrt(o*o+a*a)}handleSinglePointerMove(e,t){const s=this.pixelLengthToSphericalAngle(e),i=this.pixelLengthToSphericalAngle(t);!1===this.isUserPointing&&(this.isUserPointing=!0,this.dispatchEvent({type:"pointer-change-start"})),this.userAdjustOrbit(s,i,0)}initializePan(){const{theta:e,phi:t}=this.spherical,s=e-this.scene.yaw;this.panPerPixel=.018/this.scene.height,this.panProjection.set(-Math.cos(s),-Math.cos(t)*Math.sin(s),0,0,Math.sin(t),0,Math.sin(s),-Math.cos(t)*Math.cos(s),0)}movePan(e,t){const{scene:s}=this,i=Ra.set(e,t,0).multiplyScalar(this.inputSensitivity),n=this.spherical.radius*Math.exp(this.logFov)*this.panPerPixel;i.multiplyScalar(n);const r=s.getTarget();r.add(i.applyMatrix3(this.panProjection)),s.boundingSphere.clampPoint(r,r),s.setTarget(r.x,r.y,r.z)}recenter(e){if(performance.now()>this.startTime+300||Math.abs(e.clientX-this.startPointerPosition.clientX)>2||Math.abs(e.clientY-this.startPointerPosition.clientY)>2)return;const{scene:t}=this,s=t.positionAndNormalFromPoint(t.getNDC(e.clientX,e.clientY));if(null==s){const{cameraTarget:e}=t.element;t.element.cameraTarget="",t.element.cameraTarget=e,this.userAdjustOrbit(0,0,1)}else t.target.worldToLocal(s.position),t.setTarget(s.position.x,s.position.y,s.position.z)}resetRadius(){const{scene:e}=this,t=e.positionAndNormalFromPoint(Da.set(0,0));if(null==t)return;e.target.worldToLocal(t.position);const s=e.getTarget(),{theta:i,phi:n}=this.spherical,r=i-e.yaw,o=Ra.set(Math.sin(n)*Math.sin(r),Math.cos(n),Math.sin(n)*Math.cos(r)),a=o.dot(t.position.sub(s));s.add(o.multiplyScalar(a)),e.setTarget(s.x,s.y,s.z),this.setOrbit(void 0,void 0,this.goalSpherical.radius-a)}onTouchChange(e){if(1===this.pointers.length)this.touchMode=this.touchModeRotate;else{if(this._disableZoom)return this.touchMode=null,void this.element.removeEventListener("touchmove",this.disableScroll);this.touchMode=this.touchDecided&&null===this.touchMode?null:this.touchModeZoom,this.touchDecided=!0,this.element.addEventListener("touchmove",this.disableScroll,{passive:!1}),this.lastSeparation=this.twoTouchDistance(this.pointers[0],this.pointers[1]),this.enablePan&&null!=this.touchMode&&(this.initializePan(),e.altKey||(this.scene.element[na].style.opacity=1))}}onMouseDown(e){this.panPerPixel=0,this.enablePan&&(2===e.button||e.ctrlKey||e.metaKey||e.shiftKey)&&(this.initializePan(),this.scene.element[na].style.opacity=1),this.element.style.cursor="grabbing"}orbitZoomKeyCodeHandler(e){let t=!0;switch(e.key){case"PageUp":this.userAdjustOrbit(0,0,Fa);break;case"PageDown":this.userAdjustOrbit(0,0,-.04);break;case"ArrowUp":this.userAdjustOrbit(0,-La,0);break;case"ArrowDown":this.userAdjustOrbit(0,La,0);break;case"ArrowLeft":this.userAdjustOrbit(-La,0,0);break;case"ArrowRight":this.userAdjustOrbit(La,0,0);break;default:t=!1}return t}panKeyCodeHandler(e){this.initializePan();let t=!0;switch(e.key){case"ArrowUp":this.movePan(0,-10);break;case"ArrowDown":this.movePan(0,10);break;case"ArrowLeft":this.movePan(-10,0);break;case"ArrowRight":this.movePan(10,0);break;default:t=!1}return t}}
/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _a="not-presenting",Na="session-started",Ga="object-placed",Pa="failed",Oa="tracking",Ha="not-tracking",qa=new g,Va=new t,Ja=new g,Ka=new m(45,1,.1,100);class Ya extends G{constructor(e){super(),this.renderer=e,this.currentSession=null,this.placeOnWall=!1,this.placementBox=null,this.lastTick=null,this.turntableRotation=null,this.oldShadowIntensity=null,this.frame=null,this.initialHitSource=null,this.transientHitTestSource=null,this.inputSource=null,this._presentedScene=null,this.resolveCleanup=null,this.exitWebXRButtonContainer=null,this.overlay=null,this.xrLight=null,this.tracking=!0,this.frames=0,this.initialized=!1,this.oldTarget=new g,this.placementComplete=!1,this.isTranslating=!1,this.isRotating=!1,this.isTwoFingering=!1,this.lastDragPosition=new g,this.firstRatio=0,this.lastAngle=0,this.goalPosition=new g,this.goalYaw=0,this.goalScale=1,this.xDamper=new Dr,this.yDamper=new Dr,this.zDamper=new Dr,this.yawDamper=new Dr,this.scaleDamper=new Dr,this.onExitWebXRButtonContainerClick=()=>this.stopPresenting(),this.onUpdateScene=()=>{null!=this.placementBox&&this.isPresenting&&(this.placementBox.dispose(),this.placementBox=new kr(this.presentedScene,this.placeOnWall?"back":"bottom"))},this.onSelectStart=e=>{const t=this.transientHitTestSource;if(null==t)return;const s=this.frame.getHitTestResultsForTransientInput(t),i=this.presentedScene,n=this.placementBox;if(1===s.length){this.inputSource=e.inputSource;const{axes:t}=this.inputSource.gamepad,s=n.getHit(this.presentedScene,t[0],t[1]);n.show=!0,null!=s?(this.isTranslating=!0,this.lastDragPosition.copy(s)):!1===this.placeOnWall&&(this.isRotating=!0,this.lastAngle=1.5*t[0])}else if(2===s.length){n.show=!0,this.isTwoFingering=!0;const{separation:e}=this.fingerPolar(s);this.firstRatio=e/i.scale.x}},this.onSelectEnd=()=>{this.isTranslating=!1,this.isRotating=!1,this.isTwoFingering=!1,this.inputSource=null,this.goalPosition.y+=this.placementBox.offsetHeight*this.presentedScene.scale.x,this.placementBox.show=!1},this.threeRenderer=e.threeRenderer,this.threeRenderer.xr.enabled=!0}async resolveARSession(){vs();const e=await navigator.xr.requestSession("immersive-ar",{requiredFeatures:["hit-test"],optionalFeatures:["dom-overlay","light-estimation"],domOverlay:this.overlay?{root:this.overlay}:void 0});return this.threeRenderer.xr.setReferenceSpaceType("local"),await this.threeRenderer.xr.setSession(e),this.threeRenderer.xr.cameraAutoUpdate=!1,e}get presentedScene(){return this._presentedScene}async supportsPresentation(){try{return vs(),await navigator.xr.isSessionSupported("immersive-ar")}catch(e){return console.warn("Request to present in WebXR denied:"),console.warn(e),console.warn("Falling back to next ar-mode"),!1}}async present(e,t=!1){this.isPresenting&&console.warn("Cannot present while a model is already presenting");let s=new Promise(((e,t)=>{requestAnimationFrame((()=>e()))}));e.setHotspotsVisibility(!1),e.queueRender(),await s,this._presentedScene=e,this.overlay=e.element.shadowRoot.querySelector("div.default"),!0===t&&(this.xrLight=new Mr(this.threeRenderer),this.xrLight.addEventListener("estimationstart",(()=>{if(!this.isPresenting||null==this.xrLight)return;const e=this.presentedScene;e.add(this.xrLight),e.environment=this.xrLight.environment})));const i=await this.resolveARSession();i.addEventListener("end",(()=>{this.postSessionCleanup()}),{once:!0});const n=e.element.shadowRoot.querySelector(".slot.exit-webxr-ar-button");n.classList.add("enabled"),n.addEventListener("click",this.onExitWebXRButtonContainerClick),this.exitWebXRButtonContainer=n;const r=await i.requestReferenceSpace("viewer");this.tracking=!0,this.frames=0,this.initialized=!1,this.turntableRotation=e.yaw,this.goalYaw=e.yaw,this.goalScale=1,e.background=null,this.oldShadowIntensity=e.shadowIntensity,e.setShadowIntensity(.01),this.oldTarget.copy(e.getTarget()),e.element.addEventListener("load",this.onUpdateScene);const o=20*Math.PI/180,a=!0===this.placeOnWall?void 0:new XRRay(new DOMPoint(0,0,0),{x:0,y:-Math.sin(o),z:-Math.cos(o)});i.requestHitTestSource({space:r,offsetRay:a}).then((e=>{this.initialHitSource=e})),this.currentSession=i,this.placementBox=new kr(e,this.placeOnWall?"back":"bottom"),this.placementComplete=!1,this.lastTick=performance.now(),this.dispatchEvent({type:"status",status:Na})}async stopPresenting(){if(!this.isPresenting)return;const e=new Promise((e=>{this.resolveCleanup=e}));try{await this.currentSession.end(),await e}catch(e){console.warn("Error while trying to end WebXR AR session"),console.warn(e),this.postSessionCleanup()}}get isPresenting(){return null!=this.presentedScene}get target(){return this.oldTarget}updateTarget(){const e=this.presentedScene;if(null!=e){const t=e.getTarget();this.oldTarget.copy(t),this.placeOnWall?t.z=e.boundingBox.min.z:t.y=e.boundingBox.min.y,e.setTarget(t.x,t.y,t.z)}}postSessionCleanup(){const e=this.currentSession;null!=e&&(e.removeEventListener("selectstart",this.onSelectStart),e.removeEventListener("selectend",this.onSelectEnd),this.currentSession=null);const t=this.presentedScene;if(this._presentedScene=null,null!=t){const{element:e}=t;null!=this.xrLight&&(t.remove(this.xrLight),this.xrLight.dispose(),this.xrLight=null),t.position.set(0,0,0),t.scale.set(1,1,1),t.setShadowOffset(0);const s=this.turntableRotation;null!=s&&(t.yaw=s);const i=this.oldShadowIntensity;null!=i&&t.setShadowIntensity(i),t.setEnvironmentAndSkybox(e[Ts],e[Ls]);const n=this.oldTarget;t.setTarget(n.x,n.y,n.z),t.xrCamera=null,t.element.removeEventListener("load",this.onUpdateScene),t.orientHotspots(0),e.requestUpdate("cameraTarget"),e.requestUpdate("maxCameraOrbit"),e[oc](e.getBoundingClientRect()),requestAnimationFrame((()=>{t.element.dispatchEvent(new CustomEvent("camera-change",{detail:{source:ka.NONE}}))}))}this.renderer.height=0;const s=this.exitWebXRButtonContainer;null!=s&&(s.classList.remove("enabled"),s.removeEventListener("click",this.onExitWebXRButtonContainerClick),this.exitWebXRButtonContainer=null);const i=this.transientHitTestSource;null!=i&&(i.cancel(),this.transientHitTestSource=null);const n=this.initialHitSource;null!=n&&(n.cancel(),this.initialHitSource=null),null!=this.placementBox&&(this.placementBox.dispose(),this.placementBox=null),this.lastTick=null,this.turntableRotation=null,this.oldShadowIntensity=null,this.frame=null,this.inputSource=null,this.overlay=null,null!=this.resolveCleanup&&this.resolveCleanup(),this.dispatchEvent({type:"status",status:_a})}updateView(e){const t=this.presentedScene,s=this.threeRenderer.xr;s.updateCamera(Ka),t.xrCamera=s.getCamera();const{elements:i}=t.getCamera().matrixWorld;if(t.orientHotspots(Math.atan2(i[1],i[5])),this.initialized||(this.placeInitially(),this.initialized=!0),e.requestViewportScale&&e.recommendedViewportScale){const t=e.recommendedViewportScale;e.requestViewportScale(Math.max(t,.25))}const n=s.getBaseLayer();if(null!=n){const t=n instanceof XRWebGLLayer?n.getViewport(e):s.getBinding().getViewSubImage(n,e).viewport;this.threeRenderer.setViewport(t.x,t.y,t.width,t.height)}}placeInitially(){const e=this.presentedScene,{position:t,element:s}=e,i=e.getCamera(),{width:n,height:r}=this.overlay.getBoundingClientRect();e.setSize(n,r),i.projectionMatrixInverse.copy(i.projectionMatrix).invert();const{theta:o,radius:a}=s.getCameraOrbit(),A=i.getWorldDirection(qa);e.yaw=Math.atan2(-A.x,-A.z)-o,this.goalYaw=e.yaw,t.copy(i.position).add(A.multiplyScalar(a)),this.updateTarget();const l=e.getTarget();t.add(l).sub(this.oldTarget),this.goalPosition.copy(t),e.setHotspotsVisibility(!0);const{session:h}=this.frame;h.addEventListener("selectstart",this.onSelectStart),h.addEventListener("selectend",this.onSelectEnd),h.requestHitTestSourceForTransientInput({profile:"generic-touchscreen"}).then((e=>{this.transientHitTestSource=e}))}getTouchLocation(){const{axes:e}=this.inputSource.gamepad;let t=this.placementBox.getExpandedHit(this.presentedScene,e[0],e[1]);return null!=t&&(qa.copy(t).sub(this.presentedScene.getCamera().position),qa.length()>10)?null:t}getHitPoint(e){const t=this.threeRenderer.xr.getReferenceSpace(),s=e.getPose(t);if(null==s)return null;const i=Va.fromArray(s.transform.matrix);return!0===this.placeOnWall&&(this.goalYaw=Math.atan2(i.elements[4],i.elements[6])),i.elements[5]>.75!==this.placeOnWall?Ja.setFromMatrixPosition(i):null}moveToFloor(e){const t=this.initialHitSource;if(null==t)return;const s=e.getHitTestResults(t);if(0==s.length)return;const i=s[0],n=this.getHitPoint(i);null!=n&&(this.placementBox.show=!0,this.isTranslating||(this.placeOnWall?this.goalPosition.copy(n):this.goalPosition.y=n.y),t.cancel(),this.initialHitSource=null,this.dispatchEvent({type:"status",status:Ga}))}fingerPolar(e){const t=e[0].inputSource.gamepad.axes,s=e[1].inputSource.gamepad.axes,i=s[0]-t[0],n=s[1]-t[1],r=Math.atan2(n,i);let o=this.lastAngle-r;return o>Math.PI?o-=2*Math.PI:o<-Math.PI&&(o+=2*Math.PI),this.lastAngle=r,{separation:Math.sqrt(i*i+n*n),deltaYaw:o}}processInput(e){const t=this.transientHitTestSource;if(null==t)return;if(!this.isTranslating&&!this.isTwoFingering&&!this.isRotating)return;const s=e.getHitTestResultsForTransientInput(t),i=this.presentedScene,n=i.scale.x;if(this.isTwoFingering)if(s.length<2)this.isTwoFingering=!1;else{const{separation:e,deltaYaw:t}=this.fingerPolar(s);if(!1===this.placeOnWall&&(this.goalYaw+=t),i.canScale){const t=e/this.firstRatio;this.goalScale=t<1.3&&t>.7692307692307692?1:t}}else if(2!==s.length)if(this.isRotating){const e=1.5*this.inputSource.gamepad.axes[0];this.goalYaw+=e-this.lastAngle,this.lastAngle=e}else this.isTranslating&&s.forEach((e=>{if(e.inputSource!==this.inputSource)return;let t=null;if(e.results.length>0&&(t=this.getHitPoint(e.results[0])),null==t&&(t=this.getTouchLocation()),null!=t){if(this.goalPosition.sub(this.lastDragPosition),!1===this.placeOnWall){const e=t.y-this.lastDragPosition.y;if(e<0){this.placementBox.offsetHeight=e/n,this.presentedScene.setShadowOffset(e);const s=qa.copy(i.getCamera().position),r=-e/(s.y-t.y);s.multiplyScalar(r),t.multiplyScalar(1-r).add(s)}}this.goalPosition.add(t),this.lastDragPosition.copy(t)}}));else{this.isTranslating=!1,this.isRotating=!1,this.isTwoFingering=!0;const{separation:e}=this.fingerPolar(s);this.firstRatio=e/n}}moveScene(e){const t=this.presentedScene,{position:s,yaw:i}=t,n=t.boundingSphere.radius,r=this.goalPosition,o=t.scale.x,a=this.placementBox;let A=ka.NONE;if(!r.equals(s)||this.goalScale!==o){A=ka.USER_INTERACTION;let{x:i,y:l,z:h}=s;i=this.xDamper.update(i,r.x,e,n),l=this.yDamper.update(l,r.y,e,n),h=this.zDamper.update(h,r.z,e,n),s.set(i,l,h);const c=this.scaleDamper.update(o,this.goalScale,e,1);if(t.scale.set(c,c,c),!this.isTranslating){const e=r.y-l;this.placementComplete&&!1===this.placeOnWall?(a.offsetHeight=e/c,t.setShadowOffset(e)):0===e&&(this.placementComplete=!0,a.show=!1,t.setShadowIntensity(.8))}}a.updateOpacity(e),t.updateTarget(e),t.yaw=this.yawDamper.update(i,this.goalYaw,e,Math.PI),t.element.dispatchEvent(new CustomEvent("camera-change",{detail:{source:A}}))}onWebXRFrame(e,t){this.frame=t,++this.frames;const s=this.threeRenderer.xr.getReferenceSpace(),i=t.getViewerPose(s);null==i&&!0===this.tracking&&this.frames>30&&(this.tracking=!1,this.dispatchEvent({type:"tracking",status:Ha}));const n=this.presentedScene;if(null==i||null==n||!n.element.loaded)return void this.threeRenderer.clear();!1===this.tracking&&(this.tracking=!0,this.dispatchEvent({type:"tracking",status:Oa}));let r=!0;for(const s of i.views){if(this.updateView(s),r){this.moveToFloor(t),this.processInput(t);const s=e-this.lastTick;this.moveScene(s),this.renderer.preRender(n,e,s),this.lastTick=e,n.renderShadow(this.threeRenderer)}this.threeRenderer.render(n,n.getCamera()),r=!1}}}
/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class za{constructor(e){e.threeRenderer.debug={checkShaderErrors:!0},Promise.resolve().then((()=>{self.dispatchEvent(new CustomEvent("model-viewer-renderer-debug",{detail:{renderer:e,THREE:{ShaderMaterial:ye,Texture:u,Mesh:ae,Scene:Qe,PlaneGeometry:f,OrthographicCamera:de,WebGLRenderTarget:ve}}}))}))}addScene(e){self.dispatchEvent(new CustomEvent("model-viewer-scene-added-debug",{detail:{scene:e}}))}removeScene(e){self.dispatchEvent(new CustomEvent("model-viewer-scene-removed-debug",{detail:{scene:e}}))}}function ja(e){const t=new Map,s=new Map,i=e.clone();return $a(e,i,(function(e,i){t.set(i,e),s.set(e,i)})),i.traverse((function(e){if(!e.isSkinnedMesh)return;const i=e,n=t.get(e),r=n.skeleton.bones;i.skeleton=n.skeleton.clone(),i.bindMatrix.copy(n.bindMatrix),i.skeleton.bones=r.map((function(e){return s.get(e)})),i.bind(i.skeleton,i.bindMatrix)})),i}function $a(e,t,s){s(e,t);for(let i=0;i<e.children.length;i++)$a(e.children[i],t.children[i],s)}
/* @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wa=Symbol("prepared"),Xa=Symbol("prepare"),Za=Symbol("preparedGLTF"),eA=Symbol("clone");class tA{constructor(e){this[Za]=e}static prepare(e){if(null==e.scene)throw new Error("Model does not have a scene");if(e[Wa])return e;const t=this[Xa](e);return t[Wa]=!0,t}static[Xa](e){const{scene:t}=e,s=[t];return Object.assign(Object.assign({},e),{scene:t,scenes:s})}get parser(){return this[Za].parser}get animations(){return this[Za].animations}get scene(){return this[Za].scene}get scenes(){return this[Za].scenes}get cameras(){return this[Za].cameras}get asset(){return this[Za].asset}get userData(){return this[Za].userData}clone(){return new(0,this.constructor)(this[eA]())}dispose(){this.scenes.forEach((e=>{e.traverse((e=>{if(!e.isMesh)return;const t=e;(Array.isArray(t.material)?t.material:[t.material]).forEach((e=>{for(const t in e){const s=e[t];if(s instanceof u){const e=s.source.data;null!=e.close&&e.close(),s.dispose()}}e.dispose()})),t.geometry.dispose()}))}))}[eA](){const e=this[Za],t=ja(this.scene);sA(t,this.scene);const s=[t],i=e.userData?Object.assign({},e.userData):{};return Object.assign(Object.assign({},e),{scene:t,scenes:s,userData:i})}}const sA=(e,t)=>{iA(e,t,((e,t)=>{void 0!==t.userData.variantMaterials&&(e.userData.variantMaterials=new Map(t.userData.variantMaterials)),void 0!==t.userData.variantData&&(e.userData.variantData=t.userData.variantData),void 0!==t.userData.originalMaterial&&(e.userData.originalMaterial=t.userData.originalMaterial)}))},iA=(e,t,s)=>{s(e,t);for(let i=0;i<e.children.length;i++)iA(e.children[i],t.children[i],s)},nA=Symbol("threeGLTF"),rA=Symbol("gltf"),oA=Symbol("gltfElementMap"),aA=Symbol("threeObjectMap"),AA=Symbol("parallelTraverseThreeScene"),lA=Symbol("correlateOriginalThreeGLTF"),hA=Symbol("correlateCloneThreeGLTF");class cA{constructor(e,t,s,i){this[nA]=e,this[rA]=t,this[oA]=i,this[aA]=s}static from(e,t){return null!=t?this[hA](e,t):this[lA](e)}static[lA](e){const t=e.parser.json,s=e.parser.associations,i=new Map,n={name:"Default"},r={type:"materials",index:-1};for(const e of s.keys())e instanceof te&&null==s.get(e)&&(r.index<0&&(null==t.materials&&(t.materials=[]),r.index=t.materials.length,t.materials.push(n)),e.name=n.name,s.set(e,{materials:r.index}));for(const[e,n]of s){if(n){const t=e;t.userData=t.userData||{},t.userData.associations=n}for(const s in n)if(null!=s&&"primitives"!==s){const r=s,o=(t[r]||[])[n[r]];if(null==o)continue;let a=i.get(o);null==a&&(a=new Set,i.set(o,a)),a.add(e)}}return new cA(e,t,s,i)}static[hA](e,t){const s=t.threeGLTF,i=t.gltf,n=JSON.parse(JSON.stringify(i)),r=new Map,o=new Map;for(let i=0;i<s.scenes.length;i++)this[AA](s.scenes[i],e.scenes[i],((e,s)=>{const i=t.threeObjectMap.get(e);if(null!=i)for(const e in i)if(null!=e&&"primitives"!==e){const t=e,a=i[t],A=n[t][a],l=r.get(s)||{};l[t]=a,r.set(s,l);const h=o.get(A)||new Set;h.add(s),o.set(A,h)}}));return new cA(e,n,r,o)}static[AA](e,t,s){const i=(e,t)=>{if(s(e,t),e.isObject3D){if(e.isMesh)if(Array.isArray(e.material))for(let s=0;s<e.material.length;++s)i(e.material[s],t.material[s]);else i(e.material,t.material);for(let s=0;s<e.children.length;++s)i(e.children[s],t.children[s])}};i(e,t)}get threeGLTF(){return this[nA]}get gltf(){return this[rA]}get gltfElementMap(){return this[oA]}get threeObjectMap(){return this[aA]}}
/* @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uA=Symbol("correlatedSceneGraph");class gA extends tA{static[Xa](e){const t=super[Xa](e);null==t[uA]&&(t[uA]=cA.from(t));const{scene:s}=t,i=new be(void 0,1/0);return s.traverse((e=>{e.renderOrder=1e3,e.frustumCulled=!1,e.name||(e.name=e.uuid);const s=e;if(s.isMesh){const{geometry:e}=s;s.castShadow=!0,s.isSkinnedMesh&&(e.boundingSphere=i,e.boundingBox=null);const n=s.material;if(!0===n.isMeshBasicMaterial&&(n.toneMapped=!1),n.shadowSide=Se,n.aoMap){const{gltf:s,threeObjectMap:i}=t[uA],r=i.get(n);if(null!=s.materials&&null!=r&&null!=r.materials){const t=s.materials[r.materials];t.occlusionTexture&&0===t.occlusionTexture.texCoord&&null!=e.attributes.uv&&e.setAttribute("uv2",e.attributes.uv)}}}})),t}get correlatedSceneGraph(){return this[Za][uA]}[eA](){const e=super[eA](),t=new Map;return e.scene.traverse((e=>{if(e.isMesh){const s=e,i=s.material;if(null!=i){if(t.has(i.uuid))return void(s.material=t.get(i.uuid));s.material=i.clone(),t.set(i.uuid,s.material)}}})),e[uA]=cA.from(e,this.correlatedSceneGraph),e}}class dA extends it{constructor(e){super(e),this.type=U}parse(e){const t=function(e,t){switch(e){case 1:console.error("THREE.RGBELoader Read Error: "+(t||""));break;case 2:console.error("THREE.RGBELoader Write Error: "+(t||""));break;case 3:console.error("THREE.RGBELoader Bad File Format: "+(t||""));break;default:console.error("THREE.RGBELoader: Error: "+(t||""))}return-1},s=function(e,t,s){t=t||1024;let i=e.pos,n=-1,r=0,o="",a=String.fromCharCode.apply(null,new Uint16Array(e.subarray(i,i+128)));for(;0>(n=a.indexOf("\n"))&&r<t&&i<e.byteLength;)o+=a,r+=a.length,i+=128,a+=String.fromCharCode.apply(null,new Uint16Array(e.subarray(i,i+128)));return-1<n&&(!1!==s&&(e.pos+=r+n+1),o+a.slice(0,n))},i=function(e,t,s,i){const n=e[t+3],r=Math.pow(2,n-128)/255;s[i+0]=e[t+0]*r,s[i+1]=e[t+1]*r,s[i+2]=e[t+2]*r,s[i+3]=1},n=function(e,t,s,i){const n=e[t+3],r=Math.pow(2,n-128)/255;s[i+0]=at.toHalfFloat(Math.min(e[t+0]*r,65504)),s[i+1]=at.toHalfFloat(Math.min(e[t+1]*r,65504)),s[i+2]=at.toHalfFloat(Math.min(e[t+2]*r,65504)),s[i+3]=at.toHalfFloat(1)},r=new Uint8Array(e);r.pos=0;const o=function(e){const i=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,n=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,r=/^\s*FORMAT=(\S+)\s*$/,o=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,a={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let A,l;if(e.pos>=e.byteLength||!(A=s(e)))return t(1,"no header found");if(!(l=A.match(/^#\?(\S+)/)))return t(3,"bad initial token");for(a.valid|=1,a.programtype=l[1],a.string+=A+"\n";A=s(e),!1!==A;)if(a.string+=A+"\n","#"!==A.charAt(0)){if((l=A.match(i))&&(a.gamma=parseFloat(l[1])),(l=A.match(n))&&(a.exposure=parseFloat(l[1])),(l=A.match(r))&&(a.valid|=2,a.format=l[1]),(l=A.match(o))&&(a.valid|=4,a.height=parseInt(l[1],10),a.width=parseInt(l[2],10)),2&a.valid&&4&a.valid)break}else a.comments+=A+"\n";return 2&a.valid?4&a.valid?a:t(3,"missing image size specifier"):t(3,"missing format specifier")}(r);if(-1!==o){const e=o.width,s=o.height,a=function(e,s,i){const n=s;if(n<8||n>32767||2!==e[0]||2!==e[1]||128&e[2])return new Uint8Array(e);if(n!==(e[2]<<8|e[3]))return t(3,"wrong scanline width");const r=new Uint8Array(4*s*i);if(!r.length)return t(4,"unable to allocate buffer space");let o=0,a=0;const A=4*n,l=new Uint8Array(4),h=new Uint8Array(A);let c=i;for(;c>0&&a<e.byteLength;){if(a+4>e.byteLength)return t(1);if(l[0]=e[a++],l[1]=e[a++],l[2]=e[a++],l[3]=e[a++],2!=l[0]||2!=l[1]||(l[2]<<8|l[3])!=n)return t(3,"bad rgbe scanline format");let s,i=0;for(;i<A&&a<e.byteLength;){s=e[a++];const n=s>128;if(n&&(s-=128),0===s||i+s>A)return t(3,"bad scanline data");if(n){const t=e[a++];for(let e=0;e<s;e++)h[i++]=t}else h.set(e.subarray(a,a+s),i),i+=s,a+=s}const u=n;for(let e=0;e<u;e++){let t=0;r[o]=h[e+t],t+=n,r[o+1]=h[e+t],t+=n,r[o+2]=h[e+t],t+=n,r[o+3]=h[e+t],o+=4}c--}return r}(r.subarray(r.pos),e,s);if(-1!==a){let t,r,A;switch(this.type){case k:A=a.length/4;const e=new Float32Array(4*A);for(let t=0;t<A;t++)i(a,4*t,e,4*t);t=e,r=k;break;case U:A=a.length/4;const s=new Uint16Array(4*A);for(let e=0;e<A;e++)n(a,4*e,s,4*e);t=s,r=U;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type)}return{width:e,height:s,data:t,header:o.string,gamma:o.gamma,exposure:o.exposure,type:r}}}return null}setDataType(e){return this.type=e,this}load(e,t,s,i){return super.load(e,(function(e,s){switch(e.type){case k:case U:e.encoding=F,e.minFilter=R,e.magFilter=R,e.generateMipmaps=!1,e.flipY=!0}t&&t(e,s)}),s,i)}}
/* @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pA extends Qe{constructor(){super(),this.position.y=-3.5;const e=new Te;e.deleteAttribute("uv");const t=new ie({metalness:0,side:Fe}),s=new ie({metalness:0}),i=new V(16777215,500,28,2);i.position.set(.418,16.199,.3),this.add(i);const n=new ae(e,t);n.position.set(-.757,13.219,.717),n.scale.set(31.713,28.305,28.591),this.add(n);const r=new ae(e,s);r.position.set(-10.906,2.009,1.846),r.rotation.set(0,-.195,0),r.scale.set(2.328,7.905,4.651),this.add(r);const o=new ae(e,s);o.position.set(-5.607,-.754,-.758),o.rotation.set(0,.994,0),o.scale.set(1.97,1.534,3.955),this.add(o);const a=new ae(e,s);a.position.set(6.167,.857,7.803),a.rotation.set(0,.561,0),a.scale.set(3.927,6.285,3.687),this.add(a);const A=new ae(e,s);A.position.set(-2.017,.018,6.124),A.rotation.set(0,.333,0),A.scale.set(2.002,4.566,2.064),this.add(A);const l=new ae(e,s);l.position.set(2.291,-.756,-2.621),l.rotation.set(0,-.286,0),l.scale.set(1.546,1.552,1.496),this.add(l);const h=new ae(e,s);h.position.set(-2.193,-.369,-5.547),h.rotation.set(0,.516,0),h.scale.set(3.875,3.487,2.986),this.add(h);const c=new ae(e,this.createAreaLightMaterial(50));c.position.set(-16.116,14.37,8.208),c.scale.set(.1,2.428,2.739),this.add(c);const u=new ae(e,this.createAreaLightMaterial(50));u.position.set(-16.109,18.021,-8.207),u.scale.set(.1,2.425,2.751),this.add(u);const g=new ae(e,this.createAreaLightMaterial(17));g.position.set(14.904,12.198,-1.832),g.scale.set(.15,4.265,6.331),this.add(g);const d=new ae(e,this.createAreaLightMaterial(43));d.position.set(-.462,8.89,14.52),d.scale.set(4.38,5.441,.088),this.add(d);const p=new ae(e,this.createAreaLightMaterial(20));p.position.set(3.235,11.486,-12.541),p.scale.set(2.5,2,.1),this.add(p);const m=new ae(e,this.createAreaLightMaterial(100));m.position.set(0,20,0),m.scale.set(1,.1,1),this.add(m)}createAreaLightMaterial(e){const t=new I;return t.color.setScalar(e),t}}
/* @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mA extends Qe{constructor(){super(),this.position.y=-3.5;const e=new Te;e.deleteAttribute("uv");const t=new ie({metalness:0,side:Fe}),s=new ie({metalness:0}),i=new V(16777215,400,28,2);i.position.set(.5,14,.5),this.add(i);const n=new ae(e,t);n.position.set(0,13.2,0),n.scale.set(31.5,28.5,31.5),this.add(n);const r=new ae(e,s);r.position.set(-10.906,-1,1.846),r.rotation.set(0,-.195,0),r.scale.set(2.328,7.905,4.651),this.add(r);const o=new ae(e,s);o.position.set(-5.607,-.754,-.758),o.rotation.set(0,.994,0),o.scale.set(1.97,1.534,3.955),this.add(o);const a=new ae(e,s);a.position.set(6.167,-.16,7.803),a.rotation.set(0,.561,0),a.scale.set(3.927,6.285,3.687),this.add(a);const A=new ae(e,s);A.position.set(-2.017,.018,6.124),A.rotation.set(0,.333,0),A.scale.set(2.002,4.566,2.064),this.add(A);const l=new ae(e,s);l.position.set(2.291,-.756,-2.621),l.rotation.set(0,-.286,0),l.scale.set(1.546,1.552,1.496),this.add(l);const h=new ae(e,s);h.position.set(-2.193,-.369,-5.547),h.rotation.set(0,.516,0),h.scale.set(3.875,3.487,2.986),this.add(h);const c=new ae(e,this.createAreaLightMaterial(80));c.position.set(-14,10,8),c.scale.set(.1,2.5,2.5),this.add(c);const u=new ae(e,this.createAreaLightMaterial(80));u.position.set(-14,14,-4),u.scale.set(.1,2.5,2.5),this.add(u);const g=new ae(e,this.createAreaLightMaterial(23));g.position.set(14,12,0),g.scale.set(.1,5,5),this.add(g);const d=new ae(e,this.createAreaLightMaterial(16));d.position.set(0,9,14),d.scale.set(5,5,.1),this.add(d);const p=new ae(e,this.createAreaLightMaterial(80));p.position.set(7,8,-14),p.scale.set(2.5,2.5,.1),this.add(p);const m=new ae(e,this.createAreaLightMaterial(80));m.position.set(-7,16,-14),m.scale.set(2.5,2.5,.1),this.add(m);const I=new ae(e,this.createAreaLightMaterial(1));I.position.set(0,20,0),I.scale.set(.1,.1,.1),this.add(I)}createAreaLightMaterial(e){const t=new I;return t.color.setScalar(e),t}}
/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IA=20,fA=/\.hdr(\.js)?$/;class CA extends G{constructor(e){super(),this.threeRenderer=e,this.lottieLoaderUrl="",this.withCredentials=!1,this._ldrLoader=null,this._hdrLoader=null,this._lottieLoader=null,this.generatedEnvironmentMap=null,this.generatedEnvironmentMapAlt=null,this.skyboxCache=new Map,this.blurMaterial=null,this.blurScene=null}get ldrLoader(){return null==this._ldrLoader&&(this._ldrLoader=new j),this._ldrLoader.setWithCredentials(this.withCredentials),this._ldrLoader}get hdrLoader(){return null==this._hdrLoader&&(this._hdrLoader=new dA,this._hdrLoader.setDataType(U)),this._hdrLoader.setWithCredentials(this.withCredentials),this._hdrLoader}async getLottieLoader(){if(null==this._lottieLoader){const{LottieLoader:e}=await import(this.lottieLoaderUrl);this._lottieLoader=new e}return this._lottieLoader.setWithCredentials(this.withCredentials),this._lottieLoader}async loadImage(e){const t=await new Promise(((t,s)=>this.ldrLoader.load(e,t,(()=>{}),s)));return t.name=e,t.flipY=!1,t}async loadLottie(e,t){const s=await this.getLottieLoader();s.setQuality(t);const i=await new Promise(((t,i)=>s.load(e,t,(()=>{}),i)));return i.name=e,i}async loadEquirect(e,t=(()=>{})){try{const s=fA.test(e),i=s?this.hdrLoader:this.ldrLoader,n=await new Promise(((s,n)=>i.load(e,s,(e=>{t(e.loaded/e.total*.9)}),n)));return t(1),n.name=e,n.mapping=xe,s||(n.encoding=L),n}finally{t&&t(1)}}async generateEnvironmentMapAndSkybox(e=null,t=null,s=(()=>{})){const i="legacy"!==t;"legacy"!==t&&"neutral"!==t||(t=null),t=Qs(t);let n,r=Promise.resolve(null);e&&(r=this.loadEquirectFromUrl(e,s)),n=t?this.loadEquirectFromUrl(t,s):e?this.loadEquirectFromUrl(e,s):i?this.loadGeneratedEnvironmentMapAlt():this.loadGeneratedEnvironmentMap();const[o,a]=await Promise.all([n,r]);if(null==o)throw new Error("Failed to load environment map.");return{environmentMap:o,skybox:a}}async loadEquirectFromUrl(e,t){if(!this.skyboxCache.has(e)){const s=this.loadEquirect(e,t);this.skyboxCache.set(e,s)}return this.skyboxCache.get(e)}async GenerateEnvironmentMap(e,t){await((e=0)=>new Promise((t=>setTimeout(t,e))))();const i=this.threeRenderer,n=new Me(256,{generateMipmaps:!1,type:U,format:s,encoding:F,depthBuffer:!0}),r=new De(.1,100,n),o=r.renderTarget.texture;o.name=t;const a=i.outputEncoding,A=i.toneMapping;return i.toneMapping=Re,i.outputEncoding=F,r.update(i,e),this.blurCubemap(n,.04),i.toneMapping=A,i.outputEncoding=a,o}async loadGeneratedEnvironmentMap(){return null==this.generatedEnvironmentMap&&(this.generatedEnvironmentMap=this.GenerateEnvironmentMap(new pA,"legacy")),this.generatedEnvironmentMap}async loadGeneratedEnvironmentMapAlt(){return null==this.generatedEnvironmentMapAlt&&(this.generatedEnvironmentMapAlt=this.GenerateEnvironmentMap(new mA,"neutral")),this.generatedEnvironmentMapAlt}blurCubemap(e,t){if(null==this.blurMaterial){this.blurMaterial=this.getBlurShader(IA);const e=new Te,t=new ae(e,this.blurMaterial);this.blurScene=new Qe,this.blurScene.add(t)}const s=e.clone();this.halfblur(e,s,t,"latitudinal"),this.halfblur(s,e,t,"longitudinal")}halfblur(e,t,s,i){const n=e.width,r=isFinite(s)?Math.PI/(2*n):2*Math.PI/39,o=s/r,a=isFinite(s)?1+Math.floor(3*o):IA;a>IA&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${a} samples when the maximum is set to 20`);const A=[];let l=0;for(let e=0;e<IA;++e){const t=e/o,s=Math.exp(-t*t/2);A.push(s),0==e?l+=s:e<a&&(l+=2*s)}for(let e=0;e<A.length;e++)A[e]=A[e]/l;const h=this.blurMaterial.uniforms;h.envMap.value=e.texture,h.samples.value=a,h.weights.value=A,h.latitudinal.value="latitudinal"===i,h.dTheta.value=r;new De(.1,100,t).update(this.threeRenderer,this.blurScene)}getBlurShader(e){const t=new Float32Array(e),s=new g(0,1,0);return new ye({name:"SphericalGaussianBlur",defines:{n:e},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:t},latitudinal:{value:!1},dTheta:{value:0},poleAxis:{value:s}},vertexShader:"\n      \n      varying vec3 vOutputDirection;\n  \n      void main() {\n  \n        vOutputDirection = vec3( position );\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n  \n      }\n    ",fragmentShader:"\n        varying vec3 vOutputDirection;\n  \n        uniform samplerCube envMap;\n        uniform int samples;\n        uniform float weights[ n ];\n        uniform bool latitudinal;\n        uniform float dTheta;\n        uniform vec3 poleAxis;\n  \n        vec3 getSample( float theta, vec3 axis ) {\n  \n          float cosTheta = cos( theta );\n          // Rodrigues' axis-angle rotation\n          vec3 sampleDirection = vOutputDirection * cosTheta\n            + cross( axis, vOutputDirection ) * sin( theta )\n            + axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n  \n          return vec3( textureCube( envMap, sampleDirection ) );\n  \n        }\n  \n        void main() {\n  \n          vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n  \n          if ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n  \n            axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n  \n          }\n  \n          axis = normalize( axis );\n  \n          gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n          gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n  \n          for ( int i = 1; i < n; i++ ) {\n  \n            if ( i >= samples ) {\n  \n              break;\n  \n            }\n  \n            float theta = dTheta * float( i );\n            gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n            gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n  \n          }\n        }\n      ",blending:Le,depthTest:!1,depthWrite:!1,side:Fe})}async dispose(){for(const[,e]of this.skyboxCache){(await e).dispose()}null!=this.generatedEnvironmentMap&&((await this.generatedEnvironmentMap).dispose(),this.generatedEnvironmentMap=null),null!=this.generatedEnvironmentMapAlt&&((await this.generatedEnvironmentMapAlt).dispose(),this.generatedEnvironmentMapAlt=null),null!=this.blurMaterial&&this.blurMaterial.dispose()}}
/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EA=[1,.79,.62,.5,.4,.31,.25],BA="high-performance";class wA extends G{constructor(e){super(),this.loader=new vn(gA),this.width=0,this.height=0,this.dpr=1,this.debugger=null,this.scenes=new Set,this.multipleScenesVisible=!1,this.lastTick=performance.now(),this.renderedLastFrame=!1,this.scaleStep=0,this.lastStep=3,this.avgFrameDuration=50,this.onWebGLContextLost=e=>{this.dispatchEvent({type:"contextlost",sourceEvent:e})},this.onWebGLContextRestored=()=>{var e;null===(e=this.textureUtils)||void 0===e||e.dispose(),this.textureUtils=new CA(this.threeRenderer);for(const e of this.scenes)e.element[Fs]()},this.dpr=Ms(),this.canvas3D=document.createElement("canvas"),this.canvas3D.id="webgl-canvas",this.canvas3D.classList.add("show");try{this.threeRenderer=new P({canvas:this.canvas3D,alpha:!0,antialias:!0,powerPreference:e.powerPreference,preserveDrawingBuffer:!0}),this.threeRenderer.autoClear=!0,this.threeRenderer.outputEncoding=L,this.threeRenderer.physicallyCorrectLights=!0,this.threeRenderer.setPixelRatio(1),this.debugger=e.debug?new za(this):null,this.threeRenderer.debug={checkShaderErrors:!!this.debugger},this.threeRenderer.toneMapping=O}catch(e){console.warn(e)}this.arRenderer=new Ya(this),this.textureUtils=this.canRender?new CA(this.threeRenderer):null,vn.initializeKTX2Loader(this.threeRenderer),this.canvas3D.addEventListener("webglcontextlost",this.onWebGLContextLost),this.canvas3D.addEventListener("webglcontextrestored",this.onWebGLContextRestored),this.updateRendererSize()}static get singleton(){return this._singleton}static resetSingleton(){const e=this._singleton.dispose();for(const t of e)t.disconnectedCallback();this._singleton=new wA({powerPreference:(self.ModelViewerElement||{}).powerPreference||BA,debug:Ds()});for(const t of e)t.connectedCallback()}get canRender(){return null!=this.threeRenderer}get scaleFactor(){return EA[this.scaleStep]}set minScale(e){let t=1;for(;t<EA.length&&!(EA[t]<e);)++t;this.lastStep=t-1}registerScene(e){this.scenes.add(e),e.forceRescale();const t=new p;this.threeRenderer.getSize(t),e.canvas.width=t.x,e.canvas.height=t.y,this.canRender&&this.scenes.size>0&&this.threeRenderer.setAnimationLoop(((e,t)=>this.render(e,t))),null!=this.debugger&&this.debugger.addScene(e)}unregisterScene(e){this.scenes.delete(e),this.canvas3D.parentElement===e.canvas.parentElement&&e.canvas.parentElement.removeChild(this.canvas3D),this.canRender&&0===this.scenes.size&&this.threeRenderer.setAnimationLoop(null),null!=this.debugger&&this.debugger.removeScene(e)}displayCanvas(e){return this.multipleScenesVisible?e.element[tc]:this.canvas3D}countVisibleScenes(){const{canvas3D:e}=this;let t=0,s=null;for(const i of this.scenes){const{element:n}=i;n.modelIsVisible&&null==i.externalRenderer&&++t,e.parentElement===i.canvas.parentElement&&(s=i)}const i=t>1;if(null!=s){const t=i&&!this.multipleScenesVisible,n=!s.element.modelIsVisible;if(t||n){const{width:t,height:i}=this.sceneSize(s);this.copyPixels(s,t,i),e.parentElement.removeChild(e)}}this.multipleScenesVisible=i}updateRendererSize(){var e;const t=Ms();if(t!==this.dpr)for(const e of this.scenes){const{element:t}=e;t[Hh](t.getBoundingClientRect())}let s=0,i=0;for(const e of this.scenes)s=Math.max(s,e.width),i=Math.max(i,e.height);if(s!==this.width||i!==this.height||t!==this.dpr){this.width=s,this.height=i,this.dpr=t,s=Math.ceil(s*t),i=Math.ceil(i*t),this.canRender&&this.threeRenderer.setSize(s,i,!1);for(const t of this.scenes){const{canvas:n}=t;n.width=s,n.height=i,t.forceRescale(),null===(e=t.effectRenderer)||void 0===e||e.setSize(s,i)}}}updateRendererScale(e){const t=this.scaleStep;this.avgFrameDuration+=xs(.2*(e-this.avgFrameDuration),-5,5),this.avgFrameDuration>60?++this.scaleStep:this.avgFrameDuration<40&&this.scaleStep>0&&--this.scaleStep,this.scaleStep=Math.min(this.scaleStep,this.lastStep),t!==this.scaleStep&&(this.avgFrameDuration=50)}shouldRender(e){if(e.shouldRender())e.scaleStep!=this.scaleStep&&(e.scaleStep=this.scaleStep,this.rescaleCanvas(e));else{if(0==e.scaleStep)return!1;e.scaleStep=0,this.rescaleCanvas(e)}return!0}rescaleCanvas(e){const t=EA[e.scaleStep],s=Math.ceil(this.width/t),i=Math.ceil(this.height/t),{style:n}=e.canvas;n.width=`${s}px`,n.height=`${i}px`,this.canvas3D.style.width=`${s}px`,this.canvas3D.style.height=`${i}px`;const r=this.dpr*t,o=t<1?"GPU throttling":this.dpr!==window.devicePixelRatio?"No meta viewport tag":"";e.element.dispatchEvent(new CustomEvent("render-scale",{detail:{reportedDpr:window.devicePixelRatio,renderedDpr:r,minimumDpr:this.dpr*EA[this.lastStep],pixelWidth:Math.ceil(e.width*r),pixelHeight:Math.ceil(e.height*r),reason:o}}))}sceneSize(e){const{dpr:t}=this,s=EA[e.scaleStep];return{width:Math.min(Math.ceil(e.width*s*t),this.canvas3D.width),height:Math.min(Math.ceil(e.height*s*t),this.canvas3D.height)}}copyPixels(e,t,s){const i=e.context;null!=i?(i.clearRect(0,0,t,s),i.drawImage(this.canvas3D,0,0,t,s,0,0,t,s),e.canvas.classList.add("show")):console.log("could not acquire 2d context")}orderedScenes(){const e=[];for(const t of[!1,!0])for(const s of this.scenes)s.element.modelIsVisible===t&&e.push(s);return e}get isPresenting(){return this.arRenderer.isPresenting}preRender(e,t,s){const{element:i,exposure:n}=e;i[nc](t,s);const r="number"==typeof n&&!Number.isNaN(n);this.threeRenderer.toneMappingExposure=r?n:1}render(e,t){if(null!=t)return void this.arRenderer.onWebXRFrame(e,t);const s=e-this.lastTick;if(this.lastTick=e,!this.canRender||this.isPresenting)return;this.countVisibleScenes(),this.updateRendererSize(),this.renderedLastFrame&&(this.updateRendererScale(s),this.renderedLastFrame=!1);const{canvas3D:i}=this;for(const t of this.orderedScenes()){const{element:n}=t;if(!n.loaded||!n.modelIsVisible&&t.renderCount>0)continue;if(this.preRender(t,e,s),!this.shouldRender(t))continue;if(null!=t.externalRenderer){const e=t.getCamera();e.updateMatrix();const{matrix:s,projectionMatrix:i}=e,n=s.elements.slice(),r=t.getTarget();n[12]+=r.x,n[13]+=r.y,n[14]+=r.z,t.externalRenderer.render({viewMatrix:n,projectionMatrix:i.elements});continue}if(!n.modelIsVisible&&!this.multipleScenesVisible)for(const e of this.scenes)e.element.modelIsVisible&&e.queueRender();const{width:r,height:o}=this.sceneSize(t);t.renderShadow(this.threeRenderer),this.threeRenderer.setRenderTarget(null),this.threeRenderer.setViewport(0,Math.ceil(this.height*this.dpr)-o,r,o),null!=t.effectRenderer?(this.threeRenderer.autoClear=!1,t.effectRenderer.render(s),this.threeRenderer.autoClear=!0):(this.threeRenderer.autoClear=!0,this.threeRenderer.render(t,t.camera)),this.multipleScenesVisible||!t.element.modelIsVisible&&0===t.renderCount?this.copyPixels(t,r,o):i.parentElement!==t.canvas.parentElement&&(t.canvas.parentElement.appendChild(i),t.canvas.classList.remove("show")),t.hasRendered(),++t.renderCount,this.renderedLastFrame=!0}}dispose(){null!=this.textureUtils&&this.textureUtils.dispose(),null!=this.threeRenderer&&this.threeRenderer.dispose(),this.textureUtils=null,this.threeRenderer=null;const e=[];for(const t of this.scenes)e.push(t.element);return this.canvas3D.removeEventListener("webglcontextlost",this.onWebGLContextLost),this.canvas3D.removeEventListener("webglcontextrestored",this.onWebGLContextRestored),e}}wA._singleton=new wA({powerPreference:(self.ModelViewerElement||{}).powerPreference||BA,debug:Ds()});
/* @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const yA=Symbol("correlatedObjects"),QA=Symbol("sourceObject"),vA=Symbol("onUpdate");class bA{constructor(e,t,s=null){this[vA]=e,this[QA]=t,this[yA]=s}}
/* @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SA=new I,xA=new f(2,2);let MA=0;const DA=Symbol("threeTexture");class RA extends bA{get[DA](){var e;return console.assert(null!=this[yA]&&this[yA].size>0,"Image correlated object is undefined"),null===(e=this[yA])||void 0===e?void 0:e.values().next().value}constructor(e,t,s){super(e,s=null!=s?s:{name:t&&t.image&&t.image.src?t.image.src.split("/").pop():"adhoc_image",uri:t&&t.image&&t.image.src?t.image.src:"adhoc_image"+MA++},new Set(t?[t]:[]))}get name(){return this[QA].name||""}get uri(){return this[QA].uri}get bufferView(){return this[QA].bufferView}get element(){const e=this[DA];if(e&&(e.isCanvasTexture||e.isVideoTexture))return e.image}get animation(){const e=this[DA];if(e&&e.isCanvasTexture&&e.animation)return e.animation}get type(){return null!=this.uri?"external":"embedded"}set name(e){this[QA].name=e}update(){const e=this[DA];e&&e.isCanvasTexture&&!e.animation&&(this[DA].needsUpdate=!0,this[vA]())}async createThumbnail(e,t){const s=new Qe;SA.map=this[DA];const i=new ae(xA,SA);s.add(i);const n=new de(-1,1,1,-1,0,1),{threeRenderer:r}=wA.singleton,o=new ve(e,t);r.setRenderTarget(o),r.render(s,n),r.setRenderTarget(null);const a=new Uint8Array(e*t*4);r.readRenderTargetPixels(o,0,0,e,t,a),Th.width=e,Th.height=t;const A=Th.getContext("2d"),l=A.createImageData(e,t);return l.data.set(a),A.putImageData(l,0,0),new Promise((async(e,t)=>{Th.toBlob((s=>{if(!s)return t("Failed to capture thumbnail.");e(URL.createObjectURL(s))}),"image/png")}))}}var TA,LA;!function(e){e[e.Nearest=9728]="Nearest",e[e.Linear=9729]="Linear",e[e.NearestMipmapNearest=9984]="NearestMipmapNearest",e[e.LinearMipmapNearest=9985]="LinearMipmapNearest",e[e.NearestMipmapLinear=9986]="NearestMipmapLinear",e[e.LinearMipmapLinear=9987]="LinearMipmapLinear"}(TA||(TA={})),function(e){e[e.ClampToEdge=33071]="ClampToEdge",e[e.MirroredRepeat=33648]="MirroredRepeat",e[e.Repeat=10497]="Repeat"}(LA||(LA={}));
/* @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const FA=(()=>{const e=[TA.Nearest,TA.Linear,TA.NearestMipmapNearest,TA.LinearMipmapLinear,TA.NearestMipmapLinear,TA.LinearMipmapLinear];return t=>e.indexOf(t)>-1})(),kA=(()=>{const e=[TA.Nearest,TA.Linear];return t=>e.indexOf(t)>-1})(),UA=(()=>{const e=[LA.ClampToEdge,LA.MirroredRepeat,LA.Repeat];return t=>e.indexOf(t)>-1})(),_A=Symbol("threeTextures"),NA=Symbol("setProperty"),GA=Symbol("sourceSampler");class PA extends bA{get[_A](){return console.assert(null!=this[yA]&&this[yA].size>0,"Sampler correlated object is undefined"),this[yA]}get[GA](){return console.assert(null!=this[QA],"Sampler source is undefined"),this[QA]}constructor(e,t,s){null==(s=null!=s?s:{}).minFilter&&(s.minFilter=t?t.minFilter:TA.LinearMipmapLinear),null==s.magFilter&&(s.magFilter=t?t.magFilter:TA.Linear),null==s.wrapS&&(s.wrapS=t?t.wrapS:LA.Repeat),null==s.wrapT&&(s.wrapT=t?t.wrapT:LA.Repeat),super(e,s,new Set(t?[t]:[]))}get name(){return this[QA].name||""}get minFilter(){return this[GA].minFilter}get magFilter(){return this[GA].magFilter}get wrapS(){return this[GA].wrapS}get wrapT(){return this[GA].wrapT}setMinFilter(e){this[NA]("minFilter",e)}setMagFilter(e){this[NA]("magFilter",e)}setWrapS(e){this[NA]("wrapS",e)}setWrapT(e){this[NA]("wrapT",e)}[NA](e,t){const s=this[GA];if(null!=s){if(((e,t)=>{switch(e){case"minFilter":return FA(t);case"magFilter":return kA(t);case"wrapS":case"wrapT":return UA(t);default:throw new Error(`Cannot configure property "${e}" on Sampler`)}})(e,t)){s[e]=t;for(const s of this[_A])s[e]=t,s.needsUpdate=!0}this[vA]()}}}
/* @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OA=Symbol("image"),HA=Symbol("sampler");class qA extends bA{constructor(e,t,s=null,i=null,n=null){super(e,s||{},new Set(t?[t]:[])),this[HA]=new PA(e,t,i),this[OA]=new RA(e,t,n)}get name(){return this[QA].name||""}set name(e){this[QA].name=e}get sampler(){return this[HA]}get source(){return this[OA]}}
/* @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var VA,JA,KA;const YA=Symbol("texture"),zA=Symbol("transform"),jA=Symbol("materials"),$A=Symbol("usage"),WA=Symbol("onUpdate"),XA=Symbol("activeVideo");var ZA;!function(e){e[e.Base=0]="Base",e[e.MetallicRoughness=1]="MetallicRoughness",e[e.Normal=2]="Normal",e[e.Occlusion=3]="Occlusion",e[e.Emissive=4]="Emissive"}(ZA||(ZA={}));class el{constructor(e,t,s,i,n,r){if(this[VA]=null,this[JA]={rotation:0,scale:new p(1,1),offset:new p(0,0)},this[KA]=!1,r&&s){const t=n.textures?n.textures[r.index]:null,i=t&&n.samplers?n.samplers[t.sampler]:null,o=t&&n.images?n.images[t.source]:null;this[zA].rotation=s.rotation,this[zA].scale.copy(s.repeat),this[zA].offset.copy(s.offset),this[YA]=new qA(e,s,t,i,o)}this[WA]=e,this[jA]=i,this[$A]=t}get texture(){return this[YA]}setTexture(e){var t,s;const i=null!=e?e.source[DA]:null,n=null===(t=this[YA])||void 0===t?void 0:t.source[DA];if(null!=n&&n.isVideoTexture?this[XA]=!1:(null===(s=this[YA])||void 0===s?void 0:s.source.animation)&&this[YA].source.animation.removeEventListener("enterFrame",this[WA]),this[YA]=e,null!=i&&i.isVideoTexture){const e=i.image;if(this[XA]=!0,null!=e.requestVideoFrameCallback){const t=()=>{this[XA]&&(this[WA](),e.requestVideoFrameCallback(t))};e.requestVideoFrameCallback(t)}else{const e=()=>{this[XA]&&(this[WA](),requestAnimationFrame(e))};requestAnimationFrame(e)}}else null!=(null==e?void 0:e.source.animation)&&e.source.animation.addEventListener("enterFrame",this[WA]);let r=L;if(this[jA])for(const e of this[jA]){switch(this[$A]){case ZA.Base:e.map=i;break;case ZA.MetallicRoughness:r=F,e.metalnessMap=i,e.roughnessMap=i;break;case ZA.Normal:r=F,e.normalMap=i;break;case ZA.Occlusion:r=F,e.aoMap=i;break;case ZA.Emissive:e.emissiveMap=i}e.needsUpdate=!0}i&&(i.encoding=r,i.rotation=this[zA].rotation,i.repeat=this[zA].scale,i.offset=this[zA].offset),this[WA]()}}VA=YA,JA=zA,KA=XA;
/* @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const tl=Symbol("threeMaterials"),sl=Symbol("baseColorTexture"),il=Symbol("metallicRoughnessTexture");class nl extends bA{constructor(e,t,s,i){super(e,s,i),null==s.baseColorFactor&&(s.baseColorFactor=[1,1,1,1]),null==s.roughnessFactor&&(s.roughnessFactor=1),null==s.metallicFactor&&(s.metallicFactor=1);const{baseColorTexture:n,metallicRoughnessTexture:r}=s,{map:o,metalnessMap:a}=i.values().next().value;this[sl]=new el(e,ZA.Base,o,i,t,n||null),this[il]=new el(e,ZA.MetallicRoughness,a,i,t,r||null)}get[tl](){return this[yA]}get baseColorFactor(){return this[QA].baseColorFactor}get metallicFactor(){return this[QA].metallicFactor}get roughnessFactor(){return this[QA].roughnessFactor}get baseColorTexture(){return this[sl]}get metallicRoughnessTexture(){return this[il]}setBaseColorFactor(e){const t=new d;e instanceof Array?t.fromArray(e):t.set(e).convertSRGBToLinear();for(const s of this[tl])s.color.set(t),e instanceof Array?s.opacity=e[3]:(e=[0,0,0,s.opacity],t.toArray(e));this[QA].baseColorFactor=e,this[vA]()}setMetallicFactor(e){for(const t of this[tl])t.metalness=e;this[QA].metallicFactor=e,this[vA]()}setRoughnessFactor(e){for(const t of this[tl])t.roughness=e;this[QA].roughnessFactor=e,this[vA]()}}
/* @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var rl;const ol=Symbol("pbrMetallicRoughness"),al=Symbol("normalTexture"),Al=Symbol("occlusionTexture"),ll=Symbol("emissiveTexture"),hl=Symbol("backingThreeMaterial"),cl=Symbol("applyAlphaCutoff"),ul=Symbol("lazyLoadGLTFInfo"),gl=Symbol("initialize"),dl=Symbol("getLoadedMaterial"),pl=Symbol("ensureMaterialIsLoaded"),ml=Symbol("gltfIndex"),Il=Symbol("setActive"),fl=Symbol("variantIndices"),Cl=Symbol("isActive"),El=Symbol("variantSet"),Bl=Symbol("modelVariants");class wl extends bA{constructor(e,t,s,i,n,r,o,a=undefined){super(e,s,o),this[rl]=new Set,this[ml]=i,this[Cl]=n,this[Bl]=r,null==a?this[gl](t):this[ul]=a}get[(rl=El,hl)](){return this[yA].values().next().value}[gl](e){const t=this[vA],s=this[QA],i=this[yA];s.extensions&&s.extensions.KHR_materials_pbrSpecularGlossiness&&console.warn(`Material ${s.name} uses a deprecated extension\n          "KHR_materials_pbrSpecularGlossiness", please use\n          "pbrMetallicRoughness" instead. Specular Glossiness materials are\n          no longer supported; to convert to metal-rough, see \n          https://www.donmccurdy.com/2022/11/28/converting-gltf-pbr-materials-from-specgloss-to-metalrough/.`),null==s.pbrMetallicRoughness&&(s.pbrMetallicRoughness={}),this[ol]=new nl(t,e,s.pbrMetallicRoughness,i),null==s.emissiveFactor&&(s.emissiveFactor=[0,0,0]),null==s.doubleSided&&(s.doubleSided=!1),null==s.alphaMode&&(s.alphaMode="OPAQUE"),null==s.alphaCutoff&&(s.alphaCutoff=.5);const{normalTexture:n,occlusionTexture:r,emissiveTexture:o}=s,{normalMap:a,aoMap:A,emissiveMap:l}=i.values().next().value;this[al]=new el(t,ZA.Normal,a,i,e,n||null),this[Al]=new el(t,ZA.Occlusion,A,i,e,r||null),this[ll]=new el(t,ZA.Emissive,l,i,e,o||null)}async[dl](){if(null!=this[ul]){const{set:e,material:t}=await this[ul].doLazyLoad();return this[yA]=e,this[gl](this[ul].gltf),this[ul]=void 0,this.ensureLoaded=async()=>{},t}return this[yA].values().next().value}[pl](){if(null!=this[ul])throw new Error(`Material "${this.name}" has not been loaded, call 'await\n    myMaterial.ensureLoaded()' before using an unloaded material.`)}async ensureLoaded(){await this[dl]()}get isLoaded(){return null==this[ul]}get isActive(){return this[Cl]}[Il](e){this[Cl]=e}get name(){return this[QA].name}set name(e){const t=this[QA];if(null!=t&&(t.name=e),null!=this[yA])for(const t of this[yA])t.name=e}get pbrMetallicRoughness(){return this[pl](),this[ol]}get normalTexture(){return this[pl](),this[al]}get occlusionTexture(){return this[pl](),this[Al]}get emissiveTexture(){return this[pl](),this[ll]}get emissiveFactor(){return this[pl](),this[QA].emissiveFactor}get index(){return this[ml]}[fl](){return this[El]}hasVariant(e){const t=this[Bl].get(e);return null!=t&&this[El].has(t.index)}setEmissiveFactor(e){this[pl]();const t=new d;e instanceof Array?t.fromArray(e):t.set(e).convertSRGBToLinear();for(const e of this[yA])e.emissive.set(t);this[QA].emissiveFactor=t.toArray(),this[vA]()}[cl](){this[pl]();const e=this[QA];for(const t of this[yA])"MASK"===this[QA].alphaMode?t.alphaTest=e.alphaCutoff:t.alphaTest=void 0,t.needsUpdate=!0}setAlphaCutoff(e){this[pl](),this[QA].alphaCutoff=e,this[cl](),this[vA]()}getAlphaCutoff(){return this[pl](),this[QA].alphaCutoff}setDoubleSided(e){this[pl]();for(const t of this[yA])t.side=e?ne:Se,t.needsUpdate=!0;this[QA].doubleSided=e,this[vA]()}getDoubleSided(){return this[pl](),this[QA].doubleSided}setAlphaMode(e){this[pl]();const t=(e,t)=>{e.transparent=t,e.depthWrite=!t};this[QA].alphaMode=e;for(const s of this[yA])t(s,"BLEND"===e),this[cl](),s.needsUpdate=!0;this[vA]()}getAlphaMode(){return this[pl](),this[QA].alphaMode}}class yl{constructor(e){this.name="",this.children=new Array,this.name=e}}class Ql extends yl{constructor(e,t,s,i){super(e.name),this.materials=new Map,this.variantToMaterialMap=new Map,this.initialMaterialIdx=0,this.activeMaterialIdx=0,this.mesh=e;const{gltf:n,threeGLTF:r,threeObjectMap:o}=i;this.modelVariants=s,this.mesh.userData.variantData=s;const a=o.get(e.material);null!=a.materials?this.initialMaterialIdx=this.activeMaterialIdx=a.materials:console.error(`Primitive (${e.name}) missing initial material reference.`);const A=e.userData.associations||{};if(null==A.meshes)return void console.error("Mesh is missing primitive index association");const l=((n.meshes||[])[A.meshes].primitives||[])[A.primitives];if(null!=l){if(null!=l.material)this.materials.set(l.material,t[l.material]);else{const e=t.findIndex((e=>"Default"===e.name));e>=0?this.materials.set(e,t[e]):console.warn("gltfPrimitive has no material!")}if(l.extensions&&l.extensions.KHR_materials_variants){const e=l.extensions.KHR_materials_variants,i=r.parser.json.extensions.KHR_materials_variants.variants;for(const n of e.mappings){const e=t[n.material];this.materials.set(n.material,e);for(const t of n.variants){const{name:n}=i[t];this.variantToMaterialMap.set(t,e),e[fl]().add(t),s.has(n)||s.set(n,{name:n,index:t})}}}}else console.error("Mesh primitive definition is missing.")}async setActiveMaterial(e){const t=this.materials.get(e);return null!=t&&(this.mesh.material=await t[dl](),this.activeMaterialIdx=e),this.mesh.material}getActiveMaterial(){return this.materials.get(this.activeMaterialIdx)}getMaterial(e){return this.materials.get(e)}async enableVariant(e){if(null==e)return this.setActiveMaterial(this.initialMaterialIdx);if(null!=this.variantToMaterialMap&&this.modelVariants.has(e)){const t=this.modelVariants.get(e);return this.enableVariantHelper(t.index)}return null}async enableVariantHelper(e){if(null!=this.variantToMaterialMap&&null!=e){const t=this.variantToMaterialMap.get(e);if(null!=t)return this.setActiveMaterial(t.index)}return null}async instantiateVariants(){if(null!=this.variantToMaterialMap)for(const e of this.variantToMaterialMap.keys()){const t=this.mesh.userData.variantMaterials.get(e);if(null!=t.material)continue;const s=await this.enableVariantHelper(e);null!=s&&(t.material=s)}}get variantInfo(){return this.variantToMaterialMap}addVariant(e,t){if(!this.ensureVariantIsUnused(t))return!1;this.modelVariants.has(t)||this.modelVariants.set(t,{name:t,index:this.modelVariants.size});const s=this.modelVariants.get(t).index;return e[fl]().add(s),this.variantToMaterialMap.set(s,e),this.materials.set(e.index,e),this.updateVariantUserData(s,e),!0}deleteVariant(e){if(this.variantInfo.has(e)){this.variantInfo.delete(e);const t=this.mesh.userData.variantMaterials;null!=t&&t.delete(e)}}updateVariantUserData(e,t){t[fl]().add(e),this.mesh.userData.variantData=this.modelVariants,this.mesh.userData.variantMaterials=this.mesh.userData.variantMaterials||new Map;this.mesh.userData.variantMaterials.set(e,{material:t[yA].values().next().value,gltfMaterialIndex:t.index})}ensureVariantIsUnused(e){const t=this.modelVariants.get(e);return null==t||!this.variantInfo.has(t.index)||(console.warn(`Primitive cannot add variant '${e}' for this material, it already exists.`),!1)}}
/* @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var vl,bl,Sl,xl,Ml,Dl;const Rl=Symbol("materials"),Tl=Symbol("hierarchy"),Ll=Symbol("roots"),Fl=Symbol("primitives"),kl=Symbol("correlatedSceneGraph"),Ul=Symbol("prepareVariantsForExport"),_l=Symbol("switchVariant"),Nl=Symbol("materialFromPoint"),Gl=Symbol("nodeFromPoint"),Pl=Symbol("nodeFromIndex"),Ol=Symbol("variantData"),Hl=Symbol("availableVariants"),ql=Symbol("modelOnUpdate"),Vl=Symbol("cloneMaterial");class Jl{constructor(e,t,s,i){this.gltf=e,this.gltfElementMap=t,this.mapKey=s,this.doLazyLoad=i}}class Kl{constructor(e,t=(()=>{})){this[vl]=new Array,this[bl]=new Array,this[Sl]=new Array,this[xl]=new Array,this[Ml]=()=>{},this[Dl]=new Map,this[ql]=t,this[kl]=e;const{gltf:s,threeGLTF:i,gltfElementMap:n}=e;for(const[e,r]of s.materials.entries()){const o=n.get(r);if(null!=o)this[Rl].push(new wl(t,s,r,e,!0,this[Ol],o));else{const r=(s.materials||[])[e],a=e,A=async()=>{const e=await i.parser.getDependency("material",a),t=new Set;return n.set(r,t),t.add(e),{set:t,material:e}};this[Rl].push(new wl(t,s,r,e,!1,this[Ol],o,new Jl(s,n,r,A)))}}const r=new Map,o=new Array;for(const e of i.scene.children)o.push(e);for(;o.length>0;){const t=o.pop();let s=null;t instanceof ae?(s=new Ql(t,this.materials,this[Ol],e),this[Fl].push(s)):s=new yl(t.name);const i=r.get(t);null!=i?i.children.push(s):this[Ll].push(s),this[Tl].push(s);for(const e of t.children)o.push(e),r.set(t,s)}}get materials(){return this[Rl]}[(vl=Rl,bl=Tl,Sl=Ll,xl=Fl,Ml=ql,Dl=Ol,Hl)](){const e=Array.from(this[Ol].values());return e.sort(((e,t)=>e.index-t.index)),e.map((e=>e.name))}getMaterialByName(e){const t=this[Rl].filter((t=>t.name===e));return t.length>0?t[0]:null}[Pl](e,t){const s=this[Tl].find((s=>{if(s instanceof Ql){const{meshes:i,primitives:n}=s.mesh.userData.associations;if(i==e&&n==t)return!0}return!1}));return null==s?null:s}[Gl](e){return this[Tl].find((t=>{if(t instanceof Ql){if(t.mesh===e.object)return!0}return!1}))}[Nl](e){return this[Gl](e).getActiveMaterial()}async[_l](e){for(const t of this[Fl])await t.enableVariant(e);for(const e of this.materials)e[Il](!1);for(const e of this[Fl])this.materials[e.getActiveMaterial().index][Il](!0)}async[Ul](){const e=new Array;for(const t of this[Fl])e.push(t.instantiateVariants());await Promise.all(e)}[Vl](e,t){const s=this.materials[e];s.isLoaded||console.error("Cloning an unloaded material,\n           call 'material.ensureLoaded() before cloning the material.");const i=s[yA],n=JSON.parse(JSON.stringify(s[QA]));n.name=t;this[kl].gltf.materials.push(n);const r=new Set;for(const[e,s]of i.entries()){const n=s.clone();n.name=t+(i.size>1?"_inst"+e:""),r.add(n)}const o=new wl(this[ql],this[kl].gltf,n,this[Rl].length,!1,this[Ol],r);return this[Rl].push(o),o}createMaterialInstanceForVariant(e,t,s,i=!0){let n=null;for(const i of this[Fl]){const r=this[Ol].get(s);null!=r&&i.variantInfo.has(r.index)||null!=i.getMaterial(e)&&(this.hasVariant(s)||this.createVariant(s),null==n&&(n=this[Vl](e,t)),i.addVariant(n,s))}if(i&&null!=n){n[Il](!0),this.materials[e][Il](!1);for(const e of this[Fl])e.enableVariant(s)}return n}createVariant(e){this[Ol].has(e)?console.warn(`Variant '${e}'' already exists`):this[Ol].set(e,{name:e,index:this[Ol].size})}hasVariant(e){return this[Ol].has(e)}setMaterialToVariant(e,t){if(null!=this[Hl]().find((e=>e===t)))if(e<0||e>=this.materials.length)console.error("setMaterialToVariant(): materialIndex is out of bounds.");else for(const s of this[Fl]){const i=s.getMaterial(e);null!=i&&s.addVariant(i,t)}else console.warn(`Can't add material to '${t}', the variant does not exist.'`)}updateVariantName(e,t){const s=this[Ol].get(e);null!=s&&(s.name=t,this[Ol].set(t,s),this[Ol].delete(e))}deleteVariant(e){const t=this[Ol].get(e);if(null!=t){for(const s of this.materials)s.hasVariant(e)&&s[El].delete(t.index);for(const e of this[Fl])e.deleteVariant(t.index);this[Ol].delete(e)}}}
/* @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Yl=function(e,t,s,i){for(var n,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,s):i,a=e.length-1;a>=0;a--)(n=e[a])&&(o=(r<3?n(o):r>3?n(t,s,o):n(t,s))||o);return r>3&&o&&Object.defineProperty(t,s,o),o};const zl=Symbol("currentGLTF"),jl=Symbol("originalGltfJson"),$l=Symbol("model"),Wl=Symbol("getOnUpdateMethod"),Xl=Symbol("buildTexture"),Zl=new g,eh=new g,th=new g,sh=new C,ih=new E,nh=new e;class rh extends bn{constructor(e){super(document.createElement("div")),this.normal=new g(0,1,0),this.initialized=!1,this.referenceCount=1,this.pivot=document.createElement("div"),this.slot=document.createElement("slot"),this.element.classList.add("annotation-wrapper"),this.slot.name=e.name,this.element.appendChild(this.pivot),this.pivot.appendChild(this.slot),this.updatePosition(e.position),this.updateNormal(e.normal),this.surface=e.surface}get facingCamera(){return!this.element.classList.contains("hide")}show(){this.facingCamera&&this.initialized||this.updateVisibility(!0)}hide(){!this.facingCamera&&this.initialized||this.updateVisibility(!1)}increment(){this.referenceCount++}decrement(){return this.referenceCount>0&&--this.referenceCount,0===this.referenceCount}updatePosition(e){if(null==e)return;const t=_r(e)[0].terms;for(let e=0;e<3;++e)this.position.setComponent(e,zr(t[e]).number);this.updateMatrixWorld()}updateNormal(e){if(null==e)return;const t=_r(e)[0].terms;for(let e=0;e<3;++e)this.normal.setComponent(e,t[e].number)}updateSurface(e){if(!e&&this.initialized)return;const{mesh:t,tri:s,bary:i}=this;if(null==t||null==s||null==i)return;t.getVertexPosition(s.x,Zl),t.getVertexPosition(s.y,eh),t.getVertexPosition(s.z,th),Zl.toArray(sh.elements,0),eh.toArray(sh.elements,3),th.toArray(sh.elements,6),this.position.copy(i).applyMatrix3(sh);const n=this.parent;n.worldToLocal(t.localToWorld(this.position)),ih.set(Zl,eh,th),ih.getNormal(this.normal).transformDirection(t.matrixWorld);const r=n.parent;nh.setFromAxisAngle(Zl.set(0,1,0),-r.yaw),this.normal.applyQuaternion(nh)}orient(e){this.pivot.style.transform=`rotate(${e}rad)`}updateVisibility(e){e?this.element.classList.remove("hide"):this.element.classList.add("hide"),this.slot.assignedNodes().forEach((t=>{if(t.nodeType!==Node.ELEMENT_NODE)return;const s=t,i=s.dataset.visibilityAttribute;if(null!=i){const t=`data-${i}`;e?s.setAttribute(t,""):s.removeAttribute(t)}s.dispatchEvent(new CustomEvent("hotspot-visibility",{detail:{visible:e}}))})),this.initialized=!0}}const oh={uniforms:{tDiffuse:{value:null},h:{value:1/512}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform float h;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 sum = vec4( 0.0 );\n\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;\n\n\t\t\tgl_FragColor = sum;\n\n\t\t}"},ah={uniforms:{tDiffuse:{value:null},v:{value:1/512}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform float v;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 sum = vec4( 0.0 );\n\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;\n\n\t\t\tgl_FragColor = sum;\n\n\t\t}"};function Ah(e,t,s){return(1-s)*e+s*t}
/* @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lh extends z{constructor(e,t,s){super(),this.camera=new de,this.renderTarget=null,this.renderTargetBlur=null,this.depthMaterial=new nt,this.horizontalBlurMaterial=new ye(oh),this.verticalBlurMaterial=new ye(ah),this.intensity=0,this.softness=1,this.boundingBox=new _e,this.size=new g,this.maxDimension=0,this.isAnimated=!1,this.needsUpdate=!1;const{camera:i}=this;i.rotation.x=Math.PI/2,i.left=-.5,i.right=.5,i.bottom=-.5,i.top=.5,this.add(i);const n=new f,r=new I({opacity:1,transparent:!0,side:Fe});this.floor=new ae(n,r),this.floor.userData.shadow=!0,i.add(this.floor),this.blurPlane=new ae(n),this.blurPlane.visible=!1,i.add(this.blurPlane),e.target.add(this),this.depthMaterial.onBeforeCompile=function(e){e.fragmentShader=e.fragmentShader.replace("gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );","gl_FragColor = vec4( vec3( 0.0 ), ( 1.0 - fragCoordZ ) * opacity );")},this.horizontalBlurMaterial.depthTest=!1,this.verticalBlurMaterial.depthTest=!1,this.setScene(e,t,s)}setScene(e,t,s){const{boundingBox:i,size:n,rotation:r,position:o}=this;if(this.isAnimated=e.animationNames.length>0,this.boundingBox.copy(e.boundingBox),this.size.copy(e.size),this.maxDimension=Math.max(n.x,n.y,n.z)*(this.isAnimated?2:1),this.boundingBox.getCenter(o),"back"===s){const{min:e,max:t}=i;[e.y,e.z]=[e.z,e.y],[t.y,t.z]=[t.z,t.y],[n.y,n.z]=[n.z,n.y],r.x=Math.PI/2,r.y=Math.PI}else r.x=0,r.y=0;if(this.isAnimated){const e=i.min.y,t=i.max.y;n.y=this.maxDimension,i.expandByVector(n.subScalar(this.maxDimension).multiplyScalar(-.5)),i.min.y=e,i.max.y=t,n.set(this.maxDimension,t-e,this.maxDimension)}"bottom"===s?o.y=i.min.y:o.z=i.min.y,this.setSoftness(t)}setSoftness(e){this.softness=e;const{size:t,camera:s}=this,i=this.isAnimated?2:1,n=i*Math.pow(2,9-3*e);this.setMapSize(n);const r=t.y/2,o=t.y*i;s.near=0,s.far=Ah(o,r,e),this.depthMaterial.opacity=1/e,s.updateProjectionMatrix(),this.setIntensity(this.intensity),this.setOffset(0)}setMapSize(e){const{size:t}=this;this.isAnimated&&(e*=2);const i=Math.floor(t.x>t.z?e:e*t.x/t.z),n=Math.floor(t.x>t.z?e*t.z/t.x:e),r=10+i,o=10+n;if(null==this.renderTarget||this.renderTarget.width===r&&this.renderTarget.height===o||(this.renderTarget.dispose(),this.renderTarget=null,this.renderTargetBlur.dispose(),this.renderTargetBlur=null),null==this.renderTarget){const e={format:s};this.renderTarget=new ve(r,o,e),this.renderTargetBlur=new ve(r,o,e),this.floor.material.map=this.renderTarget.texture}this.camera.scale.set(t.x*(1+10/i),t.z*(1+10/n),1),this.needsUpdate=!0}setIntensity(e){this.intensity=e,e>0?(this.visible=!0,this.floor.visible=!0,this.floor.material.opacity=e*Ah(.3,1,this.softness*this.softness)):(this.visible=!1,this.floor.visible=!1)}getIntensity(){return this.intensity}setOffset(e){this.floor.position.z=-e+.001*this.maxDimension}render(e,t){t.overrideMaterial=this.depthMaterial;const s=e.getClearAlpha();e.setClearAlpha(0),this.floor.visible=!1;const i=e.xr.enabled;e.xr.enabled=!1;const n=e.getRenderTarget();e.setRenderTarget(this.renderTarget),e.render(t,this.camera),t.overrideMaterial=null,this.floor.visible=!0,this.blurShadow(e),e.xr.enabled=i,e.setRenderTarget(n),e.setClearAlpha(s)}blurShadow(e){const{camera:t,horizontalBlurMaterial:s,verticalBlurMaterial:i,renderTarget:n,renderTargetBlur:r,blurPlane:o}=this;o.visible=!0,o.material=s,s.uniforms.h.value=1/this.renderTarget.width,s.uniforms.tDiffuse.value=this.renderTarget.texture,e.setRenderTarget(r),e.render(o,t),o.material=i,i.uniforms.v.value=1/this.renderTarget.height,i.uniforms.tDiffuse.value=this.renderTargetBlur.texture,e.setRenderTarget(n),e.render(o,t),o.visible=!1}dispose(){null!=this.renderTarget&&this.renderTarget.dispose(),null!=this.renderTargetBlur&&this.renderTargetBlur.dispose(),this.depthMaterial.dispose(),this.horizontalBlurMaterial.dispose(),this.verticalBlurMaterial.dispose(),this.floor.material.dispose(),this.floor.geometry.dispose(),this.blurPlane.geometry.dispose(),this.removeFromParent()}}
/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hh=new g,ch=new g,uh=new g,gh=new B,dh=new g,ph=new p;class mh extends Qe{constructor({canvas:e,element:t,width:s,height:i}){super(),this.annotationRenderer=new Tn,this.effectRenderer=null,this.schemaElement=document.createElement("script"),this.width=1,this.height=1,this.aspect=1,this.scaleStep=0,this.renderCount=0,this.externalRenderer=null,this.camera=new m(45,1,.1,100),this.xrCamera=null,this.url=null,this.target=new z,this.animationNames=[],this.boundingBox=new _e,this.boundingSphere=new be,this.size=new g,this.idealAspect=0,this.framedFoVDeg=0,this.shadow=null,this.shadowIntensity=0,this.shadowSoftness=1,this.bakedShadows=new Set,this.exposure=1,this.canScale=!0,this.isDirty=!1,this.goalTarget=new g,this.targetDamperX=new Dr,this.targetDamperY=new Dr,this.targetDamperZ=new Dr,this._currentGLTF=null,this._model=null,this.cancelPendingSourceChange=null,this.animationsByName=new Map,this.currentAnimationAction=null,this.name="ModelScene",this.element=t,this.canvas=e,this.camera=new m(45,1,.1,100),this.camera.name="MainCamera",this.add(this.target),this.setSize(s,i),this.target.name="Target",this.mixer=new Ne(this.target);const{domElement:n}=this.annotationRenderer,{style:r}=n;r.display="none",r.pointerEvents="none",r.position="absolute",r.top="0",this.element.shadowRoot.querySelector(".default").appendChild(n),this.schemaElement.setAttribute("type","application/ld+json")}get context(){return this.canvas.getContext("2d")}getCamera(){return null!=this.xrCamera?this.xrCamera:this.camera}queueRender(){this.isDirty=!0}shouldRender(){return this.isDirty}hasRendered(){this.isDirty=!1}forceRescale(){this.scaleStep=-1,this.queueRender()}async setObject(e){this.reset(),this._model=e,this.target.add(e),await this.setupScene()}async setSource(e,t=(()=>{})){if(!e||e===this.url)return void t(1);if(this.reset(),this.url=e,null!=this.externalRenderer){const e=await this.externalRenderer.load(t);return this.boundingSphere.radius=e.framedRadius,void(this.idealAspect=e.fieldOfViewAspect)}let s;null!=this.cancelPendingSourceChange&&(this.cancelPendingSourceChange(),this.cancelPendingSourceChange=null);try{s=await new Promise((async(s,i)=>{this.cancelPendingSourceChange=()=>i();try{s(await this.element[ac].loader.load(e,this.element,t))}catch(e){i(e)}}))}catch(e){if(null==e)return;throw e}this.cancelPendingSourceChange=null,this.reset(),this.url=e,this._currentGLTF=s,null!=s&&(this._model=s.scene,this.target.add(s.scene));const{animations:i}=s,n=new Map,r=[];for(const e of i)n.set(e.name,e),r.push(e.name);this.animations=i,this.animationsByName=n,this.animationNames=r,await this.setupScene()}async setupScene(){this.applyTransform(),this.updateBoundingBox(),await this.updateFraming(),this.updateShadow(),this.setShadowIntensity(this.shadowIntensity)}reset(){this.url=null,this.renderCount=0,this.queueRender(),null!=this.shadow&&this.shadow.setIntensity(0),this.bakedShadows.clear();const{_model:e}=this;null!=e&&(e.removeFromParent(),this._model=null);const t=this._currentGLTF;null!=t&&(t.dispose(),this._currentGLTF=null),null!=this.currentAnimationAction&&(this.currentAnimationAction.stop(),this.currentAnimationAction=null),this.mixer.stopAllAction(),this.mixer.uncacheRoot(this)}dispose(){this.reset(),null!=this.shadow&&(this.shadow.dispose(),this.shadow=null),this.element[zl]=null,this.element[jl]=null,this.element[$l]=null}get currentGLTF(){return this._currentGLTF}setSize(e,t){if(this.width!==e||this.height!==t){if(this.width=Math.max(e,1),this.height=Math.max(t,1),this.annotationRenderer.setSize(e,t),this.aspect=this.width/this.height,null!=this.externalRenderer){const s=Ms();this.externalRenderer.resize(e*s,t*s)}this.queueRender()}}markBakedShadow(e){e.userData.shadow=!0,this.bakedShadows.add(e)}unmarkBakedShadow(e){e.userData.shadow=!1,e.visible=!0,this.bakedShadows.delete(e),this.boundingBox.expandByObject(e)}findBakedShadows(e){const t=new _e;e.traverse((e=>{const s=e;if(!s.isMesh)return;if(!s.material.transparent)return;t.setFromObject(s);const i=t.getSize(dh),n=Math.min(i.x,i.y,i.z);Math.max(i.x,i.y,i.z)<100*n||this.markBakedShadow(s)}))}checkBakedShadows(){const{min:e,max:t}=this.boundingBox,s=new _e;this.boundingBox.getSize(this.size);for(const i of this.bakedShadows)s.setFromObject(i),s.min.y<e.y+this.size.y/100&&s.min.x<=e.x&&s.max.x>=t.x&&s.min.z<=e.z&&s.max.z>=t.z||s.min.z<e.z+this.size.z/100&&s.min.x<=e.x&&s.max.x>=t.x&&s.min.y<=e.y&&s.max.y>=t.y||this.unmarkBakedShadow(i)}applyTransform(){const{model:e}=this;if(null==e)return;const t=_r(this.element.orientation)[0].terms,s=zr(t[0]).number,i=zr(t[1]).number,n=zr(t[2]).number;e.quaternion.setFromEuler(new we(i,n,s,"YXZ"));const r=_r(this.element.scale)[0].terms;e.scale.set(r[0].number,r[1].number,r[2].number)}updateBoundingBox(){const{model:e}=this;if(null==e)return;this.target.remove(e),this.findBakedShadows(e);const t=(e,t)=>e.expandByPoint(t);this.setBakedShadowVisibility(!1),this.boundingBox=Ln(e,t,new _e),this.boundingBox.isEmpty()&&(this.setBakedShadowVisibility(!0),this.bakedShadows.forEach((e=>this.unmarkBakedShadow(e))),this.boundingBox=Ln(e,t,new _e)),this.checkBakedShadows(),this.setBakedShadowVisibility(),this.boundingBox.getSize(this.size),this.target.add(e)}async updateFraming(){const{model:e}=this;if(null==e)return;this.target.remove(e),this.setBakedShadowVisibility(!1);const{center:t}=this.boundingSphere;this.element.requestUpdate("cameraTarget"),await this.element.updateComplete,t.copy(this.getTarget());this.boundingSphere.radius=Math.sqrt(Ln(e,((e,s)=>Math.max(e,t.distanceToSquared(s))),0));this.idealAspect=Ln(e,((e,s)=>{s.sub(t);const i=Math.sqrt(s.x*s.x+s.z*s.z);return Math.max(e,i/(this.idealCameraDistance()-Math.abs(s.y)))}),0)/Math.tan(this.framedFoVDeg/2*Math.PI/180),this.setBakedShadowVisibility(),this.target.add(e)}setBakedShadowVisibility(e=this.shadowIntensity<=0){for(const t of this.bakedShadows)t.visible=e}idealCameraDistance(){const e=this.framedFoVDeg/2*Math.PI/180;return this.boundingSphere.radius/Math.sin(e)}adjustedFoV(e){const t=Math.tan(e/2*Math.PI/180)*Math.max(1,this.idealAspect/this.aspect);return 2*Math.atan(t)*180/Math.PI}getNDC(e,t){if(null!=this.xrCamera)ph.set(e/window.screen.width,t/window.screen.height);else{const s=this.element.getBoundingClientRect();ph.set((e-s.x)/this.width,(t-s.y)/this.height)}return ph.multiplyScalar(2).subScalar(1),ph.y*=-1,ph}getSize(){return{width:this.width,height:this.height}}setEnvironmentAndSkybox(e,t){this.element[ac].arRenderer.presentedScene!==this&&(this.environment=e,this.background=t,this.queueRender())}setTarget(e,t,s){this.goalTarget.set(-e,-t,-s)}setTargetDamperDecayTime(e){this.targetDamperX.setDecayTime(e),this.targetDamperY.setDecayTime(e),this.targetDamperZ.setDecayTime(e)}getTarget(){return this.goalTarget.clone().multiplyScalar(-1)}jumpToGoal(){this.updateTarget(1e4)}updateTarget(e){const t=this.goalTarget,s=this.target.position;if(t.equals(s))return!1;{const i=this.boundingSphere.radius/10;let{x:n,y:r,z:o}=s;return n=this.targetDamperX.update(n,t.x,e,i),r=this.targetDamperY.update(r,t.y,e,i),o=this.targetDamperZ.update(o,t.z,e,i),this.target.position.set(n,r,o),this.target.updateMatrixWorld(),this.queueRender(),!0}}pointTowards(e,t){const{x:s,z:i}=this.position;this.yaw=Math.atan2(e-s,t-i)}get model(){return this._model}set yaw(e){this.rotation.y=e,this.queueRender()}get yaw(){return this.rotation.y}set animationTime(e){this.mixer.setTime(e),this.queueShadowRender()}get animationTime(){if(null!=this.currentAnimationAction){const e=Math.max(this.currentAnimationAction._loopCount,0);return this.currentAnimationAction.loop===Ge&&1==(1&e)?this.duration-this.currentAnimationAction.time:this.currentAnimationAction.time}return 0}set animationTimeScale(e){this.mixer.timeScale=e}get animationTimeScale(){return this.mixer.timeScale}get duration(){return null!=this.currentAnimationAction&&this.currentAnimationAction.getClip()?this.currentAnimationAction.getClip().duration:0}get hasActiveAnimation(){return null!=this.currentAnimationAction}playAnimation(e=null,t=0,s=Pe,i=1/0){if(null==this._currentGLTF)return;const{animations:n}=this;if(null==n||0===n.length)return void console.warn("Cannot play animation (model does not have any animations)");let r=null;if(null!=e&&(r=this.animationsByName.get(e),null==r)){const t=parseInt(e);!isNaN(t)&&t>=0&&t<n.length&&(r=n[t])}null==r&&(r=n[0]);try{const{currentAnimationAction:e}=this,n=this.mixer.clipAction(r,this);this.currentAnimationAction=n,this.element.paused?this.mixer.stopAllAction():(n.paused=!1,null!=e&&n!==e?n.crossFadeFrom(e,t,!1):this.animationTimeScale>0&&this.animationTime==this.duration&&(this.animationTime=0)),n.setLoop(s,i),n.enabled=!0,n.clampWhenFinished=!0,n.play()}catch(e){console.error(e)}}stopAnimation(){this.currentAnimationAction=null,this.mixer.stopAllAction()}updateAnimation(e){this.mixer.update(e),this.queueShadowRender()}subscribeMixerEvent(e,t){this.mixer.addEventListener(e,t)}updateShadow(){const e=this.shadow;if(null!=e){const t="wall"===this.element.arPlacement?"back":"bottom";e.setScene(this,this.shadowSoftness,t),e.needsUpdate=!0}}renderShadow(e){const t=this.shadow;null!=t&&1==t.needsUpdate&&(t.render(e,this),t.needsUpdate=!1)}queueShadowRender(){null!=this.shadow&&(this.shadow.needsUpdate=!0)}setShadowIntensity(e){if(this.shadowIntensity=e,null!=this._currentGLTF&&(this.setBakedShadowVisibility(),!(e<=0&&null==this.shadow))){if(null==this.shadow){const e="wall"===this.element.arPlacement?"back":"bottom";this.shadow=new lh(this,this.shadowSoftness,e)}this.shadow.setIntensity(e)}}setShadowSoftness(e){this.shadowSoftness=e;const t=this.shadow;null!=t&&t.setSoftness(e)}setShadowOffset(e){const t=this.shadow;null!=t&&t.setOffset(e)}get raycaster(){return gh}hitFromPoint(e,t=this){this.raycaster.setFromCamera(e,this.getCamera());return this.raycaster.intersectObject(t,!0).find((e=>e.object.visible&&!e.object.userData.shadow))}positionAndNormalFromPoint(e,t=this){const s=this.hitFromPoint(e,t);return null==s||null==s.face?null:null==s.uv?{position:s.point,normal:s.face.normal,uv:null}:(s.face.normal.applyNormalMatrix((new C).getNormalMatrix(s.object.matrixWorld)),{position:s.point,normal:s.face.normal,uv:s.uv})}surfaceFromPoint(e,t=this){const s=this.element.model;if(null==s)return null;const i=this.hitFromPoint(e,t);if(null==i||null==i.face)return null;const n=s[Gl](i),{meshes:r,primitives:o}=n.mesh.userData.associations,a=new g,A=new g,l=new g,{a:h,b:c,c:u}=i.face,d=i.object;d.getVertexPosition(h,a),d.getVertexPosition(c,A),d.getVertexPosition(u,l);const p=new E(a,A,l),m=new g;return p.getBarycoord(d.worldToLocal(i.point),m),`${r} ${o} ${h} ${c} ${u} ${m.x.toFixed(3)} ${m.y.toFixed(3)} ${m.z.toFixed(3)}`}addHotspot(e){this.target.add(e),this.annotationRenderer.domElement.appendChild(e.element)}removeHotspot(e){this.target.remove(e)}forHotspots(e){const{children:t}=this.target;for(let s=0,i=t.length;s<i;s++){const i=t[s];i instanceof rh&&e(i)}}initializeSurface(e){if(null!=e.surface&&null==e.mesh){const t=_r(e.surface)[0].terms;if(8!=t.length)return void console.warn(e.surface+" does not have exactly 8 numbers.");const s=this.element.model[Pl](t[0].number,t[1].number),i=new g(t[2].number,t[3].number,t[4].number);if(null==s)return void console.warn(e.surface+" does not match a node/primitive in this glTF! Skipping this hotspot.");const n=s.mesh.geometry.attributes.position.count;if(i.x>=n||i.y>=n||i.z>=n)return void console.warn(e.surface+" vertex indices out of range in this glTF! Skipping this hotspot.");const r=new g(t[5].number,t[6].number,t[7].number);e.mesh=s.mesh,e.tri=i,e.bary=r}}updateSurfaceHotspots(){const e=!this.element.paused;this.forHotspots((t=>{this.initializeSurface(t),t.updateSurface(e)}))}updateHotspotsVisibility(e){this.forHotspots((t=>{hh.copy(e),ch.setFromMatrixPosition(t.matrixWorld),hh.sub(ch),uh.copy(t.normal).transformDirection(this.target.matrixWorld),hh.dot(uh)<0?t.hide():t.show()}))}orientHotspots(e){this.forHotspots((t=>{t.orient(e)}))}setHotspotsVisibility(e){this.forHotspots((t=>{t.visible=e}))}updateSchema(e){var t;const{schemaElement:s,element:i}=this,{alt:n,poster:r,iosSrc:o}=i;if(null!=e){const i=[{"@type":"MediaObject",contentUrl:e,encodingFormat:"gltf"===(null===(t=e.split(".").pop())||void 0===t?void 0:t.toLowerCase())?"model/gltf+json":"model/gltf-binary"}];o&&i.push({"@type":"MediaObject",contentUrl:o,encodingFormat:"model/vnd.usdz+zip"});const a={"@context":"http://schema.org/","@type":"3DModel",image:null!=r?r:void 0,name:null!=n?n:void 0,encoding:i};s.textContent=JSON.stringify(a),document.head.appendChild(s)}else null!=s.parentElement&&s.parentElement.removeChild(s)}}
/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Ih extends EventTarget{constructor(){super(...arguments),this.ongoingActivities=new Set,this.totalProgress=0}get ongoingActivityCount(){return this.ongoingActivities.size}beginActivity(){const e={progress:0,completed:!1};return this.ongoingActivities.add(e),1===this.ongoingActivityCount&&this.announceTotalProgress(e,0),t=>{let s;return s=Math.max(xs(t,0,1),e.progress),s!==e.progress&&this.announceTotalProgress(e,s),e.progress}}announceTotalProgress(e,t){let s=0,i=0;1==t&&(e.completed=!0);for(const e of this.ongoingActivities){const{progress:t}=e;s+=1-t,!0===e.completed&&i++}const n=e.progress;e.progress=t,this.totalProgress+=(t-n)*(1-this.totalProgress)/s;const r=i===this.ongoingActivityCount?1:this.totalProgress;this.dispatchEvent(new CustomEvent("progress",{detail:{totalProgress:r}})),i===this.ongoingActivityCount&&(this.totalProgress=0,this.ongoingActivities.clear())}}
/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var fh,Ch,Eh,Bh,wh,yh,Qh,vh,bh,Sh,xh,Mh,Dh,Rh=function(e,t,s,i){for(var n,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,s):i,a=e.length-1;a>=0;a--)(n=e[a])&&(o=(r<3?n(o):r>3?n(t,s,o):n(t,s))||o);return r>3&&o&&Object.defineProperty(t,s,o),o};const Th=document.createElement("canvas"),Lh=Symbol("fallbackResizeHandler"),Fh=Symbol("defaultAriaLabel"),kh=Symbol("resizeObserver"),Uh=Symbol("clearModelTimeout"),_h=Symbol("onContextLost"),Nh=Symbol("loaded"),Gh=Symbol("status"),Ph=Symbol("onFocus"),Oh=Symbol("onBlur"),Hh=Symbol("updateSize"),qh=Symbol("intersectionObserver"),Vh=Symbol("isElementInViewport"),Jh=Symbol("announceModelVisibility"),Kh=Symbol("ariaLabel"),Yh=Symbol("altDefaulted"),zh=Symbol("statusElement"),jh=Symbol("updateStatus"),$h=Symbol("loadedTime"),Wh=Symbol("updateSource"),Xh=Symbol("markLoaded"),Zh=Symbol("container"),ec=Symbol("input"),tc=Symbol("canvas"),sc=Symbol("scene"),ic=Symbol("needsRender"),nc=Symbol("tick"),rc=Symbol("onModelLoad"),oc=Symbol("onResize"),ac=Symbol("renderer"),Ac=Symbol("progressTracker"),lc=Symbol("getLoaded"),hc=Symbol("getModelIsVisible"),cc=Symbol("shouldAttemptPreload"),uc=e=>({x:e.x,y:e.y,z:e.z,toString(){return`${this.x}m ${this.y}m ${this.z}m`}}),gc=e=>({u:e.x,v:e.y,toString(){return`${this.u} ${this.v}`}});class dc extends vt{constructor(){super(),this.alt=null,this.src=null,this.withCredentials=!1,this.generateSchema=!1,this[fh]=!1,this[Ch]=!1,this[Eh]=0,this[Bh]="",this[wh]=null,this[yh]=Ss((()=>{const e=this.getBoundingClientRect();this[Hh](e)}),50),this[Qh]=Ss((e=>{const t=this.modelIsVisible;t!==e&&this.dispatchEvent(new CustomEvent("model-visibility",{detail:{visible:t}}))}),0),this[vh]=null,this[bh]=null,this[Sh]=new Ih,this[xh]=()=>{this[zh].textContent=this[Gh]},this[Mh]=()=>{this[zh].textContent=""},this[Dh]=e=>{this.dispatchEvent(new CustomEvent("error",{detail:{type:"webglcontextlost",sourceError:e.sourceEvent}}))},this.attachShadow({mode:"open"});const e=this.shadowRoot;let t,s;if((e=>{as(Us,e)})(e),this[Zh]=e.querySelector(".container"),this[ec]=e.querySelector(".userInput"),this[tc]=e.querySelector("canvas"),this[zh]=e.querySelector("#status"),this[Fh]=this[ec].getAttribute("aria-label"),this.isConnected){const e=this.getBoundingClientRect();t=e.width,s=e.height}else t=300,s=150;this[sc]=new mh({canvas:this[tc],element:this,width:t,height:s}),Promise.resolve().then((()=>{this[Hh](this.getBoundingClientRect())})),ds&&(this[kh]=new ResizeObserver((e=>{if(!this[ac].isPresenting)for(let t of e)t.target===this&&this[Hh](t.contentRect)}))),ps?this[qh]=new IntersectionObserver((e=>{for(let t of e)if(t.target===this){const e=this.modelIsVisible;this[Vh]=t.isIntersecting,this[Jh](e),this[Vh]&&!this.loaded&&this[Wh]()}}),{root:null,rootMargin:"0px",threshold:1e-5}):this[Vh]=!0}static get is(){return"model-viewer"}static set modelCacheSize(e){vn[yn].evictionThreshold=e}static get modelCacheSize(){return vn[yn].evictionThreshold}static set minimumRenderScale(e){e>1&&console.warn("<model-viewer> minimumRenderScale has been clamped to a maximum value of 1."),e<=0&&console.warn("<model-viewer> minimumRenderScale has been clamped to a minimum value of 0.25."),wA.singleton.minScale=e}static get minimumRenderScale(){return wA.singleton.minScale}get loaded(){return this[lc]()}get[(fh=Vh,Ch=Nh,Eh=$h,Bh=Gh,wh=Uh,yh=Lh,Qh=Jh,vh=kh,bh=qh,Sh=Ac,ac)](){return wA.singleton}get modelIsVisible(){return this[hc]()}connectedCallback(){super.connectedCallback&&super.connectedCallback(),ds?this[kh].observe(this):self.addEventListener("resize",this[Lh]),ps&&this[qh].observe(this),this.addEventListener("focus",this[Ph]),this.addEventListener("blur",this[Oh]);const e=this[ac];e.addEventListener("contextlost",this[_h]),e.registerScene(this[sc]),null!=this[Uh]&&(self.clearTimeout(this[Uh]),this[Uh]=null,this.requestUpdate("src",null))}disconnectedCallback(){super.disconnectedCallback&&super.disconnectedCallback(),ds?this[kh].unobserve(this):self.removeEventListener("resize",this[Lh]),ps&&this[qh].unobserve(this),this.removeEventListener("focus",this[Ph]),this.removeEventListener("blur",this[Oh]);const e=this[ac];e.removeEventListener("contextlost",this[_h]),e.unregisterScene(this[sc]),this[Uh]=self.setTimeout((()=>{this[sc].dispose(),this[Uh]=null}),10)}updated(e){super.updated(e),e.has("src")&&(null==this.src?(this[Nh]=!1,this[$h]=0,this[sc].reset()):this.src!==this[sc].url&&(this[Nh]=!1,this[$h]=0,this[Wh]())),e.has("alt")&&this[ec].setAttribute("aria-label",this[Kh]),e.has("withCredentials")&&(vn.withCredentials=this.withCredentials,this[ac].textureUtils.withCredentials=this.withCredentials),e.has("generateSchema")&&(this.generateSchema?this[sc].updateSchema(this.src):this[sc].updateSchema(null))}toDataURL(e,t){return this[ac].displayCanvas(this[sc]).toDataURL(e,t)}async toBlob(e){const t=e?e.mimeType:void 0,s=e?e.qualityArgument:void 0,i=e?e.idealAspect:void 0,{width:n,height:r,idealAspect:o,aspect:a}=this[sc],{dpr:A,scaleFactor:l}=this[ac];let h=n*l*A,c=r*l*A,u=0,g=0;if(!0===i)if(o>a){const e=c;c=Math.round(h/o),g=(e-c)/2}else{const e=h;h=Math.round(c*o),u=(e-h)/2}Th.width=h,Th.height=c;try{return new Promise((async(e,i)=>(Th.getContext("2d").drawImage(this[ac].displayCanvas(this[sc]),u,g,h,c,0,0,h,c),!Th.msToBlob||t&&"image/png"!==t?Th.toBlob?void Th.toBlob((t=>{if(!t)return i(new Error("Unable to retrieve canvas blob"));e(t)}),t,s):e(await(async e=>new Promise(((t,s)=>{const i=e.match(/data:(.*);/);if(!i)return s(new Error(`${e} is not a valid data Url`));const n=i[1],r=e.replace(/data:image\/\w+;base64,/,""),o=atob(r),a=[];for(let e=0;e<o.length;e+=512){const t=o.slice(e,e+512),s=new Array(t.length);for(let e=0;e<t.length;e++)s[e]=t.charCodeAt(e);const i=new Uint8Array(s);a.push(i)}t(new Blob(a,{type:n}))})))(Th.toDataURL(t,s))):e(Th.msToBlob()))))}finally{this[Hh]({width:n,height:r})}}registerEffectComposer(e){e.setRenderer(this[ac].threeRenderer),e.setMainCamera(this[sc].getCamera()),e.setMainScene(this[sc]),this[sc].effectRenderer=e}unregisterEffectComposer(){this[sc].effectRenderer=null}registerRenderer(e){this[sc].externalRenderer=e}unregisterRenderer(){this[sc].externalRenderer=null}get[Kh](){return this[Yh]}get[Yh](){return null==this.alt||"null"===this.alt?this[Fh]:this.alt}[lc](){return this[Nh]}[hc](){return this.loaded&&this[Vh]}[cc](){return!!this.src&&this[Vh]}[Hh]({width:e,height:t}){0!==e&&0!==t&&(this[Zh].style.width=`${e}px`,this[Zh].style.height=`${t}px`,this[oc]({width:e,height:t}))}[nc](e,t){var s;null===(s=this[sc].effectRenderer)||void 0===s||s.beforeRender(e,t)}[Xh](){this[Nh]||(this[Nh]=!0,this[$h]=performance.now())}[ic](){this[sc].queueRender()}[rc](){}[jh](e){this[Gh]=e;const t=this.getRootNode();null!=t&&t.activeElement===this&&this[zh].textContent!=e&&(this[zh].textContent=e)}[(xh=Ph,Mh=Oh,oc)](e){this[sc].setSize(e.width,e.height)}async[(Dh=_h,Wh)](){const e=this[sc];if(this.loaded||!this[cc]()||this.src===e.url)return;this.generateSchema&&e.updateSchema(this.src),this[jh]("Loading"),e.stopAnimation();const t=this[Ac].beginActivity(),s=this.src;try{const i=e.setSource(s,(e=>t(.95*xs(e,0,1)))),n=this[Fs]();await Promise.all([i,n]),this[Xh](),this[rc](),this.updateComplete.then((()=>{this.dispatchEvent(new CustomEvent("before-render"))})),await new Promise((e=>{requestAnimationFrame((()=>{requestAnimationFrame((()=>{this.dispatchEvent(new CustomEvent("load",{detail:{url:s}})),e()}))}))}))}catch(e){this.dispatchEvent(new CustomEvent("error",{detail:{type:"loadfailure",sourceError:e}}))}finally{t(1)}}}Rh([lt({type:String})],dc.prototype,"alt",void 0),Rh([lt({type:String})],dc.prototype,"src",void 0),Rh([lt({type:Boolean,attribute:"with-credentials"})],dc.prototype,"withCredentials",void 0),Rh([lt({type:Boolean,attribute:"generate-schema"})],dc.prototype,"generateSchema",void 0);
/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var pc=function(e,t,s,i){for(var n,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,s):i,a=e.length-1;a>=0;a--)(n=e[a])&&(o=(r<3?n(o):r>3?n(t,s,o):n(t,s))||o);return r>3&&o&&Object.defineProperty(t,s,o),o};const mc=Symbol("changeAnimation"),Ic=Symbol("paused"),fc={repetitions:1/0,pingpong:!1},Cc=Symbol("hotspotMap"),Ec=Symbol("mutationCallback"),Bc=Symbol("observer"),wc=Symbol("addHotspot"),yc=Symbol("removeHotspot"),Qc=new t;
/*!
fflate - fast JavaScript compression/decompression
<https://101arrowz.github.io/fflate>
Licensed under MIT. https://github.com/101arrowz/fflate/blob/master/LICENSE
version 0.6.9
*/
var vc=function(e){return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))};try{URL.revokeObjectURL(vc(""))}catch(Mt){vc=function(e){return"data:application/javascript;charset=UTF-8,"+encodeURI(e)}}var bc=Uint8Array,Sc=Uint16Array,xc=Uint32Array,Mc=new bc([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Dc=new bc([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Rc=new bc([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Tc=function(e,t){for(var s=new Sc(31),i=0;i<31;++i)s[i]=t+=1<<e[i-1];var n=new xc(s[30]);for(i=1;i<30;++i)for(var r=s[i];r<s[i+1];++r)n[r]=r-s[i]<<5|i;return[s,n]},Lc=Tc(Mc,2),Fc=Lc[0],kc=Lc[1];Fc[28]=258,kc[258]=28;for(var Uc=Tc(Dc,0)[1],_c=new Sc(32768),Nc=0;Nc<32768;++Nc){var Gc=(43690&Nc)>>>1|(21845&Nc)<<1;Gc=(61680&(Gc=(52428&Gc)>>>2|(13107&Gc)<<2))>>>4|(3855&Gc)<<4,_c[Nc]=((65280&Gc)>>>8|(255&Gc)<<8)>>>1}var Pc=function(e,t,s){for(var i=e.length,n=0,r=new Sc(t);n<i;++n)++r[e[n]-1];var o,a=new Sc(t);for(n=0;n<t;++n)a[n]=a[n-1]+r[n-1]<<1;if(s){o=new Sc(1<<t);var A=15-t;for(n=0;n<i;++n)if(e[n])for(var l=n<<4|e[n],h=t-e[n],c=a[e[n]-1]++<<h,u=c|(1<<h)-1;c<=u;++c)o[_c[c]>>>A]=l}else for(o=new Sc(i),n=0;n<i;++n)e[n]&&(o[n]=_c[a[e[n]-1]++]>>>15-e[n]);return o},Oc=new bc(288);for(Nc=0;Nc<144;++Nc)Oc[Nc]=8;for(Nc=144;Nc<256;++Nc)Oc[Nc]=9;for(Nc=256;Nc<280;++Nc)Oc[Nc]=7;for(Nc=280;Nc<288;++Nc)Oc[Nc]=8;var Hc=new bc(32);for(Nc=0;Nc<32;++Nc)Hc[Nc]=5;var qc=Pc(Oc,9,0),Vc=Pc(Hc,5,0),Jc=function(e){return(e/8|0)+(7&e&&1)},Kc=function(e,t,s){(null==t||t<0)&&(t=0),(null==s||s>e.length)&&(s=e.length);var i=new(e instanceof Sc?Sc:e instanceof xc?xc:bc)(s-t);return i.set(e.subarray(t,s)),i},Yc=function(e,t,s){s<<=7&t;var i=t/8|0;e[i]|=s,e[i+1]|=s>>>8},zc=function(e,t,s){s<<=7&t;var i=t/8|0;e[i]|=s,e[i+1]|=s>>>8,e[i+2]|=s>>>16},jc=function(e,t){for(var s=[],i=0;i<e.length;++i)e[i]&&s.push({s:i,f:e[i]});var n=s.length,r=s.slice();if(!n)return[su,0];if(1==n){var o=new bc(s[0].s+1);return o[s[0].s]=1,[o,1]}s.sort((function(e,t){return e.f-t.f})),s.push({s:-1,f:25001});var a=s[0],A=s[1],l=0,h=1,c=2;for(s[0]={s:-1,f:a.f+A.f,l:a,r:A};h!=n-1;)a=s[s[l].f<s[c].f?l++:c++],A=s[l!=h&&s[l].f<s[c].f?l++:c++],s[h++]={s:-1,f:a.f+A.f,l:a,r:A};var u=r[0].s;for(i=1;i<n;++i)r[i].s>u&&(u=r[i].s);var g=new Sc(u+1),d=$c(s[h-1],g,0);if(d>t){i=0;var p=0,m=d-t,I=1<<m;for(r.sort((function(e,t){return g[t.s]-g[e.s]||e.f-t.f}));i<n;++i){var f=r[i].s;if(!(g[f]>t))break;p+=I-(1<<d-g[f]),g[f]=t}for(p>>>=m;p>0;){var C=r[i].s;g[C]<t?p-=1<<t-g[C]++-1:++i}for(;i>=0&&p;--i){var E=r[i].s;g[E]==t&&(--g[E],++p)}d=t}return[new bc(g),d]},$c=function(e,t,s){return-1==e.s?Math.max($c(e.l,t,s+1),$c(e.r,t,s+1)):t[e.s]=s},Wc=function(e){for(var t=e.length;t&&!e[--t];);for(var s=new Sc(++t),i=0,n=e[0],r=1,o=function(e){s[i++]=e},a=1;a<=t;++a)if(e[a]==n&&a!=t)++r;else{if(!n&&r>2){for(;r>138;r-=138)o(32754);r>2&&(o(r>10?r-11<<5|28690:r-3<<5|12305),r=0)}else if(r>3){for(o(n),--r;r>6;r-=6)o(8304);r>2&&(o(r-3<<5|8208),r=0)}for(;r--;)o(n);r=1,n=e[a]}return[s.subarray(0,i),t]},Xc=function(e,t){for(var s=0,i=0;i<t.length;++i)s+=e[i]*t[i];return s},Zc=function(e,t,s){var i=s.length,n=Jc(t+2);e[n]=255&i,e[n+1]=i>>>8,e[n+2]=255^e[n],e[n+3]=255^e[n+1];for(var r=0;r<i;++r)e[n+r+4]=s[r];return 8*(n+4+i)},eu=function(e,t,s,i,n,r,o,a,A,l,h){Yc(t,h++,s),++n[256];for(var c=jc(n,15),u=c[0],g=c[1],d=jc(r,15),p=d[0],m=d[1],I=Wc(u),f=I[0],C=I[1],E=Wc(p),B=E[0],w=E[1],y=new Sc(19),Q=0;Q<f.length;++Q)y[31&f[Q]]++;for(Q=0;Q<B.length;++Q)y[31&B[Q]]++;for(var v=jc(y,7),b=v[0],S=v[1],x=19;x>4&&!b[Rc[x-1]];--x);var M,D,R,T,L=l+5<<3,F=Xc(n,Oc)+Xc(r,Hc)+o,k=Xc(n,u)+Xc(r,p)+o+14+3*x+Xc(y,b)+(2*y[16]+3*y[17]+7*y[18]);if(L<=F&&L<=k)return Zc(t,h,e.subarray(A,A+l));if(Yc(t,h,1+(k<F)),h+=2,k<F){M=Pc(u,g,0),D=u,R=Pc(p,m,0),T=p;var U=Pc(b,S,0);Yc(t,h,C-257),Yc(t,h+5,w-1),Yc(t,h+10,x-4),h+=14;for(Q=0;Q<x;++Q)Yc(t,h+3*Q,b[Rc[Q]]);h+=3*x;for(var _=[f,B],N=0;N<2;++N){var G=_[N];for(Q=0;Q<G.length;++Q){var P=31&G[Q];Yc(t,h,U[P]),h+=b[P],P>15&&(Yc(t,h,G[Q]>>>5&127),h+=G[Q]>>>12)}}}else M=qc,D=Oc,R=Vc,T=Hc;for(Q=0;Q<a;++Q)if(i[Q]>255){P=i[Q]>>>18&31;zc(t,h,M[P+257]),h+=D[P+257],P>7&&(Yc(t,h,i[Q]>>>23&31),h+=Mc[P]);var O=31&i[Q];zc(t,h,R[O]),h+=T[O],O>3&&(zc(t,h,i[Q]>>>5&8191),h+=Dc[O])}else zc(t,h,M[i[Q]]),h+=D[i[Q]];return zc(t,h,M[256]),h+D[256]},tu=new xc([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),su=new bc(0),iu=function(){for(var e=new xc(256),t=0;t<256;++t){for(var s=t,i=9;--i;)s=(1&s&&3988292384)^s>>>1;e[t]=s}return e}(),nu=function(){var e=-1;return{p:function(t){for(var s=e,i=0;i<t.length;++i)s=iu[255&s^t[i]]^s>>>8;e=s},d:function(){return~e}}},ru=function(e,t,s,i,n){return function(e,t,s,i,n,r){var o=e.length,a=new bc(i+o+5*(1+Math.ceil(o/7e3))+n),A=a.subarray(i,a.length-n),l=0;if(!t||o<8)for(var h=0;h<=o;h+=65535){var c=h+65535;c<o?l=Zc(A,l,e.subarray(h,c)):(A[h]=r,l=Zc(A,l,e.subarray(h,o)))}else{for(var u=tu[t-1],g=u>>>13,d=8191&u,p=(1<<s)-1,m=new Sc(32768),I=new Sc(p+1),f=Math.ceil(s/3),C=2*f,E=function(t){return(e[t]^e[t+1]<<f^e[t+2]<<C)&p},B=new xc(25e3),w=new Sc(288),y=new Sc(32),Q=0,v=0,b=(h=0,0),S=0,x=0;h<o;++h){var M=E(h),D=32767&h,R=I[M];if(m[D]=R,I[M]=D,S<=h){var T=o-h;if((Q>7e3||b>24576)&&T>423){l=eu(e,A,0,B,w,y,v,b,x,h-x,l),b=Q=v=0,x=h;for(var L=0;L<286;++L)w[L]=0;for(L=0;L<30;++L)y[L]=0}var F=2,k=0,U=d,_=D-R&32767;if(T>2&&M==E(h-_))for(var N=Math.min(g,T)-1,G=Math.min(32767,h),P=Math.min(258,T);_<=G&&--U&&D!=R;){if(e[h+F]==e[h+F-_]){for(var O=0;O<P&&e[h+O]==e[h+O-_];++O);if(O>F){if(F=O,k=_,O>N)break;var H=Math.min(_,O-2),q=0;for(L=0;L<H;++L){var V=h-_+L+32768&32767,J=V-m[V]+32768&32767;J>q&&(q=J,R=V)}}}_+=(D=R)-(R=m[D])+32768&32767}if(k){B[b++]=268435456|kc[F]<<18|Uc[k];var K=31&kc[F],Y=31&Uc[k];v+=Mc[K]+Dc[Y],++w[257+K],++y[Y],S=h+F,++Q}else B[b++]=e[h],++w[e[h]]}}l=eu(e,A,r,B,w,y,v,b,x,h-x,l),!r&&7&l&&(l=Zc(A,l+1,su))}return Kc(a,0,i+Jc(l)+n)}(e,null==t.level?6:t.level,null==t.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):12+t.mem,s,i,!n)},ou=function(e,t){var s={};for(var i in e)s[i]=e[i];for(var i in t)s[i]=t[i];return s},au=function(e,t,s){for(;s;++t)e[t]=s,s>>>=8};function Au(e,t){return ru(e,t||{},0,0)}var lu=function(e,t,s,i){for(var n in e){var r=e[n],o=t+n;r instanceof bc?s[o]=[r,i]:Array.isArray(r)?s[o]=[r[0],ou(i,r[1])]:lu(r,o+"/",s,i)}},hu="undefined"!=typeof TextEncoder&&new TextEncoder,cu="undefined"!=typeof TextDecoder&&new TextDecoder;try{cu.decode(su,{stream:!0}),1}catch(Mt){}function uu(e,t){if(t){for(var s=new bc(e.length),i=0;i<e.length;++i)s[i]=e.charCodeAt(i);return s}if(hu)return hu.encode(e);var n=e.length,r=new bc(e.length+(e.length>>1)),o=0,a=function(e){r[o++]=e};for(i=0;i<n;++i){if(o+5>r.length){var A=new bc(o+8+(n-i<<1));A.set(r),r=A}var l=e.charCodeAt(i);l<128||t?a(l):l<2048?(a(192|l>>6),a(128|63&l)):l>55295&&l<57344?(a(240|(l=65536+(1047552&l)|1023&e.charCodeAt(++i))>>18),a(128|l>>12&63),a(128|l>>6&63),a(128|63&l)):(a(224|l>>12),a(128|l>>6&63),a(128|63&l))}return Kc(r,0,o)}var gu=function(e){var t=0;if(e)for(var s in e){var i=e[s].length;if(i>65535)throw"extra field too long";t+=i+4}return t},du=function(e,t,s,i,n,r,o,a){var A=i.length,l=s.extra,h=a&&a.length,c=gu(l);au(e,t,null!=o?33639248:67324752),t+=4,null!=o&&(e[t++]=20,e[t++]=s.os),e[t]=20,t+=2,e[t++]=s.flag<<1|(null==r&&8),e[t++]=n&&8,e[t++]=255&s.compression,e[t++]=s.compression>>8;var u=new Date(null==s.mtime?Date.now():s.mtime),g=u.getFullYear()-1980;if(g<0||g>119)throw"date not in range 1980-2099";if(au(e,t,g<<25|u.getMonth()+1<<21|u.getDate()<<16|u.getHours()<<11|u.getMinutes()<<5|u.getSeconds()>>>1),t+=4,null!=r&&(au(e,t,s.crc),au(e,t+4,r),au(e,t+8,s.size)),au(e,t+12,A),au(e,t+14,c),t+=16,null!=o&&(au(e,t,h),au(e,t+6,s.attrs),au(e,t+10,o),t+=14),e.set(i,t),t+=A,c)for(var d in l){var p=l[d],m=p.length;au(e,t,+d),au(e,t+2,m),e.set(p,t+4),t+=4+m}return h&&(e.set(a,t),t+=h),t},pu=function(e,t,s,i,n){au(e,t,101010256),au(e,t+8,s),au(e,t+10,s),au(e,t+12,i),au(e,t+16,n)};class mu{async parse(e,t={}){t=Object.assign({ar:{anchoring:{type:"plane"},planeAnchoring:{alignment:"horizontal"}}},t);const s={},i="model.usda";s[i]=null;let n=Cu();n+=function(e){return`def Xform "Root"\n{\n    def Scope "Scenes" (\n        kind = "sceneLibrary"\n    )\n    {\n        def Xform "Scene" (\n            customData = {\n                bool preliminary_collidesWithEnvironment = 0\n                string sceneName = "Scene"\n            }\n            sceneName = "Scene"\n        )\n        {\n        token preliminary:anchoring:type = "${e.ar.anchoring.type}"\n        token preliminary:planeAnchoring:alignment = "${e.ar.planeAnchoring.alignment}"\n\n`}(t);const r={},o={};e.traverseVisible((e=>{if(e.isMesh){const t=e.geometry,i=e.material;if(i.isMeshStandardMaterial){const o="geometries/Geometry_"+t.id+".usd";if(!(o in s)){const e=function(e){const t=function(e){const t="Geometry",s=e.attributes,i=s.position.count;return`\n    def Mesh "${t}"\n    {\n        int[] faceVertexCounts = [${function(e){const t=null!==e.index?e.index.count:e.attributes.position.count;return Array(t/3).fill(3).join(", ")}(e)}]\n        int[] faceVertexIndices = [${function(e){const t=e.index,s=[];if(null!==t)for(let e=0;e<t.count;e++)s.push(t.getX(e));else{const t=e.attributes.position.count;for(let e=0;e<t;e++)s.push(e)}return s.join(", ")}(e)}]\n        normal3f[] normals = [${wu(s.normal,i)}] (\n            interpolation = "vertex"\n        )\n        point3f[] points = [${wu(s.position,i)}]\n        float2[] primvars:st = [${function(e,t){if(void 0===e)return console.warn("USDZExporter: UVs missing."),Array(t).fill("(0, 0)").join(", ");const s=[];for(let t=0;t<e.count;t++){const i=e.getX(t),n=e.getY(t);s.push(`(${i.toPrecision(fu)}, ${1-n.toPrecision(fu)})`)}return s.join(", ")}(s.uv,i)}] (\n            interpolation = "vertex"\n        )\n        uniform token subdivisionScheme = "none"\n    }\n`}(e);return`\ndef "Geometry"\n{\n  ${t}\n}\n`}(t);s[o]=function(e){let t=Cu();return t+=e,uu(t)}(e)}i.uuid in r||(r[i.uuid]=i),n+=function(e,t,s){const i="Object_"+e.id,n=Eu(e.matrixWorld);e.matrixWorld.determinant()<0&&console.warn("THREE.USDZExporter: USDZ does not support negative scales",e);return`def Xform "${i}" (\n    prepend references = @./geometries/Geometry_${t.id}.usd@</Geometry>\n)\n{\n    matrix4d xformOp:transform = ${n}\n    uniform token[] xformOpOrder = ["xformOp:transform"]\n\n    rel material:binding = </Materials/Material_${s.id}>\n}\n\n`}(e,t,i)}else console.warn("THREE.USDZExporter: Unsupported material type (USDZ only supports MeshStandardMaterial)",e)}else e.isCamera&&(n+=function(e){const t=e.name?e.name:"Camera_"+e.id,s=Eu(e.matrixWorld);e.matrixWorld.determinant()<0&&console.warn("THREE.USDZExporter: USDZ does not support negative scales",e);return e.isOrthographicCamera?`def Camera "${t}"\n\t\t{\n\t\t\tmatrix4d xformOp:transform = ${s}\n\t\t\tuniform token[] xformOpOrder = ["xformOp:transform"]\n\t\n\t\t\tfloat2 clippingRange = (${e.near.toPrecision(fu)}, ${e.far.toPrecision(fu)})\n\t\t\tfloat horizontalAperture = ${(10*(Math.abs(e.left)+Math.abs(e.right))).toPrecision(fu)}\n\t\t\tfloat verticalAperture = ${(10*(Math.abs(e.top)+Math.abs(e.bottom))).toPrecision(fu)}\n\t\t\ttoken projection = "orthographic"\n\t\t}\n\t\n\t`:`def Camera "${t}"\n\t\t{\n\t\t\tmatrix4d xformOp:transform = ${s}\n\t\t\tuniform token[] xformOpOrder = ["xformOp:transform"]\n\t\n\t\t\tfloat2 clippingRange = (${e.near.toPrecision(fu)}, ${e.far.toPrecision(fu)})\n\t\t\tfloat focalLength = ${e.getFocalLength().toPrecision(fu)}\n\t\t\tfloat focusDistance = ${e.focus.toPrecision(fu)}\n\t\t\tfloat horizontalAperture = ${e.getFilmWidth().toPrecision(fu)}\n\t\t\ttoken projection = "perspective"\n\t\t\tfloat verticalAperture = ${e.getFilmHeight().toPrecision(fu)}\n\t\t}\n\t\n\t`}
/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e))})),n+="\n        }\n    }\n}\n\n",n+=function(e,t){const s=[];for(const i in e){const n=e[i];s.push(yu(n,t))}return`def "Materials"\n{\n${s.join("")}\n}\n\n`}(r,o),s[i]=uu(n),n=null;for(const e in o){const t=o[e],i=e.split("_")[1],n=1023===t.format,r=Iu(t.image,i),a=await new Promise((e=>r.toBlob(e,n?"image/png":"image/jpeg",1)));s[`textures/Texture_${e}.${n?"png":"jpg"}`]=new Uint8Array(await a.arrayBuffer())}let a=0;for(const e in s){const t=s[e];a+=34+e.length;const i=63&a;if(4!==i){const n=new Uint8Array(64-i);s[e]=[t,{extra:{12345:n}}]}a=t.length}return function(e,t){t||(t={});var s={},i=[];lu(e,"",s,t);var n=0,r=0;for(var o in s){var a=s[o],A=a[0],l=a[1],h=0==l.level?0:8,c=(y=uu(o)).length,u=l.comment,g=u&&uu(u),d=g&&g.length,p=gu(l.extra);if(c>65535)throw"filename too long";var m=h?Au(A,l):A,I=m.length,f=nu();f.p(A),i.push(ou(l,{size:A.length,crc:f.d(),c:m,f:y,m:g,u:c!=o.length||g&&u.length!=d,o:n,compression:h})),n+=30+c+p+I,r+=76+2*(c+p)+(d||0)+I}for(var C=new bc(r+22),E=n,B=r-n,w=0;w<i.length;++w){var y=i[w];du(C,y.o,y,y.f,y.u,y.c.length);var Q=30+y.f.length+gu(y.extra);C.set(y.c,y.o+Q),du(C,n,y,y.f,y.u,y.c.length,y.o,y.m),n+=16+Q+(y.m?y.m.length:0)}return pu(C,n,i.length,B,E),C}(s,{level:0})}}function Iu(e,t){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const s=1024/Math.max(e.width,e.height),i=document.createElement("canvas");i.width=e.width*Math.min(1,s),i.height=e.height*Math.min(1,s);const n=i.getContext("2d");if(n.drawImage(e,0,0,i.width,i.height),void 0!==t){const e=parseInt(t,16),s=(e>>16&255)/255,r=(e>>8&255)/255,o=(255&e)/255,a=n.getImageData(0,0,i.width,i.height),A=a.data;for(let e=0;e<A.length;e+=4)A[e+0]=A[e+0]*s,A[e+1]=A[e+1]*r,A[e+2]=A[e+2]*o;n.putImageData(a,0,0)}return i}throw new Error("THREE.USDZExporter: No valid image data found. Unable to process texture.")}const fu=7;function Cu(){return'#usda 1.0\n(\n    customLayerData = {\n        string creator = "Three.js USDZExporter"\n    }\n    metersPerUnit = 1\n    upAxis = "Y"\n)\n\n'}function Eu(e){const t=e.elements;return`( ${Bu(t,0)}, ${Bu(t,4)}, ${Bu(t,8)}, ${Bu(t,12)} )`}function Bu(e,t){return`(${e[t+0]}, ${e[t+1]}, ${e[t+2]}, ${e[t+3]})`}function wu(e,t){if(void 0===e)return console.warn("USDZExporter: Normals missing."),Array(t).fill("(0, 0, 0)").join(", ");const s=[];for(let t=0;t<e.count;t++){const i=e.getX(t),n=e.getY(t),r=e.getZ(t);s.push(`(${i.toPrecision(fu)}, ${n.toPrecision(fu)}, ${r.toPrecision(fu)})`)}return s.join(", ")}function yu(e,t){const s="            ",i=[],n=[];function r(s,i,n){const r=s.id+(n?"_"+n.getHexString():""),o=1023===s.format;return t[r]=s,`\n        def Shader "Transform2d_${i}" (\n            sdrMetadata = {\n                string role = "math"\n            }\n        )\n        {\n            uniform token info:id = "UsdTransform2d"\n            float2 inputs:in.connect = </Materials/Material_${e.id}/uvReader_st.outputs:result>\n            float2 inputs:scale = ${vu(s.repeat)}\n            float2 inputs:translation = ${vu(s.offset)}\n            float2 outputs:result\n        }\n\n        def Shader "Texture_${s.id}_${i}"\n        {\n            uniform token info:id = "UsdUVTexture"\n            asset inputs:file = @textures/Texture_${r}.${o?"png":"jpg"}@\n            float2 inputs:st.connect = </Materials/Material_${e.id}/Transform2d_${i}.outputs:result>\n            token inputs:wrapS = "repeat"\n            token inputs:wrapT = "repeat"\n            float outputs:r\n            float outputs:g\n            float outputs:b\n            float3 outputs:rgb\n            ${e.transparent||e.alphaTest>0?"float outputs:a":""}\n        }`}return e.side===ne&&console.warn("THREE.USDZExporter: USDZ does not support double sided materials",e),null!==e.map?(i.push(`${s}color3f inputs:diffuseColor.connect = </Materials/Material_${e.id}/Texture_${e.map.id}_diffuse.outputs:rgb>`),e.transparent?i.push(`${s}float inputs:opacity.connect = </Materials/Material_${e.id}/Texture_${e.map.id}_diffuse.outputs:a>`):e.alphaTest>0&&(i.push(`${s}float inputs:opacity.connect = </Materials/Material_${e.id}/Texture_${e.map.id}_diffuse.outputs:a>`),i.push(`${s}float inputs:opacityThreshold = ${e.alphaTest}`)),n.push(r(e.map,"diffuse",e.color))):i.push(`${s}color3f inputs:diffuseColor = ${Qu(e.color)}`),null!==e.emissiveMap?(i.push(`${s}color3f inputs:emissiveColor.connect = </Materials/Material_${e.id}/Texture_${e.emissiveMap.id}_emissive.outputs:rgb>`),n.push(r(e.emissiveMap,"emissive"))):e.emissive.getHex()>0&&i.push(`${s}color3f inputs:emissiveColor = ${Qu(e.emissive)}`),null!==e.normalMap&&(i.push(`${s}normal3f inputs:normal.connect = </Materials/Material_${e.id}/Texture_${e.normalMap.id}_normal.outputs:rgb>`),n.push(r(e.normalMap,"normal"))),null!==e.aoMap&&(i.push(`${s}float inputs:occlusion.connect = </Materials/Material_${e.id}/Texture_${e.aoMap.id}_occlusion.outputs:r>`),n.push(r(e.aoMap,"occlusion"))),null!==e.roughnessMap&&1===e.roughness?(i.push(`${s}float inputs:roughness.connect = </Materials/Material_${e.id}/Texture_${e.roughnessMap.id}_roughness.outputs:g>`),n.push(r(e.roughnessMap,"roughness"))):i.push(`${s}float inputs:roughness = ${e.roughness}`),null!==e.metalnessMap&&1===e.metalness?(i.push(`${s}float inputs:metallic.connect = </Materials/Material_${e.id}/Texture_${e.metalnessMap.id}_metallic.outputs:b>`),n.push(r(e.metalnessMap,"metallic"))):i.push(`${s}float inputs:metallic = ${e.metalness}`),null!==e.alphaMap?(i.push(`${s}float inputs:opacity.connect = </Materials/Material_${e.id}/Texture_${e.alphaMap.id}_opacity.outputs:r>`),i.push(`${s}float inputs:opacityThreshold = 0.0001`),n.push(r(e.alphaMap,"opacity"))):i.push(`${s}float inputs:opacity = ${e.opacity}`),e.isMeshPhysicalMaterial&&(i.push(`${s}float inputs:clearcoat = ${e.clearcoat}`),i.push(`${s}float inputs:clearcoatRoughness = ${e.clearcoatRoughness}`),i.push(`${s}float inputs:ior = ${e.ior}`)),`\n    def Material "Material_${e.id}"\n    {\n        def Shader "PreviewSurface"\n        {\n            uniform token info:id = "UsdPreviewSurface"\n${i.join("\n")}\n            int inputs:useSpecularWorkflow = 0\n            token outputs:surface\n        }\n\n        token outputs:surface.connect = </Materials/Material_${e.id}/PreviewSurface.outputs:surface>\n        token inputs:frame:stPrimvarName = "st"\n\n        def Shader "uvReader_st"\n        {\n            uniform token info:id = "UsdPrimvarReader_float2"\n            token inputs:varname.connect = </Materials/Material_${e.id}.inputs:frame:stPrimvarName>\n            float2 inputs:fallback = (0.0, 0.0)\n            float2 outputs:result\n        }\n\n${n.join("\n")}\n\n    }\n`}function Qu(e){return`(${e.r}, ${e.g}, ${e.b})`}function vu(e){return`(${e.x}, ${e.y})`}
/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var bu=function(e,t,s,i){for(var n,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,s):i,a=e.length-1;a>=0;a--)(n=e[a])&&(o=(r<3?n(o):r>3?n(t,s,o):n(t,s))||o);return r>3&&o&&Object.defineProperty(t,s,o),o};let Su=!1,xu=!1;const Mu="#model-viewer-no-ar-fallback",Du=(Ru=["quick-look","scene-viewer","webxr","none"],e=>{try{const t=_r(e),s=(t.length?t[0].terms:[]).filter((e=>e&&"ident"===e.type)).map((e=>e.value)).filter((e=>Ru.indexOf(e)>-1)),i=new Set;for(const e of s)i.add(e);return i}catch(e){}return new Set});var Ru;const Tu="quick-look",Lu="scene-viewer",Fu="webxr",ku="none",Uu=Symbol("arButtonContainer"),_u=Symbol("enterARWithWebXR"),Nu=Symbol("openSceneViewer"),Gu=Symbol("openIOSARQuickLook"),Pu=Symbol("canActivateAR"),Ou=Symbol("arMode"),Hu=Symbol("arModes"),qu=Symbol("arAnchor"),Vu=Symbol("preload"),Ju=Symbol("onARButtonContainerClick"),Ku=Symbol("onARStatus"),Yu=Symbol("onARTracking"),zu=Symbol("onARTap"),ju=Symbol("selectARMode"),$u=Symbol("triggerLoad");
/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var Wu=function(e,t,s,i){for(var n,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,s):i,a=e.length-1;a>=0;a--)(n=e[a])&&(o=(r<3?n(o):r>3?n(t,s,o):n(t,s))||o);return r>3&&o&&Object.defineProperty(t,s,o),o};const Xu="auto",Zu="auto",eg="eager",tg=Symbol("defaultProgressBarElement"),sg=Symbol("posterContainerElement"),ig=Symbol("defaultPosterElement"),ng=Symbol("shouldDismissPoster"),rg=Symbol("hidePoster"),og=Symbol("modelIsRevealed"),ag=Symbol("updateProgressBar"),Ag=Symbol("ariaLabelCallToAction"),lg=Symbol("onProgress");
/* @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var hg=function(e,t,s,i){for(var n,r=arguments.length,o=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,s):i,a=e.length-1;a>=0;a--)(n=e[a])&&(o=(r<3?n(o):r>3?n(t,s,o):n(t,s))||o);return r>3&&o&&Object.defineProperty(t,s,o),o};const cg=Math.PI/32,ug={basis:[Kr(Ur(cg,"rad"))],keywords:{auto:[null]}},gg=Symbol("autoRotateStartTime"),dg=Symbol("radiansPerSecond"),pg=Symbol("syncRotationRate"),mg=Symbol("onCameraChange"),Ig=(e=>{var t,s,i;class n extends e{constructor(){super(...arguments),this[t]=new Map,this[s]=e=>{e.forEach((e=>{e instanceof MutationRecord&&"childList"!==e.type||(e.addedNodes.forEach((e=>{this[wc](e)})),e.removedNodes.forEach((e=>{this[yc](e)})),this[ic]())}))},this[i]=new MutationObserver(this[Ec])}connectedCallback(){super.connectedCallback();for(let e=0;e<this.children.length;++e)this[wc](this.children[e]);const{ShadyDOM:e}=self;null==e?this[Bc].observe(this,{childList:!0}):this[Bc]=e.observeChildren(this,this[Ec])}disconnectedCallback(){super.disconnectedCallback();const{ShadyDOM:e}=self;null==e?this[Bc].disconnect():e.unobserveChildren(this[Bc])}[(t=Cc,s=Ec,i=Bc,nc)](e,t){super[nc](e,t);const s=this[sc],{annotationRenderer:i}=s,n=s.getCamera();s.shouldRender()&&(s.updateSurfaceHotspots(),s.updateHotspotsVisibility(n.position),i.domElement.style.display="",i.render(s,n))}updateHotspot(e){const t=this[Cc].get(e.name);null!=t&&(t.updatePosition(e.position),t.updateNormal(e.normal),t.surface=e.surface,this[ic]())}queryHotspot(e){const t=this[Cc].get(e);if(null==t)return null;const s=uc(t.position),i=uc(t.normal),n=t.facingCamera,r=this[sc],o=r.getCamera(),a=new g;a.setFromMatrixPosition(t.matrixWorld),a.project(o);const A=r.width/2,l=r.height/2;a.x=a.x*A+A,a.y=-a.y*l+l;const h=uc(new g(a.x,a.y,a.z));return Number.isFinite(h.x)&&Number.isFinite(h.y)?{position:s,normal:i,canvasPosition:h,facingCamera:n}:null}positionAndNormalFromPoint(e,t){const s=this[sc],i=s.getNDC(e,t),n=s.positionAndNormalFromPoint(i);if(null==n)return null;Qc.copy(s.target.matrixWorld).invert();const r=uc(n.position.applyMatrix4(Qc)),o=uc(n.normal.transformDirection(Qc));let a=null;return null!=n.uv&&(a=gc(n.uv)),{position:r,normal:o,uv:a}}surfaceFromPoint(e,t){const s=this[sc],i=s.getNDC(e,t);return s.surfaceFromPoint(i)}[wc](e){if(!(e instanceof HTMLElement&&0===e.slot.indexOf("hotspot")))return;let t=this[Cc].get(e.slot);null!=t?t.increment():(t=new rh({name:e.slot,position:e.dataset.position,normal:e.dataset.normal,surface:e.dataset.surface}),this[Cc].set(e.slot,t),this[sc].addHotspot(t)),this[sc].queueRender()}[yc](e){if(!(e instanceof HTMLElement))return;const t=this[Cc].get(e.slot);t&&(t.decrement()&&(this[sc].removeHotspot(t),this[Cc].delete(e.slot)),this[sc].queueRender())}}return n})((e=>{var t,s,i;class n extends e{constructor(){super(...arguments),this[t]=void 0,this[s]=null,this[i]=null,this.variantName=null,this.orientation="0 0 0",this.scale="1 1 1"}get model(){return this[$l]}get availableVariants(){return this.model?this.model[Hl]():[]}get originalGltfJson(){return this[jl]}[(t=$l,s=zl,i=jl,Wl)](){return()=>{this[ic]()}}[Xl](e){return e.encoding=L,e.wrapS=Z,e.wrapT=Z,new qA(this[Wl](),e)}async createTexture(e,t="image/png"){const{textureUtils:s}=this[ac],i=await s.loadImage(e);return i.userData.mimeType=t,this[Xl](i)}async createLottieTexture(e,t=1){const{textureUtils:s}=this[ac],i=await s.loadLottie(e,t);return this[Xl](i)}createVideoTexture(e){const t=document.createElement("video");t.src=e,t.muted=!0,t.playsInline=!0,t.loop=!0,t.play();const s=new ke(t);return this[Xl](s)}createCanvasTexture(){const e=document.createElement("canvas"),t=new Ue(e);return this[Xl](t)}async updated(e){if(super.updated(e),e.has("variantName")){const e=this[Ac].beginActivity();e(.1);const t=this[$l],{variantName:s}=this;null!=t&&(await t[_l](s),this[ic](),this.dispatchEvent(new CustomEvent("variant-applied"))),e(1)}if(e.has("orientation")||e.has("scale")){if(!this.loaded)return;const e=this[sc];e.applyTransform(),e.updateBoundingBox(),e.updateShadow(),this[ac].arRenderer.onUpdateScene(),this[ic]()}}[rc](){super[rc]();const{currentGLTF:e}=this[sc];if(null!=e){const{correlatedSceneGraph:t}=e;null!=t&&e!==this[zl]&&(this[$l]=new Kl(t,this[Wl]()),this[jl]=JSON.parse(JSON.stringify(t.gltf))),"variants"in e.userData&&this.requestUpdate("variantName")}this[zl]=e}async exportScene(e){const t=this[sc];return new Promise((async(s,i)=>{const n={binary:!0,onlyVisible:!0,maxTextureSize:1/0,includeCustomExtensions:!1,forceIndices:!1};Object.assign(n,e),n.animations=t.animations,n.truncateDrawRange=!0;const r=t.shadow;let o=!1;null!=r&&(o=r.visible,r.visible=!1),await this[$l][Ul]();(new kn).register((e=>new Sr(e))).parse(t.model,(e=>s(new Blob([n.binary?e:JSON.stringify(e)],{type:n.binary?"application/octet-stream":"application/json"}))),(()=>i("glTF export failed")),n),null!=r&&(r.visible=o)}))}materialFromPoint(e,t){const s=this[$l];if(null==s)return null;const i=this[sc],n=i.getNDC(e,t),r=i.hitFromPoint(n);return null==r||null==r.face?null:s[Nl](r)}}return Yl([lt({type:String,attribute:"variant-name"})],n.prototype,"variantName",void 0),Yl([lt({type:String,attribute:"orientation"})],n.prototype,"orientation",void 0),Yl([lt({type:String,attribute:"scale"})],n.prototype,"scale",void 0),n})((e=>{var t,s,i;class n extends e{constructor(){super(...arguments),this.autoRotate=!1,this.autoRotateDelay=3e3,this.rotationPerSecond="auto",this[t]=performance.now(),this[s]=0,this[i]=e=>{this.autoRotate&&"user-interaction"===e.detail.source&&(this[gg]=performance.now())}}connectedCallback(){super.connectedCallback(),this.addEventListener("camera-change",this[mg]),this[gg]=performance.now()}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("camera-change",this[mg]),this[gg]=performance.now()}updated(e){super.updated(e),e.has("autoRotate")&&(this[gg]=performance.now())}[(t=gg,s=dg,pg)](e){this[dg]=e[0]}[nc](e,t){if(super[nc](e,t),!this.autoRotate||!this[hc]()||this[ac].isPresenting)return;const s=Math.min(t,e-this[gg]-this.autoRotateDelay);s>0&&(this[sc].yaw=this.turntableRotation+this[dg]*s*.001)}get turntableRotation(){return this[sc].yaw}resetTurntableRotation(e=0){this[sc].yaw=e}}return i=mg,hg([lt({type:Boolean,attribute:"auto-rotate"})],n.prototype,"autoRotate",void 0),hg([lt({type:Number,attribute:"auto-rotate-delay"})],n.prototype,"autoRotateDelay",void 0),hg([Lo({intrinsics:ug,updateHandler:pg}),lt({type:String,attribute:"rotation-per-second"})],n.prototype,"rotationPerSecond",void 0),n})((e=>{var t,s,i;class n extends e{constructor(){super(...arguments),this.environmentImage=null,this.skyboxImage=null,this.shadowIntensity=0,this.shadowSoftness=1,this.exposure=1,this[t]=null,this[s]=null,this[i]=null}updated(e){super.updated(e),e.has("shadowIntensity")&&(this[sc].setShadowIntensity(.5*this.shadowIntensity),this[ic]()),e.has("shadowSoftness")&&(this[sc].setShadowSoftness(this.shadowSoftness),this[ic]()),e.has("exposure")&&(this[sc].exposure=this.exposure,this[ic]()),(e.has("environmentImage")||e.has("skyboxImage"))&&this[cc]()&&this[Fs]()}hasBakedShadow(){return this[sc].bakedShadows.size>0}async[(t=Ts,s=Ls,i=ks,Fs)](){const{skyboxImage:e,environmentImage:t}=this;null!=this[ks]&&(this[ks](),this[ks]=null);const{textureUtils:s}=this[ac];if(null==s)return;const i=this[Ac].beginActivity();try{const{environmentMap:n,skybox:r}=await s.generateEnvironmentMapAndSkybox(Qs(e),t,(e=>i(xs(e,0,1))));this[Ts]!==n&&(this[Ts]=n,this.dispatchEvent(new CustomEvent("environment-change"))),this[Ls]=null!=r?r.name===n.name?n:r:null,this[sc].setEnvironmentAndSkybox(this[Ts],this[Ls]),this[sc].dispatchEvent({type:"envmap-update"})}catch(e){if(e instanceof Error)throw this[sc].setEnvironmentAndSkybox(null,null),e}finally{i(1)}}}return Rs([lt({type:String,attribute:"environment-image"})],n.prototype,"environmentImage",void 0),Rs([lt({type:String,attribute:"skybox-image"})],n.prototype,"skyboxImage",void 0),Rs([lt({type:Number,attribute:"shadow-intensity"})],n.prototype,"shadowIntensity",void 0),Rs([lt({type:Number,attribute:"shadow-softness"})],n.prototype,"shadowSoftness",void 0),Rs([lt({type:Number})],n.prototype,"exposure",void 0),n})((e=>{var t,s,i,n,r,o,a,A,l,h,c,u,g,d,p,m,I;class f extends e{constructor(){super(...arguments),this.cameraControls=!1,this.cameraOrbit=Po,this.cameraTarget="auto auto auto",this.fieldOfView="auto",this.minCameraOrbit="auto",this.maxCameraOrbit="auto",this.minFieldOfView="auto",this.maxFieldOfView="auto",this.interactionPromptThreshold=3e3,this.interactionPrompt=qo,this.interactionPromptStyle=Jo,this.orbitSensitivity=1,this.touchAction=Ko,this.disableZoom=!1,this.disablePan=!1,this.disableTap=!1,this.interpolationDecay=50,this[t]=this.shadowRoot.querySelector(".interaction-prompt"),this[s]=this.shadowRoot.querySelector("#prompt"),this[i]=[this.shadowRoot.querySelector("#finger0"),this.shadowRoot.querySelector("#finger1")],this[n]=this.shadowRoot.querySelector(".pan-target"),this[r]=0,this[o]=1/0,this[a]=!1,this[A]=!1,this[l]=ka.AUTOMATIC,this[h]=new Ua(this[sc].camera,this[ec],this[sc]),this[c]=new Be,this[u]=!1,this[g]=!1,this[d]=!1,this[p]=()=>{const e=this[ia].changeSource;this[fa]=e,e===ka.USER_INTERACTION&&(this[pa]=!0,this[Aa]())},this[m]=()=>{this[la](),this[ic]();const e=this[ia].changeSource;this.dispatchEvent(new CustomEvent("camera-change",{detail:{source:e}}))},this[I]=e=>{"pointer-change-start"===e.type?this[Zh].classList.add("pointer-tumbling"):this[Zh].classList.remove("pointer-tumbling")}}get inputSensitivity(){return this[ia].inputSensitivity}set inputSensitivity(e){this[ia].inputSensitivity=e}getCameraOrbit(){const{theta:e,phi:t,radius:s}=this[Ca];return{theta:e,phi:t,radius:s,toString(){return`${this.theta}rad ${this.phi}rad ${this.radius}m`}}}getCameraTarget(){return uc(this[ac].isPresenting?this[ac].arRenderer.target:this[sc].getTarget())}getFieldOfView(){return this[ia].getFieldOfView()}getMinimumFieldOfView(){return this[ia].options.minimumFieldOfView}getMaximumFieldOfView(){return this[ia].options.maximumFieldOfView}getIdealAspect(){return this[sc].idealAspect}jumpCameraToGoal(){this[Ea]=!0,this.requestUpdate(Ea,!1)}resetInteractionPrompt(){this[Ia]=0,this[ma]=1/0,this[pa]=!1,this[da]=this.interactionPrompt===qo&&this.cameraControls}zoom(e){const t=new WheelEvent("wheel",{deltaY:-30*e});this[ec].dispatchEvent(t)}connectedCallback(){super.connectedCallback(),this[ia].addEventListener("user-interaction",this[ca]),this[ia].addEventListener("pointer-change-start",this[ga]),this[ia].addEventListener("pointer-change-end",this[ga])}disconnectedCallback(){super.disconnectedCallback(),this[ia].removeEventListener("user-interaction",this[ca]),this[ia].removeEventListener("pointer-change-start",this[ga]),this[ia].removeEventListener("pointer-change-end",this[ga])}updated(e){super.updated(e);const t=this[ia],s=this[sc];if(e.has("cameraControls")&&(this.cameraControls?(t.enableInteraction(),this.interactionPrompt===qo&&(this[da]=!0)):(t.disableInteraction(),this[Aa]()),this[ec].setAttribute("aria-label",this[Kh])),e.has("disableZoom")&&(t.disableZoom=this.disableZoom),e.has("disablePan")&&(t.enablePan=!this.disablePan),e.has("disableTap")&&(t.enableTap=!this.disableTap),(e.has("interactionPrompt")||e.has("cameraControls")||e.has("src"))&&(this.interactionPrompt===qo&&this.cameraControls&&!this[pa]?this[da]=!0:this[Aa]()),e.has("interactionPromptStyle")&&(this[oa].style.opacity=this.interactionPromptStyle==Vo?"1":"0"),e.has("touchAction")){const e=this.touchAction;t.applyOptions({touchAction:e}),t.updateTouchActionStyle()}e.has("orbitSensitivity")&&(t.orbitSensitivity=this.orbitSensitivity),e.has("interpolationDecay")&&(t.setDamperDecayTime(this.interpolationDecay),s.setTargetDamperDecayTime(this.interpolationDecay)),!0===this[Ea]&&Promise.resolve().then((()=>{t.jumpToGoal(),s.jumpToGoal(),this[ua](),this[Ea]=!1}))}async updateFraming(){const e=this[sc],t=e.adjustedFoV(e.framedFoVDeg);await e.updateFraming();const s=e.adjustedFoV(e.framedFoVDeg),i=this[ia].getFieldOfView()/t;this[ia].setFieldOfView(s*i),this[wa]=!0,this.requestUpdate("maxFieldOfView"),this.requestUpdate("fieldOfView"),this.requestUpdate("minCameraOrbit"),this.requestUpdate("maxCameraOrbit"),this.requestUpdate("cameraOrbit"),await this.updateComplete}interact(e,t,s){const i=this[ec],n=this[aa];if("1"===n[0].style.opacity)return void console.warn("interact() failed because an existing interaction is running.");const r=new Array;r.push({x:Uo(t.x),y:Uo(t.y)});const o=[{x:r[0].x(0),y:r[0].y(0)}];null!=s&&(r.push({x:Uo(s.x),y:Uo(s.y)}),o.push({x:r[1].x(0),y:r[1].y(0)}));let a=performance.now();const{width:A,height:l}=this[sc],h=e=>{for(const[t,s]of o.entries()){const{style:r}=n[t];r.transform=`translateX(${A*s.x}px) translateY(${l*s.y}px)`,"pointerdown"===e?r.opacity="1":"pointerup"===e&&(r.opacity="0");const o={pointerId:t-5678,pointerType:"touch",target:i,clientX:A*s.x,clientY:l*s.y,altKey:!0};i.dispatchEvent(new PointerEvent(e,o))}},c=()=>{const t=this[fa];if(t!==ka.AUTOMATIC||!i.isConnected){for(const e of this[aa])e.style.opacity="0";return h("pointercancel"),this.dispatchEvent(new CustomEvent("interact-stopped",{detail:{source:t}})),void document.removeEventListener("visibilitychange",u)}const s=Math.min(1,(performance.now()-a)/e);for(const[e,t]of o.entries())t.x=r[e].x(s),t.y=r[e].y(s);h("pointermove"),s<1?requestAnimationFrame(c):(h("pointerup"),this.dispatchEvent(new CustomEvent("interact-stopped",{detail:{source:ka.AUTOMATIC}})),document.removeEventListener("visibilitychange",u))},u=()=>{let e=0;"hidden"===document.visibilityState?e=performance.now()-a:a=performance.now()-e};document.addEventListener("visibilitychange",u),h("pointerdown"),this[fa]=ka.AUTOMATIC,requestAnimationFrame(c)}[(t=ra,s=oa,i=aa,n=na,r=Ia,o=ma,a=pa,A=da,l=fa,h=ia,c=Ca,u=Ea,g=Ba,d=wa,Qa)](e){const t=this[ia],s=this[sc];s.framedFoVDeg=180*e[0]/Math.PI,t.changeSource=ka.NONE,t.setFieldOfView(s.adjustedFoV(s.framedFoVDeg)),this[ca]()}[ya](e){const t=this[ia];if(this[wa]){const{theta:t,phi:s}=this.getCameraOrbit();e[0]=t,e[1]=s,this[wa]=!1}t.changeSource=ka.NONE,t.setOrbit(e[0],e[1],e[2]),this[ca]()}[ba](e){this[ia].applyOptions({minimumAzimuthalAngle:e[0],minimumPolarAngle:e[1],minimumRadius:e[2]}),this.jumpCameraToGoal()}[Sa](e){this[ia].applyOptions({maximumAzimuthalAngle:e[0],maximumPolarAngle:e[1],maximumRadius:e[2]}),this[ha](e[2]),this.jumpCameraToGoal()}[xa](e){this[ia].applyOptions({minimumFieldOfView:180*e[0]/Math.PI}),this.jumpCameraToGoal()}[Ma](e){const t=this[sc].adjustedFoV(180*e[0]/Math.PI);this[ia].applyOptions({maximumFieldOfView:t}),this.jumpCameraToGoal()}[va](e){const[t,s,i]=e;this[ac].arRenderer.isPresenting||this[sc].setTarget(t,s,i),this[ia].changeSource=ka.NONE,this[ac].arRenderer.updateTarget(),this[ca]()}[nc](e,t){if(super[nc](e,t),this[ac].isPresenting||!this[hc]())return;const s=this[ia],i=this[sc],n=performance.now();if(this[da]&&this.loaded&&n>this[$h]+this.interactionPromptThreshold&&(this[da]=!1,this[ma]=n,this[ra].classList.add("visible")),isFinite(this[ma])&&this.interactionPromptStyle===Jo){const e=(n-this[ma])/5e3%1,t=No(e),r=Go(e);if(this[oa].style.opacity=`${r}`,t!==this[Ia]){const e=t*i.width*.05,n=(t-this[Ia])*Math.PI/16;this[oa].style.transform=`translateX(${e}px)`,s.changeSource=ka.AUTOMATIC,s.adjustOrbit(n,0,0),this[Ia]=t}}const r=s.update(e,t),o=i.updateTarget(t);(r||o)&&this[ua]()}[Aa](){this[da]=!1,this[ra].classList.remove("visible"),this[ma]=1/0}[ha](e){const t=Math.max(this[sc].boundingSphere.radius,e),s=Math.abs(2*t);this[ia].updateNearFar(0,s)}[la](){const{theta:e,phi:t}=this[ia].getCameraSpherical(this[Ca]),s=(4+Math.floor((e%sa+ta)/Zo))%4,i=Math.floor(t/ea),n=Oo[s],r=Ho[i];this[jh](`View from stage ${r}${n}`)}get[Kh](){return super[Kh]+(this.cameraControls?". Use mouse, touch or arrow keys to move.":"")}async[oc](e){const t=this[ia],s=this[sc],i=s.adjustedFoV(s.framedFoVDeg);super[oc](e);const n=s.adjustedFoV(s.framedFoVDeg)/i,r=t.getFieldOfView()*(isFinite(n)?n:1);t.updateAspect(this[sc].aspect),this.requestUpdate("maxFieldOfView",this.maxFieldOfView),await this.updateComplete,this[ia].setFieldOfView(r),this.jumpCameraToGoal()}[rc](){super[rc](),this[Ba]?this[wa]=!0:this[Ba]=!0,this.requestUpdate("maxFieldOfView",this.maxFieldOfView),this.requestUpdate("fieldOfView",this.fieldOfView),this.requestUpdate("minCameraOrbit",this.minCameraOrbit),this.requestUpdate("maxCameraOrbit",this.maxCameraOrbit),this.requestUpdate("cameraOrbit",this.cameraOrbit),this.requestUpdate("cameraTarget",this.cameraTarget),this.jumpCameraToGoal()}}return p=ca,m=ua,I=ga,_o([lt({type:Boolean,attribute:"camera-controls"})],f.prototype,"cameraControls",void 0),_o([Lo({intrinsics:jo,observeEffects:!0,updateHandler:ya}),lt({type:String,attribute:"camera-orbit",hasChanged:()=>!0})],f.prototype,"cameraOrbit",void 0),_o([Lo({intrinsics:Xo,observeEffects:!0,updateHandler:va}),lt({type:String,attribute:"camera-target",hasChanged:()=>!0})],f.prototype,"cameraTarget",void 0),_o([Lo({intrinsics:Yo,observeEffects:!0,updateHandler:Qa}),lt({type:String,attribute:"field-of-view",hasChanged:()=>!0})],f.prototype,"fieldOfView",void 0),_o([Lo({intrinsics:$o,updateHandler:ba}),lt({type:String,attribute:"min-camera-orbit",hasChanged:()=>!0})],f.prototype,"minCameraOrbit",void 0),_o([Lo({intrinsics:Wo,updateHandler:Sa}),lt({type:String,attribute:"max-camera-orbit",hasChanged:()=>!0})],f.prototype,"maxCameraOrbit",void 0),_o([Lo({intrinsics:zo,updateHandler:xa}),lt({type:String,attribute:"min-field-of-view",hasChanged:()=>!0})],f.prototype,"minFieldOfView",void 0),_o([Lo({intrinsics:Yo,updateHandler:Ma}),lt({type:String,attribute:"max-field-of-view",hasChanged:()=>!0})],f.prototype,"maxFieldOfView",void 0),_o([lt({type:Number,attribute:"interaction-prompt-threshold"})],f.prototype,"interactionPromptThreshold",void 0),_o([lt({type:String,attribute:"interaction-prompt"})],f.prototype,"interactionPrompt",void 0),_o([lt({type:String,attribute:"interaction-prompt-style"})],f.prototype,"interactionPromptStyle",void 0),_o([lt({type:Number,attribute:"orbit-sensitivity"})],f.prototype,"orbitSensitivity",void 0),_o([lt({type:String,attribute:"touch-action"})],f.prototype,"touchAction",void 0),_o([lt({type:Boolean,attribute:"disable-zoom"})],f.prototype,"disableZoom",void 0),_o([lt({type:Boolean,attribute:"disable-pan"})],f.prototype,"disablePan",void 0),_o([lt({type:Boolean,attribute:"disable-tap"})],f.prototype,"disableTap",void 0),_o([lt({type:Number,attribute:"interpolation-decay"})],f.prototype,"interpolationDecay",void 0),f})((e=>{var t,s,i,n,r,o,a,A,l,h;class c extends e{constructor(){super(...arguments),this.ar=!1,this.arScale="auto",this.arPlacement="floor",this.arModes="webxr scene-viewer quick-look",this.iosSrc=null,this.xrEnvironment=!1,this[t]=!1,this[s]=this.shadowRoot.querySelector(".ar-button"),this[i]=document.createElement("a"),this[n]=new Set,this[r]=ku,this[o]=!1,this[a]=e=>{e.preventDefault(),this.activateAR()},this[A]=({status:e})=>{e!==_a&&this[ac].arRenderer.presentedScene!==this[sc]||(this.setAttribute("ar-status",e),this.dispatchEvent(new CustomEvent("ar-status",{detail:{status:e}})),e===_a?this.removeAttribute("ar-tracking"):e===Na&&this.setAttribute("ar-tracking",Oa))},this[l]=({status:e})=>{this.setAttribute("ar-tracking",e),this.dispatchEvent(new CustomEvent("ar-tracking",{detail:{status:e}}))},this[h]=e=>{"_apple_ar_quicklook_button_tapped"==e.data&&this.dispatchEvent(new CustomEvent("quick-look-button-tapped"))}}get canActivateAR(){return this[Ou]!==ku}connectedCallback(){super.connectedCallback(),this[ac].arRenderer.addEventListener("status",this[Ku]),this.setAttribute("ar-status",_a),this[ac].arRenderer.addEventListener("tracking",this[Yu]),this[qu].addEventListener("message",this[zu])}disconnectedCallback(){super.disconnectedCallback(),this[ac].arRenderer.removeEventListener("status",this[Ku]),this[ac].arRenderer.removeEventListener("tracking",this[Yu]),this[qu].removeEventListener("message",this[zu])}update(e){super.update(e),e.has("arScale")&&(this[sc].canScale="fixed"!==this.arScale),e.has("arPlacement")&&(this[sc].updateShadow(),this[ic]()),e.has("arModes")&&(this[Hu]=Du(this.arModes)),(e.has("ar")||e.has("arModes")||e.has("src")||e.has("iosSrc"))&&this[ju]()}async activateAR(){switch(this[Ou]){case Tu:this[Gu]();break;case Fu:await this[_u]();break;case Lu:this[Nu]();break;default:console.warn("No AR Mode can be activated. This is probably due to missing configuration or device capabilities")}}async[(t=Pu,s=Uu,i=qu,n=Hu,r=Ou,o=Vu,a=Ju,A=Ku,l=Yu,h=zu,ju)](){let e=ku;if(this.ar){if(null!=this.src)for(const t of this[Hu]){if("webxr"===t&&ms&&!Su&&await this[ac].arRenderer.supportsPresentation()){e=Fu;break}if("scene-viewer"===t&&Bs&&!xu){e=Lu;break}if("quick-look"===t&&ys){e=Tu;break}}e===ku&&null!=this.iosSrc&&ys&&(e=Tu)}if(e!==ku)this[Uu].classList.add("enabled"),this[Uu].addEventListener("click",this[Ju]);else if(this[Uu].classList.contains("enabled")){this[Uu].removeEventListener("click",this[Ju]),this[Uu].classList.remove("enabled");const e=Pa;this.setAttribute("ar-status",e),this.dispatchEvent(new CustomEvent("ar-status",{detail:{status:e}}))}this[Ou]=e}async[_u](){console.log("Attempting to present in AR with WebXR..."),await this[$u]();try{this[Uu].removeEventListener("click",this[Ju]);const{arRenderer:e}=this[ac];e.placeOnWall="wall"===this.arPlacement,await e.present(this[sc],this.xrEnvironment)}catch(e){console.warn("Error while trying to present in AR with WebXR"),console.error(e),await this[ac].arRenderer.stopPresenting(),Su=!0,console.warn("Falling back to next ar-mode"),await this[ju](),this.activateAR()}finally{this[ju]()}}async[$u](){this.loaded||(this[Vu]=!0,this[Wh](),await((e,t,s=null)=>new Promise((i=>{e.addEventListener(t,(function n(r){s&&!s(r)||(i(r),e.removeEventListener(t,n))}))})))(this,"load"),this[Vu]=!1)}[cc](){return super[cc]()||this[Vu]}[Nu](){const e=self.location.toString(),t=new URL(e),s=new URL(this.src,e);s.hash&&(s.hash="");const i=new URLSearchParams(s.search);if(t.hash=Mu,i.set("mode","ar_preferred"),i.has("disable_occlusion")||i.set("disable_occlusion","true"),"fixed"===this.arScale&&i.set("resizable","false"),"wall"===this.arPlacement&&i.set("enable_vertical_placement","true"),i.has("sound")){const t=new URL(i.get("sound"),e);i.set("sound",t.toString())}if(i.has("link")){const t=new URL(i.get("link"),e);i.set("link",t.toString())}const n=`intent://arvr.google.com/scene-viewer/1.0?${i.toString()+"&file="+encodeURIComponent(s.toString())}#Intent;scheme=https;package=com.google.ar.core;action=android.intent.action.VIEW;S.browser_fallback_url=${encodeURIComponent(t.toString())};end;`;self.addEventListener("hashchange",(()=>{self.location.hash===Mu&&(xu=!0,self.history.back(),console.warn("Error while trying to present in AR with Scene Viewer"),console.warn("Falling back to next ar-mode"),this[ju]())}),{once:!0}),this[qu].setAttribute("href",n),console.log("Attempting to present in AR with Scene Viewer..."),this[qu].click()}async[Gu](){const e=!this.iosSrc;this[Uu].classList.remove("enabled");const t=e?await this.prepareUSDZ():this.iosSrc,s=new URL(t,self.location.toString());if(e){const e=self.location.toString(),t=new URL(e),i=new URL(this.src,t);i.hash&&(s.hash=i.hash)}"fixed"===this.arScale&&(s.hash&&(s.hash+="&"),s.hash+="allowsContentScaling=0");const i=this[qu];i.setAttribute("rel","ar");const n=document.createElement("img");i.appendChild(n),i.setAttribute("href",s.toString()),e&&i.setAttribute("download","model.usdz"),i.style.display="none",i.isConnected||this.shadowRoot.appendChild(i),console.log("Attempting to present in AR with Quick Look..."),i.click(),i.removeChild(n),e&&URL.revokeObjectURL(t),this[Uu].classList.add("enabled")}async prepareUSDZ(){const e=this[Ac].beginActivity();await this[$u]();const{model:t,shadow:s}=this[sc];if(null==t)return"";let i=!1;null!=s&&(i=s.visible,s.visible=!1),e(.2);const n=new mu,r=await n.parse(t),o=new Blob([r],{type:"model/vnd.usdz+zip"}),a=URL.createObjectURL(o);return e(1),null!=s&&(s.visible=i),a}}return bu([lt({type:Boolean,attribute:"ar"})],c.prototype,"ar",void 0),bu([lt({type:String,attribute:"ar-scale"})],c.prototype,"arScale",void 0),bu([lt({type:String,attribute:"ar-placement"})],c.prototype,"arPlacement",void 0),bu([lt({type:String,attribute:"ar-modes"})],c.prototype,"arModes",void 0),bu([lt({type:String,attribute:"ios-src"})],c.prototype,"iosSrc",void 0),bu([lt({type:Boolean,attribute:"xr-environment"})],c.prototype,"xrEnvironment",void 0),c})((e=>{var t,s,i,n,r,o,a,A;class l extends e{constructor(...e){super(...e),this.poster=null,this.reveal=Xu,this.loading=Zu,this[t]=!1,this[s]=!1,this[i]=this.shadowRoot.querySelector(".slot.poster"),this[n]=this.shadowRoot.querySelector("#default-poster"),this[r]=this.shadowRoot.querySelector("#default-progress-bar > .bar"),this[o]=this[ig].getAttribute("aria-label"),this[a]=((e,t)=>{let s=null;const i=(...i)=>{null==s&&(e(...i),s=self.setTimeout((()=>s=null),t))};return i.flush=()=>{null!=s&&(self.clearTimeout(s),s=null)},i})((e=>{const t=this[tg].parentNode;requestAnimationFrame((()=>{this[tg].style.transform=`scaleX(${e})`,0===e&&(t.removeChild(this[tg]),t.appendChild(this[tg])),1===e?this[tg].classList.add("hide"):this[tg].classList.remove("hide")}))}),100),this[A]=e=>{const t=e.detail.totalProgress;1===t&&(this[ag].flush(),this.loaded&&(this[ng]||this.reveal===Xu)&&this[rg]()),this[ag](t),this.dispatchEvent(new CustomEvent("progress",{detail:{totalProgress:t}}))};const l=self.ModelViewerElement||{},h=l.dracoDecoderLocation||"https://www.gstatic.com/draco/versioned/decoders/1.5.6/";vn.setDRACODecoderLocation(h);const c=l.ktx2TranscoderLocation||"https://www.gstatic.com/basis-universal/versioned/2021-04-15-ba1c3e4/";vn.setKTX2TranscoderLocation(c),l.meshoptDecoderLocation&&vn.setMeshoptDecoderLocation(l.meshoptDecoderLocation);const u=l.lottieLoaderLocation||"https://cdn.jsdelivr.net/npm/three@0.149.0/examples/jsm/loaders/LottieLoader.js";wA.singleton.textureUtils.lottieLoaderUrl=u}static set dracoDecoderLocation(e){vn.setDRACODecoderLocation(e)}static get dracoDecoderLocation(){return vn.getDRACODecoderLocation()}static set ktx2TranscoderLocation(e){vn.setKTX2TranscoderLocation(e)}static get ktx2TranscoderLocation(){return vn.getKTX2TranscoderLocation()}static set meshoptDecoderLocation(e){vn.setMeshoptDecoderLocation(e)}static get meshoptDecoderLocation(){return vn.getMeshoptDecoderLocation()}static set lottieLoaderLocation(e){wA.singleton.textureUtils.lottieLoaderUrl=e}static get lottieLoaderLocation(){return wA.singleton.textureUtils.lottieLoaderUrl}static mapURLs(e){wA.singleton.loader[wn].manager.setURLModifier(e)}dismissPoster(){this.loaded?this[rg]():(this[ng]=!0,this[Wh]())}showPoster(){const e=this[sg];if(e.classList.contains("show"))return;e.classList.add("show"),this[ec].classList.remove("show");const t=this[ig];t.removeAttribute("tabindex"),t.removeAttribute("aria-hidden");const s=this.modelIsVisible;this[og]=!1,this[Jh](s)}getDimensions(){return uc(this[sc].size)}getBoundingBoxCenter(){return uc(this[sc].boundingBox.getCenter(new g))}connectedCallback(){super.connectedCallback(),this.loaded||this.showPoster(),this[Ac].addEventListener("progress",this[lg])}disconnectedCallback(){super.disconnectedCallback(),this[Ac].removeEventListener("progress",this[lg])}async updated(e){super.updated(e),e.has("poster")&&null!=this.poster&&(this[ig].style.backgroundImage=`url(${this.poster})`),e.has("alt")&&this[ig].setAttribute("aria-label",this[Yh]),(e.has("reveal")||e.has("loading"))&&this[Wh]()}[(t=og,s=ng,i=sg,n=ig,r=tg,o=Ag,a=ag,A=lg,cc)](){return!!this.src&&(this[ng]||this.loading===eg||this.reveal===Xu&&this[Vh])}[rg](){this[ng]=!1;const e=this[sg];if(!e.classList.contains("show"))return;e.classList.remove("show"),this[ec].classList.add("show");const t=this.modelIsVisible;this[og]=!0,this[Jh](t);const s=this.getRootNode();s&&s.activeElement===this&&this[ec].focus();const i=this[ig];i.setAttribute("aria-hidden","true"),i.tabIndex=-1,this.dispatchEvent(new CustomEvent("poster-dismissed"))}[hc](){return super[hc]()&&this[og]}}return Wu([lt({type:String})],l.prototype,"poster",void 0),Wu([lt({type:String})],l.prototype,"reveal",void 0),Wu([lt({type:String})],l.prototype,"loading",void 0),l})((e=>{var t;class s extends e{constructor(...e){super(e),this.autoplay=!1,this.animationName=void 0,this.animationCrossfadeDuration=300,this[t]=!0,this[sc].subscribeMixerEvent("loop",(e=>{const t=e.action._loopCount;this.dispatchEvent(new CustomEvent("loop",{detail:{count:t}}))})),this[sc].subscribeMixerEvent("finished",(()=>{this[Ic]=!0,this.dispatchEvent(new CustomEvent("finished"))}))}get availableAnimations(){return this.loaded?this[sc].animationNames:[]}get duration(){return this[sc].duration}get paused(){return this[Ic]}get currentTime(){return this[sc].animationTime}set currentTime(e){this[sc].animationTime=e,this[ic]()}get timeScale(){return this[sc].animationTimeScale}set timeScale(e){this[sc].animationTimeScale=e}pause(){this[Ic]||(this[Ic]=!0,this.dispatchEvent(new CustomEvent("pause")))}play(e){this.availableAnimations.length>0&&(this[Ic]=!1,this[mc](e),this.dispatchEvent(new CustomEvent("play")))}[(t=Ic,rc)](){super[rc](),this[Ic]=!0,this.autoplay&&this.play()}[nc](e,t){super[nc](e,t),this[Ic]||!this[hc]()&&!this[ac].isPresenting||(this[sc].updateAnimation(t/1e3),this[ic]())}updated(e){super.updated(e),e.has("autoplay")&&this.autoplay&&this.play(),e.has("animationName")&&this[mc]()}[mc](e=fc){var t;const s=null!==(t=e.repetitions)&&void 0!==t?t:1/0,i=e.pingpong?Ge:1===s?Oe:Pe;this[sc].playAnimation(this.animationName,this.animationCrossfadeDuration/1e3,i,s),this[Ic]&&(this[sc].updateAnimation(0),this[ic]())}}return pc([lt({type:Boolean})],s.prototype,"autoplay",void 0),pc([lt({type:String,attribute:"animation-name"})],s.prototype,"animationName",void 0),pc([lt({type:Number,attribute:"animation-crossfade-duration"})],s.prototype,"animationCrossfadeDuration",void 0),s})((e=>{var t;const s=Symbol("endPolyfillCoordination");return t=s,class extends e{constructor(){super(...arguments),this[t]=null}connectedCallback(){super.connectedCallback&&super.connectedCallback(),null==this[s]&&(this[s]=(e=>{if(null==e.shadowRoot||e.hasAttribute("data-js-focus-visible"))return()=>{};if(!self.applyFocusVisiblePolyfill){const t=()=>{self.applyFocusVisiblePolyfill(e.shadowRoot)};return self.addEventListener("focus-visible-polyfill-ready",t,{once:!0}),()=>{self.removeEventListener("focus-visible-polyfill-ready",t)}}return self.applyFocusVisiblePolyfill(e.shadowRoot),()=>{}})(this))}disconnectedCallback(){super.disconnectedCallback&&super.disconnectedCallback(),null!=this[s]&&(this[s](),this[s]=null)}}})(dc)))))))));customElements.define("model-viewer",Ig);export{Ig as ModelViewerElement};
//# sourceMappingURL=model-viewer-no-three.min.js.map
